{
  "version": "1.0",
  "generated_at": "2026-01-21T12:40:03.424390",
  "total_customizations": 797,
  "summary": {
    "total": 797,
    "removals": 423,
    "substitutions": 134,
    "additions": 240,
    "files_affected": 173
  },
  "by_file": {
    "firefox-ios/Client/AccessoryViewProvider.swift": 1,
    "firefox-ios/Client/Application/AccessibilityIdentifiers.swift": 1,
    "firefox-ios/Client/Application/AppDelegate+PushNotifications.swift": 1,
    "firefox-ios/Client/Application/AppDelegate.swift": 13,
    "firefox-ios/Client/Application/AppLaunchUtil.swift": 8,
    "firefox-ios/Client/Application/ImageIdentifiers.swift": 1,
    "firefox-ios/Client/Coordinators/Browser/BrowserCoordinator.swift": 8,
    "firefox-ios/Client/Coordinators/Launch/LaunchCoordinator.swift": 3,
    "firefox-ios/Client/Coordinators/LaunchView/LaunchScreenViewController.swift": 1,
    "firefox-ios/Client/Coordinators/Library/LibraryCoordinator.swift": 1,
    "firefox-ios/Client/Coordinators/Router/RouteBuilder.swift": 2,
    "firefox-ios/Client/Coordinators/Scene/SceneCoordinator.swift": 2,
    "firefox-ios/Client/Coordinators/SettingsCoordinator.swift": 3,
    "firefox-ios/Client/Extensions/UIEdgeInsets+Extension.swift": 1,
    "firefox-ios/Client/FeatureFlags/LegacyFeatureFlagsManager.swift": 1,
    "firefox-ios/Client/Frontend/Browser/BackForwardTableViewCell.swift": 1,
    "firefox-ios/Client/Frontend/Browser/BrowserViewController/Extensions/BrowserViewController+FindInPage.swift": 3,
    "firefox-ios/Client/Frontend/Browser/BrowserViewController/Extensions/BrowserViewController+TabToolbarDelegate.swift": 2,
    "firefox-ios/Client/Frontend/Browser/BrowserViewController/Extensions/BrowserViewController+URLBarDelegate.swift": 3,
    "firefox-ios/Client/Frontend/Browser/BrowserViewController/Extensions/BrowserViewController+WebViewDelegates.swift": 6,
    "firefox-ios/Client/Frontend/Browser/BrowserViewController/Views/BrowserViewController.swift": 27,
    "firefox-ios/Client/Frontend/Browser/ButtonToast.swift": 22,
    "firefox-ios/Client/Frontend/Browser/DefaultSearchPrefs.swift": 1,
    "firefox-ios/Client/Frontend/Browser/EnhancedTrackingProtection/EnhancedTrackingProtectionVC.swift": 2,
    "firefox-ios/Client/Frontend/Browser/MainMenu/MainMenuTelemetry.swift": 6,
    "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift": 48,
    "firefox-ios/Client/Frontend/Browser/Search/SearchViewController.swift": 22,
    "firefox-ios/Client/Frontend/Browser/Search/SearchViewModel.swift": 2,
    "firefox-ios/Client/Frontend/Browser/SearchEngines/DefaultSearchEngineProvider.swift": 1,
    "firefox-ios/Client/Frontend/Browser/SearchLoader.swift": 7,
    "firefox-ios/Client/Frontend/Browser/SimpleToast.swift": 1,
    "firefox-ios/Client/Frontend/Browser/StartAtHomeHelper.swift": 1,
    "firefox-ios/Client/Frontend/Browser/TabDisplayManager.swift": 1,
    "firefox-ios/Client/Frontend/Browser/TabTrayButtonExtensions.swift": 1,
    "firefox-ios/Client/Frontend/Browser/Tabs/Legacy/LegacyGridTabViewController.swift": 2,
    "firefox-ios/Client/Frontend/Browser/Tabs/Legacy/LegacyInactiveTabs/LegacyInactiveTabButton.swift": 1,
    "firefox-ios/Client/Frontend/Browser/Tabs/Legacy/LegacyInactiveTabs/LegacyInactiveTabCell.swift": 1,
    "firefox-ios/Client/Frontend/Browser/Tabs/Legacy/LegacyInactiveTabs/LegacyInactiveTabHeader.swift": 1,
    "firefox-ios/Client/Frontend/Browser/Tabs/Legacy/LegacyInactiveTabs/LegacyInactiveTabViewModel.swift": 1,
    "firefox-ios/Client/Frontend/Browser/Tabs/Legacy/LegacyTabCell.swift": 1,
    "firefox-ios/Client/Frontend/Browser/Tabs/Legacy/LegacyTabTrayViewController.swift": 2,
    "firefox-ios/Client/Frontend/Browser/Tabs/Views/EmptyPrivateTabsView.swift": 5,
    "firefox-ios/Client/Frontend/Browser/Tabs/Views/TabCell.swift": 1,
    "firefox-ios/Client/Frontend/Browser/Tabs/Views/TabTrayViewController.swift": 3,
    "firefox-ios/Client/Frontend/Browser/Toast.swift": 1,
    "firefox-ios/Client/Frontend/Browser/Toolbars/ToolbarTelemetry.swift": 20,
    "firefox-ios/Client/Frontend/Browser/TopTabCell.swift": 1,
    "firefox-ios/Client/Frontend/Browser/TopTabsViewController.swift": 3,
    "firefox-ios/Client/Frontend/Components/ContentContainer.swift": 1,
    "firefox-ios/Client/Frontend/Components/StatusBarOverlay.swift": 1,
    "firefox-ios/Client/Frontend/ContextualHint/ContextualHintViewController.swift": 1,
    "firefox-ios/Client/Frontend/Extensions/DevicePickerViewController.swift": 1,
    "firefox-ios/Client/Frontend/Home/CustomizeHome/CustomizeHomepageSectionViewModel.swift": 1,
    "firefox-ios/Client/Frontend/Home/HomepageContextMenuHelper.swift": 15,
    "firefox-ios/Client/Frontend/Home/HomepageViewModel.swift": 24,
    "firefox-ios/Client/Frontend/Home/JumpBackIn/JumpBackInSectionLayout.swift": 1,
    "firefox-ios/Client/Frontend/Home/LegacyHomepageViewController.swift": 25,
    "firefox-ios/Client/Frontend/Home/LogoHeader/HomeLogoHeaderViewModel.swift": 4,
    "firefox-ios/Client/Frontend/Home/TopSites/DataManagement/TopSitesDataAdaptor.swift": 6,
    "firefox-ios/Client/Frontend/Home/TopSites/TopSitesDimension.swift": 1,
    "firefox-ios/Client/Frontend/Home/TopSites/TopSitesViewModel.swift": 7,
    "firefox-ios/Client/Frontend/InternalSchemeHandler/ErrorPageHelper.swift": 2,
    "firefox-ios/Client/Frontend/InternalSchemeHandler/InternalSchemeHandler.swift": 2,
    "firefox-ios/Client/Frontend/Library/Bookmarks/Legacy/BookmarksPanelViewModel.swift": 7,
    "firefox-ios/Client/Frontend/Library/Bookmarks/Legacy/LegacyBookmarkDetailPanel.swift": 1,
    "firefox-ios/Client/Frontend/Library/Bookmarks/Legacy/LegacyBookmarksPanel.swift": 13,
    "firefox-ios/Client/Frontend/Library/Downloads/DownloadsPanel.swift": 3,
    "firefox-ios/Client/Frontend/Library/HistoryPanel/HistoryPanel.swift": 14,
    "firefox-ios/Client/Frontend/Library/LibraryPanelHelper.swift": 2,
    "firefox-ios/Client/Frontend/Library/LibraryViewController/LibraryViewController.swift": 4,
    "firefox-ios/Client/Frontend/Library/LibraryViewController/LibraryViewModel.swift": 1,
    "firefox-ios/Client/Frontend/Library/Reader/ReaderPanel.swift": 3,
    "firefox-ios/Client/Frontend/Microsurvey/MicrosurveyTelemetry.swift": 6,
    "firefox-ios/Client/Frontend/Settings/ClearPrivateDataTableViewController.swift": 3,
    "firefox-ios/Client/Frontend/Settings/Clearables.swift": 1,
    "firefox-ios/Client/Frontend/Settings/HomepageSettings/HomePageSettingViewController.swift": 3,
    "firefox-ios/Client/Frontend/Settings/HomepageSettings/TopSitesSettings/TopSitesSettingsViewController.swift": 1,
    "firefox-ios/Client/Frontend/Settings/Main/AppSettingsTableViewController.swift": 5,
    "firefox-ios/Client/Frontend/Settings/Main/Debug/OpenFiftyTabsDebugOption.swift": 1,
    "firefox-ios/Client/Frontend/Settings/Main/Privacy/ContentBlockerSetting.swift": 1,
    "firefox-ios/Client/Frontend/Settings/Main/SettingDisclosureUtility.swift": 1,
    "firefox-ios/Client/Frontend/Settings/SearchBar/SearchBarSettingsViewModel.swift": 2,
    "firefox-ios/Client/Frontend/Settings/SearchSettingsTableViewController.swift": 2,
    "firefox-ios/Client/Frontend/Settings/SettingsNavigationController.swift": 2,
    "firefox-ios/Client/Frontend/Settings/SettingsTableViewController.swift": 10,
    "firefox-ios/Client/Frontend/Settings/ThemeSettings/ThemeSettingsController.swift": 3,
    "firefox-ios/Client/Frontend/Settings/WebsiteDataManagement/WebsiteDataManagementViewController.swift": 1,
    "firefox-ios/Client/Frontend/Theme/ThemedTableViewCells/ThemedTableViewCell.swift": 2,
    "firefox-ios/Client/Frontend/Toolbar+URLBar/LockButton.swift": 2,
    "firefox-ios/Client/Frontend/Toolbar+URLBar/OverlayModeManager.swift": 2,
    "firefox-ios/Client/Frontend/Toolbar+URLBar/TabLocationContainerView.swift": 1,
    "firefox-ios/Client/Frontend/Toolbar+URLBar/TabToolbar.swift": 8,
    "firefox-ios/Client/Frontend/Toolbar+URLBar/TabToolbarHelper.swift": 5,
    "firefox-ios/Client/Frontend/Toolbar+URLBar/ToolbarButton.swift": 5,
    "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift": 37,
    "firefox-ios/Client/Frontend/TrackingProtection/TrackingProtectionHelpers/TrackingProtectionToggleView.swift": 2,
    "firefox-ios/Client/Frontend/TrackingProtection/TrackingProtectionViewController.swift": 9,
    "firefox-ios/Client/Frontend/Widgets/AutocompleteTextField.swift": 4,
    "firefox-ios/Client/Frontend/Widgets/OneLineTableViewCell.swift": 4,
    "firefox-ios/Client/Frontend/Widgets/PhotonActionSheet/PhotonActionSheetProtocol.swift": 2,
    "firefox-ios/Client/Frontend/Widgets/PhotonActionSheet/SingleActionViewModel.swift": 3,
    "firefox-ios/Client/Frontend/Widgets/SiteTableViewController.swift": 6,
    "firefox-ios/Client/Frontend/Widgets/SiteTableViewHeader.swift": 1,
    "firefox-ios/Client/Frontend/Widgets/TabsButton.swift": 1,
    "firefox-ios/Client/Frontend/Widgets/ThemedDefaultNavigationController.swift": 1,
    "firefox-ios/Client/Frontend/Widgets/ToggleButton.swift": 5,
    "firefox-ios/Client/Frontend/Widgets/TwoLineImageOverlayCell.swift": 3,
    "firefox-ios/Client/Nimbus/NimbusSearchBarLayer.swift": 1,
    "firefox-ios/Client/TabManagement/Legacy/LegacyTabManager.swift": 9,
    "firefox-ios/Client/TabManagement/Tab.swift": 2,
    "firefox-ios/Client/TabManagement/TabManagerImplementation.swift": 1,
    "firefox-ios/Client/Telemetry/AdsTelemetryHelper.swift": 3,
    "firefox-ios/Client/Telemetry/AppStartupTelemetry.swift": 1,
    "firefox-ios/Client/Telemetry/GleanWrapper.swift": 4,
    "firefox-ios/Client/Telemetry/HomepageTelemetry.swift": 2,
    "firefox-ios/Client/Telemetry/PrivateBrowsingTelemetry.swift": 2,
    "firefox-ios/Client/Telemetry/SearchTelemetry.swift": 6,
    "firefox-ios/Client/Telemetry/SponsoredTileTelemetry.swift": 3,
    "firefox-ios/Client/Telemetry/TabsTelemetry.swift": 4,
    "firefox-ios/Client/Telemetry/TelemetryContextualIdentifier.swift": 3,
    "firefox-ios/Client/Telemetry/TelemetryWrapper.swift": 6,
    "firefox-ios/Client/Telemetry/WebviewTelemetry.swift": 5,
    "firefox-ios/Extensions/ShareTo/SendToDevice.swift": 1,
    "firefox-ios/Extensions/ShareTo/ShareViewController.swift": 8,
    "firefox-ios/Project.swift": 4,
    "firefox-ios/Providers/TopSitesProvider.swift": 1,
    "firefox-ios/Shared/AppConstants.swift": 1,
    "firefox-ios/Shared/AppInfo.swift": 4,
    "firefox-ios/Shared/Extensions/URLExtensions.swift": 1,
    "firefox-ios/Shared/UserAgent.swift": 12,
    "firefox-ios/Storage/DefaultSuggestedSites.swift": 2,
    "firefox-ios/Storage/Rust/RustLogins.swift": 5,
    "firefox-ios/WidgetKit/ImageButtonWithLabel.swift": 5,
    "firefox-ios/WidgetKit/OpenTabs/OpenTabsWidget.swift": 12,
    "firefox-ios/WidgetKit/QuickLink.swift": 7,
    "firefox-ios/WidgetKit/SearchQuickLinksMedium/SearchQuickLinks.swift": 1,
    "firefox-ios/WidgetKit/TopSites/TopSitesWidget.swift": 3,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/BrowserCoordinatorTests.swift": 2,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/Launch/LaunchCoordinatorTests.swift": 4,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/LaunchView/LaunchScreenViewModelTests.swift": 8,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/RouteTests.swift": 28,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/SceneCoordinatorTests.swift": 3,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/SettingsCoordinatorTests.swift": 2,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/URLScannerTests.swift": 7,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/DefaultSearchPrefsTests.swift": 1,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/DependencyInjection/DependencyHelperMock.swift": 2,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/Frontend/Browser/SearchEngines/SearchTests.swift": 1,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/Frontend/Browser/TopSitesHelperTests.swift": 7,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/Frontend/ContentContainerTests.swift": 1,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/Frontend/Home/HomepageViewControllerTests.swift": 1,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/Frontend/Home/LegacyHomepageViewControllerTests.swift": 2,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/Frontend/Home/Pocket/PocketViewModelTests.swift": 5,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/Frontend/Home/TopSites/TopSitesDimensionTests.swift": 5,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/Frontend/Home/TopSites/TopSitesViewModelTests.swift": 1,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/Helpers/IntroScreenManagerTests.swift": 1,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/Library/Bookmarks/BookmarkPanelViewModelTests.swift": 1,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/MainMenu/MainMenuMiddlewareTests.swift": 2,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/Mocks/MockSettingsDelegate.swift": 1,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/Mocks/MockTabManager.swift": 1,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/OnboardingTests/NimbusOnboardingFeatureLayerTests.swift": 1,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/OverlayModeManagerTests.swift": 4,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/PasswordManagerViewModelTests.swift": 4,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/ProfileTest.swift": 1,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/Settings/AppSettingsTableViewControllerTests.swift": 1,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/Settings/VersionSettingTests.swift": 2,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/StatusBarOverlayTests.swift": 13,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/TabManagement/TabManagerTests.swift": 17,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/TabToolbarHelperTests.swift": 5,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/TabTray/TabTrayViewControllerTests.swift": 2,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/Wallpaper/WallpaperSelectorViewModelTests.swift": 3,
    "firefox-ios/firefox-ios-tests/Tests/ClientTests/Wallpaper/WallpaperSettingsViewModelTests.swift": 2,
    "firefox-ios/firefox-ios-tests/Tests/SharedTests/UserAgentBuilderTests.swift": 2,
    "firefox-ios/firefox-ios-tests/Tests/SharedTests/UserAgentTests.swift": 3
  },
  "customizations": [
    {
      "file": "firefox-ios/Client/AccessoryViewProvider.swift",
      "line": 240,
      "type": "removal",
      "comment": "update button colors",
      "firefox_code": [
        "            $0.tintColor = theme.colors.iconAccentBlue",
        "            $0.customView?.tintColor = theme.colors.iconAccentBlue"
      ],
      "ecosia_code": [],
      "context_before": [
        "        backgroundColor = theme.colors.layer5",
        "        [previousButton, nextButton, doneButton].forEach {"
      ],
      "context_after": [
        "            $0.tintColor = theme.colors.ecosia.buttonBackgroundPrimary",
        "            $0.customView?.tintColor = theme.colors.ecosia.buttonBackgroundPrimary"
      ]
    },
    {
      "file": "firefox-ios/Client/Application/AccessibilityIdentifiers.swift",
      "line": 820,
      "type": "addition",
      "comment": "Custom accessibility identifiers",
      "firefox_code": [],
      "ecosia_code": [
        "    struct Ecosia {",
        "        static let logo = \"ecosia-logo\""
      ],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "",
        "        struct TabToolbar {"
      ]
    },
    {
      "file": "firefox-ios/Client/Application/AppDelegate+PushNotifications.swift",
      "line": 80,
      "type": "removal",
      "comment": "Deactivate Firefox Push Notification Bahviour",
      "firefox_code": [
        "extension AppDelegate: UNUserNotificationCenterDelegate {",
        "    // Called when the user taps on a notification from the background.",
        "    func userNotificationCenter(_ center: UNUserNotificationCenter,",
        "                                didReceive response: UNNotificationResponse,",
        "                                withCompletionHandler completionHandler: @escaping () -> Void) {",
        "        let content = response.notification.request.content",
        "        if content.categoryIdentifier == NotificationSurfaceManager.Constant.notificationCategoryId {",
        "            switch response.actionIdentifier {",
        "            case UNNotificationDismissActionIdentifier:",
        "                notificationSurfaceManager.didDismissNotification(content.userInfo)",
        "            default:",
        "                notificationSurfaceManager.didTapNotification(content.userInfo)",
        "            }",
        "        } else if content.categoryIdentifier == NotificationCloseTabs.notificationCategoryId {",
        "            switch response.actionIdentifier {",
        "            case UNNotificationDefaultActionIdentifier:",
        "                // Since the notification is coming from the background, we should give a little",
        "                // time to ensure we can show the recently closed tabs panel",
        "                DispatchQueue.main.asyncAfter(deadline: .now() + 0.3) {",
        "                    NotificationCenter.default.post(name: .RemoteTabNotificationTapped, object: nil)",
        "                }",
        "            default:",
        "                break",
        "            }",
        "        }",
        "        // We don't poll for commands here because we do that once the application wakes up",
        "        // The notification service ensures that when the application wakes up, the application will check",
        "        // for commands",
        "        completionHandler()",
        "    }",
        "    // Called when the user receives a tab (or any other notification) while in foreground.",
        "    func userNotificationCenter(",
        "        _ center: UNUserNotificationCenter,",
        "        willPresent notification: UNNotification,",
        "        withCompletionHandler completionHandler: @escaping (UNNotificationPresentationOptions) -> Void",
        "    ) {",
        "        if profile.prefs.boolForKey(PendingAccountDisconnectedKey) ?? false {",
        "            profile.removeAccount()",
        "            // show the notification",
        "            completionHandler([.list, .banner, .sound])",
        "        } else {",
        "            profile.pollCommands(forcePoll: true)",
        "        }",
        "    }",
        "}",
        "extension AppDelegate {",
        "    func application(_ application: UIApplication,",
        "                     didRegisterForRemoteNotificationsWithDeviceToken deviceToken: Data) {",
        "        var notificationAllowed = true",
        "        if UserDefaults.standard.object(forKey: PrefsKeys.Notifications.SyncNotifications) != nil {",
        "            notificationAllowed = UserDefaults.standard.bool(forKey: PrefsKeys.Notifications.SyncNotifications)",
        "        }",
        "        guard notificationAllowed else {",
        "            RustFirefoxAccounts.shared.pushNotifications.disableNotifications()",
        "            return",
        "        }",
        "        Task {",
        "            do {",
        "                let autopush = try await Autopush(files: profile.files)",
        "                try await autopush.updateToken(withDeviceToken: deviceToken)",
        "                let fxaSubscription = try await autopush.subscribe(scope: RustFirefoxAccounts.pushScope)",
        "                RustFirefoxAccounts.shared.pushNotifications.updatePushRegistration(",
        "                    subscriptionResponse: fxaSubscription",
        "                )",
        "            } catch let error {",
        "                logger.log(",
        "                    \"Failed to update push registration\",",
        "                    level: .warning,",
        "                    category: .setup,",
        "                    description: error.localizedDescription",
        "                )",
        "            }",
        "        }",
        "    }",
        "    func application(_ application: UIApplication, didFailToRegisterForRemoteNotificationsWithError error: Error) {",
        "        logger.log(\"Failed to register for APNS\",",
        "                   level: .info,",
        "                   category: .setup)",
        "    }",
        "}"
      ],
      "ecosia_code": [],
      "context_before": [
        "}",
        ""
      ],
      "context_after": []
    },
    {
      "file": "firefox-ios/Client/Application/AppDelegate.swift",
      "line": 10,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "import Glean"
      ],
      "ecosia_code": [],
      "context_before": [
        "import UIKit",
        "import Common"
      ],
      "context_after": [
        "import TabDataStore",
        "import Ecosia"
      ]
    },
    {
      "file": "firefox-ios/Client/Application/AppDelegate.swift",
      "line": 35,
      "type": "removal",
      "comment": "Swap Theme Manager with Ecosia's",
      "firefox_code": [
        "    lazy var themeManager: ThemeManager = DefaultThemeManager(sharedContainerIdentifier: AppInfo.sharedContainerIdentifier)"
      ],
      "ecosia_code": [],
      "context_before": [
        "    )",
        ""
      ],
      "context_after": [
        "    lazy var themeManager: ThemeManager = EcosiaThemeManager(sharedContainerIdentifier: AppInfo.sharedContainerIdentifier)",
        "    lazy var ratingPromptManager = RatingPromptManager(profile: profile)"
      ]
    },
    {
      "file": "firefox-ios/Client/Application/AppDelegate.swift",
      "line": 52,
      "type": "addition",
      "comment": "Searches counter",
      "firefox_code": [],
      "ecosia_code": [
        "    private let searchesCounter = SearchesCounter()",
        "    private var backgroundWorkUtility: BackgroundFetchAndProcessingUtility?",
        "    private var widgetManager: TopSitesWidgetManager?",
        "    private var menuBuilderHelper: MenuBuilderHelper?",
        "    private var metricKitWrapper = MetricKitWrapper()",
        "    private let wallpaperMetadataQueue = DispatchQueue(label: \"com.moz.wallpaperVerification.queue\")"
      ],
      "context_before": [
        "    private var webServerUtil: WebServerUtil?",
        "    private var appLaunchUtil: AppLaunchUtil?"
      ],
      "context_after": [
        "",
        "    func application("
      ]
    },
    {
      "file": "firefox-ios/Client/Application/AppDelegate.swift",
      "line": 93,
      "type": "substitution",
      "comment": "Configure accounts provider factory for error simulation support",
      "firefox_code": [
        "This must happen before EcosiaAuthUIStateProvider.shared is first accessed"
      ],
      "ecosia_code": [
        "        EcosiaAuthUIStateProvider.accountsProviderFactory = { AccountsProviderWrapper() }"
      ],
      "context_before": [
        "        DependencyHelper().bootstrapDependencies()",
        ""
      ],
      "context_after": [
        "",
        "        appLaunchUtil = AppLaunchUtil(profile: profile)"
      ]
    },
    {
      "file": "firefox-ios/Client/Application/AppDelegate.swift",
      "line": 123,
      "type": "addition",
      "comment": "Allow Braze to be initialized after feature management",
      "firefox_code": [],
      "ecosia_code": [
        "        BrazeService.prepareForDelayedInitialization()"
      ],
      "context_before": [
        "                   category: .lifecycle)",
        ""
      ],
      "context_after": [
        "",
        "        // Ecosia: pushNotificationSetup()"
      ]
    },
    {
      "file": "firefox-ios/Client/Application/AppDelegate.swift",
      "line": 126,
      "type": "addition",
      "comment": "pushNotificationSetup()",
      "firefox_code": [],
      "ecosia_code": [
        "        appLaunchUtil?.setUpPostLaunchDependencies()",
        "        /* Ecosia: Do not intialize Background sync",
        "        backgroundWorkUtility = BackgroundFetchAndProcessingUtility()",
        "        backgroundWorkUtility?.registerUtility(BackgroundSyncUtility(profile: profile, application: application))",
        "        backgroundWorkUtility?.registerUtility(BackgroundNotificationSurfaceUtility())",
        "        if let firefoxSuggest = profile.firefoxSuggest {",
        "            backgroundWorkUtility?.registerUtility(BackgroundFirefoxSuggestIngestUtility(",
        "                firefoxSuggest: firefoxSuggest",
        "            ))"
      ],
      "context_before": [
        "        BrazeService.prepareForDelayedInitialization()",
        ""
      ],
      "context_after": [
        "        }",
        "         */"
      ]
    },
    {
      "file": "firefox-ios/Client/Application/AppDelegate.swift",
      "line": 128,
      "type": "removal",
      "comment": "Do not intialize Background sync",
      "firefox_code": [
        "        backgroundWorkUtility = BackgroundFetchAndProcessingUtility()",
        "        backgroundWorkUtility?.registerUtility(BackgroundSyncUtility(profile: profile, application: application))",
        "        backgroundWorkUtility?.registerUtility(BackgroundNotificationSurfaceUtility())",
        "        if let firefoxSuggest = profile.firefoxSuggest {",
        "            backgroundWorkUtility?.registerUtility(BackgroundFirefoxSuggestIngestUtility(",
        "                firefoxSuggest: firefoxSuggest",
        "            ))",
        "        }"
      ],
      "ecosia_code": [],
      "context_before": [
        "        // Ecosia: pushNotificationSetup()",
        "        appLaunchUtil?.setUpPostLaunchDependencies()"
      ],
      "context_after": [
        "        // Ecosia: Update EcosiaInstallType if needed. This should always happen before `FeatureManagement`.",
        "        EcosiaInstallType.evaluateCurrentEcosiaInstallType()"
      ]
    },
    {
      "file": "firefox-ios/Client/Application/AppDelegate.swift",
      "line": 140,
      "type": "addition",
      "comment": "Disable BG sync //backgroundSyncUtil = BackgroundSyncUtil(profile: profile, application: application)",
      "firefox_code": [],
      "ecosia_code": [],
      "context_before": [
        "        // Ecosia: Update EcosiaInstallType if needed. This should always happen before `FeatureManagement`.",
        "        EcosiaInstallType.evaluateCurrentEcosiaInstallType()"
      ],
      "context_after": [
        "",
        "        /*"
      ]
    },
    {
      "file": "firefox-ios/Client/Application/AppDelegate.swift",
      "line": 155,
      "type": "addition",
      "comment": "Braze Service Initialization after feature flags are fetched for conditional initialization",
      "firefox_code": [],
      "ecosia_code": [
        "            BrazeService.shared.initialize()"
      ],
      "context_before": [
        "        Task {",
        "            await FeatureManagement.fetchConfiguration()"
      ],
      "context_after": [
        "            // Ecosia: Lifecycle tracking. Needs to happen after Unleash start so that the flags are correctly added to the analytics context.",
        "            Analytics.shared.activity(.launch)"
      ]
    },
    {
      "file": "firefox-ios/Client/Application/AppDelegate.swift",
      "line": 157,
      "type": "addition",
      "comment": "Lifecycle tracking. Needs to happen after Unleash start so that the flags are correctly added to the analytics context.",
      "firefox_code": [],
      "ecosia_code": [
        "            Analytics.shared.activity(.launch)"
      ],
      "context_before": [
        "            // Ecosia: Braze Service Initialization after feature flags are fetched for conditional initialization",
        "            BrazeService.shared.initialize()"
      ],
      "context_after": [
        "        }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Application/AppDelegate.swift",
      "line": 161,
      "type": "addition",
      "comment": "fetching statistics before they are used",
      "firefox_code": [],
      "ecosia_code": [
        "        Task.detached {",
        "            try? await Statistics.shared.fetchAndUpdate()"
      ],
      "context_before": [
        "        }",
        ""
      ],
      "context_after": [
        "        }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Application/AppDelegate.swift",
      "line": 176,
      "type": "addition",
      "comment": "Send the install event. It happens only once per App install.",
      "firefox_code": [],
      "ecosia_code": [
        "        Analytics.shared.install()"
      ],
      "context_before": [
        "        addObservers()",
        ""
      ],
      "context_after": [
        "",
        "        logger.log(\"didFinishLaunchingWithOptions end\","
      ]
    },
    {
      "file": "firefox-ios/Client/Application/AppDelegate.swift",
      "line": 374,
      "type": "addition",
      "comment": "Register the APN device token and handle background notifications",
      "firefox_code": [],
      "ecosia_code": [
        "extension AppDelegate {",
        "    func application(_ application: UIApplication, didRegisterForRemoteNotificationsWithDeviceToken deviceToken: Data) {",
        "        BrazeService.shared.registerDeviceToken(deviceToken)"
      ],
      "context_before": [
        "}",
        ""
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Application/AppLaunchUtil.swift",
      "line": 10,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "import Glean"
      ],
      "ecosia_code": [],
      "context_before": [
        "import Storage",
        "import Account"
      ],
      "context_after": [
        "",
        "class AppLaunchUtil {"
      ]
    },
    {
      "file": "firefox-ios/Client/Application/AppLaunchUtil.swift",
      "line": 49,
      "type": "removal",
      "comment": "Do not intialize Firefox-specific SkAdNetwork and legacy feature flag manager",
      "firefox_code": [
        "        // Initialize conversion value by specifying fineValue and coarseValue.",
        "        // Call update postback conversion value for install event.",
        "        let conversionValue = ConversionValueUtil(fineValue: 0, coarseValue: .low, logger: logger)",
        "        conversionValue.adNetworkAttributionUpdateConversionEvent()"
      ],
      "ecosia_code": [],
      "context_before": [
        "        setMenuItems()",
        ""
      ],
      "context_after": [
        "        // Initialize the feature flag subsystem.",
        "        // Among other things, it toggles on and off Nimbus, Contile, Adjust."
      ]
    },
    {
      "file": "firefox-ios/Client/Application/AppLaunchUtil.swift",
      "line": 62,
      "type": "substitution",
      "comment": "Do not intialize Nimbus",
      "firefox_code": [
        "initializeExperiments()"
      ],
      "ecosia_code": [],
      "context_before": [
        "        // Start initializing the Nimbus SDK. This should be done after Glean",
        "        // has been started."
      ],
      "context_after": [
        "",
        "        // We migrate history from browser db to places if it hasn't already"
      ]
    },
    {
      "file": "firefox-ios/Client/Application/AppLaunchUtil.swift",
      "line": 85,
      "type": "removal",
      "comment": "Hide RustFirefoxAccounts",
      "firefox_code": [
        "           Keep `accountManagerInitialized` signaling right after this commented codeðŸ‘‡ active to satifsy tasks dependencies",
        "        RustFirefoxAccounts.startup(prefs: profile.prefs) { _ in",
        "            self.logger.log(\"RustFirefoxAccounts started\", level: .info, category: .sync)",
        "            AppEventQueue.signal(event: .accountManagerInitialized)",
        "        }"
      ],
      "ecosia_code": [],
      "context_before": [
        "        }",
        ""
      ],
      "context_after": [
        "        AppEventQueue.signal(event: .accountManagerInitialized)",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Application/AppLaunchUtil.swift",
      "line": 176,
      "type": "removal",
      "comment": "remove Glean dependency",
      "firefox_code": [
        "            let id = GleanMetrics.PlacesHistoryMigration.duration.start()",
        "            // We mark that the migration started",
        "            // this will help us identify how often the migration starts, but never ends",
        "            // additionally, we have a separate metric for error rates",
        "            GleanMetrics.PlacesHistoryMigration.migrationEndedRate.addToNumerator(1)",
        "            GleanMetrics.PlacesHistoryMigration.migrationErrorRate.addToNumerator(1)"
      ],
      "ecosia_code": [],
      "context_before": [
        "                       category: .sync)",
        ""
      ],
      "context_after": [
        "            browserProfile?.migrateHistoryToPlaces(",
        "            callback: { result in"
      ]
    },
    {
      "file": "firefox-ios/Client/Application/AppLaunchUtil.swift",
      "line": 189,
      "type": "removal",
      "comment": "remove Glean dependency",
      "firefox_code": [
        "                // We record various success metrics here",
        "                GleanMetrics.PlacesHistoryMigration.duration.stopAndAccumulate(id)",
        "                GleanMetrics.PlacesHistoryMigration.numMigrated.set(Int64(result.numSucceeded))"
      ],
      "ecosia_code": [],
      "context_before": [
        "                                level: .info,",
        "                                category: .sync)"
      ],
      "context_after": [
        "                self.logger.log(\"Migrated \\(result.numSucceeded) entries\",",
        "                                level: .info,"
      ]
    },
    {
      "file": "firefox-ios/Client/Application/AppLaunchUtil.swift",
      "line": 197,
      "type": "removal",
      "comment": "remove Glean dependency",
      "firefox_code": [
        "                GleanMetrics.PlacesHistoryMigration.numToMigrate.set(Int64(result.numTotal))",
        "                GleanMetrics.PlacesHistoryMigration.migrationEndedRate.addToDenominator(1)"
      ],
      "ecosia_code": [],
      "context_before": [
        "                                level: .info,",
        "                                category: .sync)"
      ],
      "context_after": [
        "                UserDefaults.standard.setValue(true, forKey: PrefsKeys.PlacesHistoryMigrationSucceeded)",
        "                NotificationCenter.default.post(name: .TopSitesUpdated, object: nil)"
      ]
    },
    {
      "file": "firefox-ios/Client/Application/AppLaunchUtil.swift",
      "line": 209,
      "type": "removal",
      "comment": "remove Glean dependency",
      "firefox_code": [
        "                GleanMetrics.PlacesHistoryMigration.duration.cancel(id)",
        "                GleanMetrics.PlacesHistoryMigration.migrationEndedRate.addToDenominator(1)",
        "                GleanMetrics.PlacesHistoryMigration.migrationErrorRate.addToDenominator(1)"
      ],
      "ecosia_code": [],
      "context_before": [
        "                                level: .warning,",
        "                                category: .sync)"
      ],
      "context_after": [
        "            })",
        "        } else {"
      ]
    },
    {
      "file": "firefox-ios/Client/Application/ImageIdentifiers.swift",
      "line": 13,
      "type": "removal",
      "comment": "Update Firefox brand logos",
      "firefox_code": [
        "    public static let firefoxFavicon = \"faviconFox\"",
        "    public static let foxConfirmation = \"foxConfirmation\"",
        "    public static let homeHeaderLogoBall = \"fxHomeHeaderLogoBall\"",
        "    public static let homeHeaderLogoText = \"fxHomeHeaderLogoText\""
      ],
      "ecosia_code": [],
      "context_before": [
        "public struct ImageIdentifiers {",
        "    public static let badgeMask = \"badge-mask\""
      ],
      "context_after": [
        "    public static let firefoxFavicon = \"ecosiaHomeHeaderLogoBall\"",
        "    public static let foxConfirmation = \"foxConfirmation\""
      ]
    },
    {
      "file": "firefox-ios/Client/Coordinators/Browser/BrowserCoordinator.swift",
      "line": 220,
      "type": "addition",
      "comment": "Add Referrals",
      "firefox_code": [],
      "ecosia_code": [
        "                referrals: browserViewController.referrals,"
      ],
      "context_before": [
        "                tabManager: tabManager,",
        "                overlayManager: overlayManager,"
      ],
      "context_after": [
        "                // Ecosia: Add HomePageViewControllerDelegate",
        "                delegate: browserViewController,"
      ]
    },
    {
      "file": "firefox-ios/Client/Coordinators/Browser/BrowserCoordinator.swift",
      "line": 222,
      "type": "addition",
      "comment": "Add HomePageViewControllerDelegate",
      "firefox_code": [],
      "ecosia_code": [
        "                delegate: browserViewController,"
      ],
      "context_before": [
        "                // Ecosia: Add Referrals",
        "                referrals: browserViewController.referrals,"
      ],
      "context_after": [
        "                // Ecosia: Add EcosiaAuth",
        "                auth: EcosiaAuth(browserViewController: browserViewController)"
      ]
    },
    {
      "file": "firefox-ios/Client/Coordinators/Browser/BrowserCoordinator.swift",
      "line": 224,
      "type": "addition",
      "comment": "Add EcosiaAuth",
      "firefox_code": [],
      "ecosia_code": [
        "                auth: EcosiaAuth(browserViewController: browserViewController)",
        "            )",
        "            legacyHomepageViewController.homePanelDelegate = homepanelDelegate",
        "            legacyHomepageViewController.libraryPanelDelegate = libraryPanelDelegate",
        "            legacyHomepageViewController.statusBarScrollDelegate = statusBarScrollDelegate",
        "            legacyHomepageViewController.browserNavigationHandler = self"
      ],
      "context_before": [
        "                // Ecosia: Add HomePageViewControllerDelegate",
        "                delegate: browserViewController,"
      ],
      "context_after": [
        "",
        "            return legacyHomepageViewController"
      ]
    },
    {
      "file": "firefox-ios/Client/Coordinators/Browser/BrowserCoordinator.swift",
      "line": 256,
      "type": "removal",
      "comment": "Add referrals",
      "firefox_code": [
        "        case .searchQuery, .search, .searchURL, .glean, .homepanel, .action, .fxaSignIn, .defaultBrowser:"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "        switch route {"
      ],
      "context_after": [
        "        case .searchQuery, .search, .searchURL, .glean, .homepanel, .action, .fxaSignIn, .defaultBrowser, .referrals:",
        "            return true"
      ]
    },
    {
      "file": "firefox-ios/Client/Coordinators/Browser/BrowserCoordinator.swift",
      "line": 315,
      "type": "addition",
      "comment": "Add referrals",
      "firefox_code": [],
      "ecosia_code": [
        "        case let .referrals(code):",
        "            User.shared.referrals.pendingClaim = code"
      ],
      "context_before": [
        "            }",
        ""
      ],
      "context_after": [
        "            // on first start, browser is not in view hierarchy yet",
        "            guard !User.shared.firstTime else { return }"
      ]
    },
    {
      "file": "firefox-ios/Client/Coordinators/Browser/BrowserCoordinator.swift",
      "line": 451,
      "type": "removal",
      "comment": "Update debug Tabs URL",
      "firefox_code": [
        "        guard let url = URL(string: \"https://www.mozilla.org\") else { return }"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func openDebugTestTabs(count: Int) {"
      ],
      "context_after": [
        "        guard let url = URL(string: \"https://www.ecosia.org\") else { return }",
        "        browserViewController.debugOpen(numberOfNewTabs: count, at: url)"
      ]
    },
    {
      "file": "firefox-ios/Client/Coordinators/Browser/BrowserCoordinator.swift",
      "line": 1057,
      "type": "addition",
      "comment": "BrowserCoordinator extension that implements the overlay card logic",
      "firefox_code": [],
      "ecosia_code": [
        "extension BrowserCoordinator {"
      ],
      "context_before": [
        "}",
        ""
      ],
      "context_after": [
        "",
        "    func showPendingOverlayCard(inline: Bool) {"
      ]
    },
    {
      "file": "firefox-ios/Client/Coordinators/Browser/BrowserCoordinator.swift",
      "line": 1120,
      "type": "addition",
      "comment": "Set BrowserCoordinator as Braze's browserDelegate to handle push urls",
      "firefox_code": [],
      "ecosia_code": [
        "extension BrowserCoordinator: BrazeBrowserDelegate {",
        "    func openBrazeURLInNewTab(_ url: URL?) {",
        "        guard let url else { return }"
      ],
      "context_before": [
        "}",
        ""
      ],
      "context_after": [
        "",
        "        if tabManager.isRestoringTabs {"
      ]
    },
    {
      "file": "firefox-ios/Client/Coordinators/Launch/LaunchCoordinator.swift",
      "line": 49,
      "type": "removal",
      "comment": "Disable old onboarding since outdated. Remove and clean up once properly updated.",
      "firefox_code": [
        "        let onboardingModel = NimbusOnboardingFeatureLayer().getOnboardingModel(for: .freshInstall)",
        "        let telemetryUtility = OnboardingTelemetryUtility(with: onboardingModel)",
        "        let introViewModel = IntroViewModel(introScreenManager: manager,",
        "                                            profile: profile,",
        "                                            model: onboardingModel,",
        "                                            telemetryUtility: telemetryUtility)",
        "        /* Ecosia: custom onboarding",
        "        let introViewController = IntroViewController(viewModel: introViewModel, windowUUID: windowUUID)",
        "        introViewController.qrCodeNavigationHandler = self",
        "        introViewController.didFinishFlow = { [weak self] in",
        "            guard let self = self else { return }",
        "            self.parentCoordinator?.didFinishLaunch(from: self)",
        "        }"
      ],
      "ecosia_code": [],
      "context_before": [
        "    private func presentIntroOnboarding(with manager: IntroScreenManager,",
        "                                        isFullScreen: Bool) {"
      ],
      "context_after": [
        "        let introViewController = WelcomeNavigation(rootViewController: Welcome(delegate: self, windowUUID: windowUUID))",
        "        introViewController.isNavigationBarHidden = true"
      ]
    },
    {
      "file": "firefox-ios/Client/Coordinators/Launch/LaunchCoordinator.swift",
      "line": 81,
      "type": "removal",
      "comment": "Remove completion",
      "firefox_code": [
        "            router.present(introViewController, animated: true) {",
        "                introViewController.closeOnboarding()",
        "            }"
      ],
      "ecosia_code": [],
      "context_before": [
        "                introViewController.isModalInPresentation = true",
        "            }"
      ],
      "context_after": [
        "            router.present(introViewController, animated: true)",
        "        }"
      ]
    },
    {
      "file": "firefox-ios/Client/Coordinators/Launch/LaunchCoordinator.swift",
      "line": 187,
      "type": "addition",
      "comment": "custom onboarding",
      "firefox_code": [],
      "ecosia_code": [
        "extension LaunchCoordinator: WelcomeDelegate {",
        "    func welcomeDidFinish(_ welcome: Welcome) {",
        "        self.parentCoordinator?.didFinishLaunch(from: self)"
      ],
      "context_before": [
        "}",
        ""
      ],
      "context_after": [
        "    }",
        "}"
      ]
    },
    {
      "file": "firefox-ios/Client/Coordinators/LaunchView/LaunchScreenViewController.swift",
      "line": 9,
      "type": "substitution",
      "comment": "Custom launch screen",
      "firefox_code": [
        "private lazy var launchScreen = LaunchScreenView.fromNib()"
      ],
      "ecosia_code": [
        "    private lazy var launchScreen = EcosiaLaunchScreenView.fromNib()",
        "    private weak var coordinator: LaunchFinishedLoadingDelegate?",
        "    private var viewModel: LaunchScreenViewModel",
        "    private var mainQueue: DispatchQueueInterface"
      ],
      "context_before": [
        "",
        "class LaunchScreenViewController: UIViewController, LaunchFinishedLoadingDelegate, FeatureFlaggable {"
      ],
      "context_after": [
        "",
        "    private lazy var splashScreenAnimation = SplashScreenAnimation()"
      ]
    },
    {
      "file": "firefox-ios/Client/Coordinators/Library/LibraryCoordinator.swift",
      "line": 74,
      "type": "removal",
      "comment": "Invert Download and Reading list positions in the LibraryViewController",
      "firefox_code": [
        "            ThemedNavigationController(rootViewController: downloadsPanel, windowUUID: windowUUID),",
        "            ThemedNavigationController(rootViewController: readingListPanel, windowUUID: windowUUID)"
      ],
      "ecosia_code": [],
      "context_before": [
        "            ThemedNavigationController(rootViewController: bookmarksPanel, windowUUID: windowUUID),",
        "            ThemedNavigationController(rootViewController: historyPanel, windowUUID: windowUUID),"
      ],
      "context_after": [
        "            ThemedNavigationController(rootViewController: readingListPanel, windowUUID: windowUUID),",
        "            ThemedNavigationController(rootViewController: downloadsPanel, windowUUID: windowUUID)"
      ]
    },
    {
      "file": "firefox-ios/Client/Coordinators/Router/RouteBuilder.swift",
      "line": 129,
      "type": "addition",
      "comment": "Track app open as default browser",
      "firefox_code": [],
      "ecosia_code": [
        "            Analytics.shared.appOpenAsDefaultBrowser()"
      ],
      "context_before": [
        "            TelemetryWrapper.gleanRecordEvent(category: .action, method: .open, object: .asDefaultBrowser)",
        ""
      ],
      "context_after": [
        "",
        "            RatingPromptManager.isBrowserDefault = true"
      ]
    },
    {
      "file": "firefox-ios/Client/Coordinators/Router/RouteBuilder.swift",
      "line": 136,
      "type": "addition",
      "comment": "Referral deeplink",
      "firefox_code": [],
      "ecosia_code": [
        "        } else if urlScanner.scheme == \"ecosia\", urlScanner.host == \"invite\" {",
        "            let paths = url.absoluteString.split(separator: \"/\")",
        "            guard let componentPath = paths[safe: 2] else { return nil }",
        "            return .referrals(code: String(componentPath))",
        "        } else {",
        "            return nil"
      ],
      "context_before": [
        "            return .search(url: url, isPrivate: isPrivate, options: [.focusLocationField])",
        ""
      ],
      "context_after": [
        "        }",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Coordinators/Scene/SceneCoordinator.swift",
      "line": 84,
      "type": "substitution",
      "comment": "custom onboarding",
      "firefox_code": [
        "if launchType.canLaunch(fromType: .SceneCoordinator) {"
      ],
      "ecosia_code": [
        "        if launchType.canLaunch(fromType: .SceneCoordinator),",
        "           User.shared.firstTime {",
        "            startLaunch(with: launchType)"
      ],
      "context_before": [
        "        let introManager = IntroScreenManager(prefs: profile.prefs)",
        "        let launchType = LaunchType.intro(manager: introManager)"
      ],
      "context_after": [
        "        }",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Coordinators/Scene/SceneCoordinator.swift",
      "line": 133,
      "type": "addition",
      "comment": "Set BrowserCoordinator as Braze's browserDelegate to handle push urls",
      "firefox_code": [],
      "ecosia_code": [
        "        BrazeService.shared.browserDelegate = browserCoordinator"
      ],
      "context_before": [
        "                                                    tabManager: tabManager)",
        ""
      ],
      "context_after": [
        "",
        "        let windowInfo = AppWindowInfo(tabManager: tabManager, sceneCoordinator: self)"
      ]
    },
    {
      "file": "firefox-ios/Client/Coordinators/SettingsCoordinator.swift",
      "line": 99,
      "type": "removal",
      "comment": "Update Home page customization route",
      "firefox_code": [
        "            let viewController = HomePageSettingViewController(prefs: profile.prefs,",
        "                                                               settingsDelegate: self,",
        "                                                               tabManager: tabManager)",
        "             viewController.profile = profile",
        "             return viewController"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "        case .homePage:"
      ],
      "context_after": [
        "            let customizationViewController = NTPCustomizationSettingsViewController(windowUUID: windowUUID)",
        "            customizationViewController.profile = profile"
      ]
    },
    {
      "file": "firefox-ios/Client/Coordinators/SettingsCoordinator.swift",
      "line": 189,
      "type": "addition",
      "comment": "SettingsDelegate",
      "firefox_code": [],
      "ecosia_code": [
        "    func reloadHomepage() {",
        "        (parentCoordinator as? BrowserCoordinator)?.legacyHomepageViewController?.reloadView()"
      ],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Coordinators/SettingsCoordinator.swift",
      "line": 320,
      "type": "removal",
      "comment": "Update Home page customization route",
      "firefox_code": [
        "        let viewController = HomePageSettingViewController(prefs: profile.prefs,",
        "                                                           settingsDelegate: self,",
        "                                                           tabManager: tabManager)",
        "         viewController.profile = profile",
        "         router.push(viewController)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func pressedHome() {"
      ],
      "context_after": [
        "        let customizationViewController = NTPCustomizationSettingsViewController(windowUUID: windowUUID)",
        "        customizationViewController.profile = profile"
      ]
    },
    {
      "file": "firefox-ios/Client/Extensions/UIEdgeInsets+Extension.swift",
      "line": 12,
      "type": "addition",
      "comment": "Add extension",
      "firefox_code": [],
      "ecosia_code": [
        "    init(horizontal inset: CGFloat) {",
        "        self.init(top: 0, left: inset, bottom: 0, right: inset)"
      ],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "    }",
        "}"
      ]
    },
    {
      "file": "firefox-ios/Client/FeatureFlags/LegacyFeatureFlagsManager.swift",
      "line": 58,
      "type": "addition",
      "comment": "Turn off specific feature flags",
      "firefox_code": [],
      "ecosia_code": [
        "        switch featureID {",
        "        case .splashScreen, .feltPrivacySimplifiedUI, .microsurvey:",
        "            return false",
        "        default:",
        "            break"
      ],
      "context_before": [
        "        let userSetting = feature.isUserEnabled(using: nimbusFlags)",
        ""
      ],
      "context_after": [
        "        }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BackForwardTableViewCell.swift",
      "line": 113,
      "type": "substitution",
      "comment": "Update image with Ecosia icon",
      "firefox_code": [
        "faviconView.manuallySetImage(UIImage(named: ImageIdentifiers.firefoxFavicon) ?? UIImage())"
      ],
      "ecosia_code": [
        "            faviconView.manuallySetImage(.init(named: \"iconLogo\", in: .ecosia, with: nil) ?? .init())",
        "        } else {",
        "            faviconView.setFavicon(FaviconImageViewModel(siteURLString: viewModel.site.url,",
        "                                                         faviconCornerRadius: UX.faviconCornerRadius))"
      ],
      "context_before": [
        "        if let url = URL(string: viewModel.site.url, invalidCharacters: false),",
        "           InternalURL(url)?.isAboutHomeURL == true {"
      ],
      "context_after": [
        "        }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Extensions/BrowserViewController+FindInPage.swift",
      "line": 44,
      "type": "removal",
      "comment": "Custom UI for FindInPageBar",
      "firefox_code": [
        "        let findInPageBar = FindInPageBar()"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    private func setupFindInPage() {"
      ],
      "context_after": [
        "        let findInPageBar = EcosiaFindInPageBar()",
        "        self.findInPageBar = findInPageBar"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Extensions/BrowserViewController+FindInPage.swift",
      "line": 71,
      "type": "removal",
      "comment": "Custom UI for FindInPageBar",
      "firefox_code": [
        "    private func removeFindInPage(_ findInPageBar: FindInPageBar, tab: Tab? = nil) {"
      ],
      "ecosia_code": [],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "    private func removeFindInPage(_ findInPageBar: EcosiaFindInPageBar, tab: Tab? = nil) {",
        "        findInPageBar.endEditing(true)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Extensions/BrowserViewController+FindInPage.swift",
      "line": 85,
      "type": "removal",
      "comment": "Custom UI for FindInPageBar",
      "firefox_code": [
        "extension BrowserViewController: FindInPageBarDelegate, FindInPageHelperDelegate {",
        "    func findInPage(_ findInPage: FindInPageBar, didTextChange text: String) {",
        "        find(text, function: \"find\")",
        "    }",
        "    func findInPage(_ findInPage: FindInPageBar, didFindNextWithText text: String) {",
        "        findInPageBar?.endEditing(true)",
        "        find(text, function: \"findNext\")",
        "    }",
        "    func findInPage(_ findInPage: FindInPageBar, didFindPreviousWithText text: String) {",
        "        findInPageBar?.endEditing(true)",
        "        find(text, function: \"findPrevious\")",
        "    }",
        "    func findInPageDidPressClose(_ findInPage: FindInPageBar) {",
        "        updateFindInPageVisibility(isVisible: false)",
        "    }",
        "    fileprivate func find(_ text: String, function: String) {",
        "        guard let webView = tabManager.selectedTab?.webView else { return }",
        "        let escaped = text.replacingOccurrences(of: \"\\\\\", with: \"\\\\\\\\\").replacingOccurrences(of: \"\\\"\", with: \"\\\\\\\"\")",
        "        webView.evaluateJavascriptInDefaultContentWorld(\"__firefox__.\\(function)(\\\"\\(escaped)\\\")\")",
        "    }",
        "    func findInPageHelper(_ findInPageHelper: FindInPageHelper, didUpdateCurrentResult currentResult: Int) {",
        "        findInPageBar?.currentResult = currentResult",
        "    }",
        "    func findInPageHelper(_ findInPageHelper: FindInPageHelper, didUpdateTotalResults totalResults: Int) {",
        "        findInPageBar?.totalResults = totalResults",
        "    }",
        "}"
      ],
      "ecosia_code": [],
      "context_before": [
        "}",
        ""
      ],
      "context_after": [
        "",
        "extension BrowserViewController: EcosiaFindInPageBarDelegate, FindInPageHelperDelegate {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Extensions/BrowserViewController+TabToolbarDelegate.swift",
      "line": 364,
      "type": "addition",
      "comment": "Re-add image so toast looks like v104",
      "firefox_code": [],
      "ecosia_code": [
        "                                                 imageName: StandardImageIdentifiers.Large.bookmarkSlash,",
        "                                                 buttonText: .BookmarksEdit,",
        "                                                 textAlignment: .left)",
        "            let toast = ButtonToast(viewModel: viewModel,",
        "                                    theme: currentTheme()) { isButtonTapped in",
        "                isButtonTapped ? self.openBookmarkEditPanel() : nil"
      ],
      "context_before": [
        "        case .bookmarkPage:",
        "            let viewModel = ButtonToastViewModel(labelText: message,"
      ],
      "context_after": [
        "            }",
        "            self.show(toast: toast)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Extensions/BrowserViewController+TabToolbarDelegate.swift",
      "line": 375,
      "type": "addition",
      "comment": "Re-add image so toast looks like v104",
      "firefox_code": [],
      "ecosia_code": [
        "                                                 imageName: \"bookmarksEmpty\",",
        "                                                 buttonText: .UndoString,",
        "                                                 textAlignment: .left)",
        "            let toast = ButtonToast(viewModel: viewModel,",
        "                                    theme: currentTheme()) { [weak self] isButtonTapped in",
        "                guard let self, let currentTab = tabManager.selectedTab else { return }",
        "                isButtonTapped ? self.addBookmark(",
        "                    url: bookmarkURL?.absoluteString ?? currentTab.url?.absoluteString ?? \"\",",
        "                    title: title ?? currentTab.title",
        "                ) : nil"
      ],
      "context_before": [
        "        case .removeBookmark:",
        "            let viewModel = ButtonToastViewModel(labelText: message,"
      ],
      "context_after": [
        "            }",
        "            show(toast: toast)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Extensions/BrowserViewController+URLBarDelegate.swift",
      "line": 7,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "import Glean"
      ],
      "ecosia_code": [],
      "context_before": [
        "import Shared",
        "import Storage"
      ],
      "context_after": [
        "import Common",
        "import ComponentLibrary"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Extensions/BrowserViewController+URLBarDelegate.swift",
      "line": 75,
      "type": "addition",
      "comment": "Re-add image so toast looks like v104",
      "firefox_code": [],
      "ecosia_code": [
        "                                                 imageName: \"tabs\",",
        "                                                 buttonText: .ContextMenuButtonToastNewTabOpenedButtonText)",
        "            let toast = ButtonToast(viewModel: viewModel,",
        "                                    theme: self.currentTheme(),",
        "                                    completion: { buttonPressed in",
        "                if buttonPressed {",
        "                    self.tabManager.selectTab(tab)"
      ],
      "context_before": [
        "            // We're not showing the top tabs; show a toast to quick switch to the fresh new tab.",
        "            let viewModel = ButtonToastViewModel(labelText: .ContextMenuButtonToastNewTabOpenedLabelText,"
      ],
      "context_after": [
        "                }",
        "            })"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Extensions/BrowserViewController+URLBarDelegate.swift",
      "line": 274,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        GleanMetrics.Search",
        "            .counts[\"\\(engine.engineID ?? \"custom\").\\(SearchLocation.actionBar.rawValue)\"]",
        "            .add()"
      ],
      "ecosia_code": [],
      "context_before": [
        "        Experiments.events.recordEvent(BehavioralTargetingEvent.performedSearch)",
        ""
      ],
      "context_after": [
        "        searchTelemetry?.shouldSetUrlTypeSearch = true",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Extensions/BrowserViewController+WebViewDelegates.swift",
      "line": 302,
      "type": "addition",
      "comment": "Re-add image so toast looks like v104",
      "firefox_code": [],
      "ecosia_code": [
        "                                             imageName: \"tabs\",",
        "                                             buttonText: .ContextMenuButtonToastNewTabOpenedButtonText)",
        "        let toast = ButtonToast(viewModel: viewModel,",
        "                                theme: self.currentTheme(),",
        "                                completion: { buttonPressed in",
        "            if buttonPressed {",
        "                self.tabManager.selectTab(tab)",
        "                self.overlayManager.switchTab(shouldCancelLoading: true)"
      ],
      "context_before": [
        "",
        "        let viewModel = ButtonToastViewModel(labelText: toastLabelText,"
      ],
      "context_after": [
        "            }",
        "        })"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Extensions/BrowserViewController+WebViewDelegates.swift",
      "line": 458,
      "type": "addition",
      "comment": "Detect Ecosia-specific URLs (auth, profile, etc.) and trigger native flows",
      "firefox_code": [],
      "ecosia_code": [
        "        if detectAndHandleEcosiaURL(url, for: tab) {",
        "            decisionHandler(.cancel)",
        "            return"
      ],
      "context_before": [
        "        }",
        ""
      ],
      "context_after": [
        "        }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Extensions/BrowserViewController+WebViewDelegates.swift",
      "line": 519,
      "type": "removal",
      "comment": "Change to native alert controller (showSnackbar() contains the Ecosia change)",
      "firefox_code": [
        "                TimerSnackBar.showAppStoreConfirmationBar(",
        "                    forTab: tab,",
        "                    appStoreURL: url,",
        "                    theme: self.currentTheme()",
        "                ) { _ in",
        "                    // If a new window was opened for this URL (it will have no history), close it.",
        "                    if tab.historyList.isEmpty {",
        "                        self.tabManager.removeTab(tab)",
        "                    }",
        "                }"
      ],
      "ecosia_code": [],
      "context_before": [
        "                // Show only if no other snack bar",
        "                guard let tab = self.tabManager.selectedTab, tab.bars.isEmpty else { return }"
      ],
      "context_after": [
        "                self.showSnackbar(forExternalUrl: url, tab: tab) { isOK in",
        "                    if isOK {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Extensions/BrowserViewController+WebViewDelegates.swift",
      "line": 609,
      "type": "addition",
      "comment": "Track search if is Ecosia's vertical",
      "firefox_code": [],
      "ecosia_code": [
        "            let urlChanged = url != previousUrl",
        "            let isReload = navigationAction.navigationType == .reload",
        "            let isBackForward = navigationAction.navigationType == .backForward",
        "            if !isBackForward && (urlChanged || isReload) && url.isEcosiaSearchVertical() {",
        "                Analytics.shared.inappSearch(url: url)"
      ],
      "context_before": [
        "            }",
        ""
      ],
      "context_after": [
        "            }",
        "            previousUrl = url"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Extensions/BrowserViewController+WebViewDelegates.swift",
      "line": 622,
      "type": "addition",
      "comment": "Allow MarketplaceKit requests for iOS 17.4+",
      "firefox_code": [],
      "ecosia_code": [
        "        if #available(iOS 17.4, *), url.scheme == \"marketplace-kit\" {",
        "            decisionHandler(.allow)",
        "            return"
      ],
      "context_before": [
        "        }",
        ""
      ],
      "context_after": [
        "        }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Extensions/BrowserViewController+WebViewDelegates.swift",
      "line": 997,
      "type": "removal",
      "comment": "Change to native alert controller",
      "firefox_code": [
        "        let snackBar = TimerSnackBar(text: .ExternalLinkGenericConfirmation + \"\\n\\(url.absoluteString)\", img: nil)",
        "        let ok = SnackButton(title: .OKString, accessibilityIdentifier: \"AppOpenExternal.button.ok\") { bar in",
        "            tab.removeSnackbar(bar)",
        "            completion(true)",
        "        }",
        "        let cancel = SnackButton(",
        "            title: .CancelString,",
        "            accessibilityIdentifier: \"AppOpenExternal.button.cancel\"",
        "        ) { bar in",
        "            tab.removeSnackbar(bar)",
        "            completion(false)",
        "        }",
        "        let theme = currentTheme()",
        "        ok.applyTheme(theme: theme)",
        "        cancel.applyTheme(theme: theme)",
        "        snackBar.applyTheme(theme: theme)",
        "        snackBar.addButton(ok)",
        "        snackBar.addButton(cancel)",
        "        tab.addSnackbar(snackBar)"
      ],
      "ecosia_code": [],
      "context_before": [
        "    // Use for sms and mailto links, which do not show a confirmation before opening.",
        "    func showSnackbar(forExternalUrl url: URL, tab: Tab, completion: @escaping (Bool) -> Void) {"
      ],
      "context_after": [
        "        let alert = UIAlertController(title: .localized(.openExternalLinkTitle),",
        "                                      message: String(format: .localized(.openExternalLinkDescription), url.absoluteString),"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Views/BrowserViewController.swift",
      "line": 38,
      "type": "substitution",
      "comment": "Used inside webview delegate to decide if search should be tracked",
      "firefox_code": [
        "(for now this is not cleared across sections or tabs, but shouldn't be an issue)"
      ],
      "ecosia_code": [
        "    var previousUrl: URL?"
      ],
      "context_before": [
        "                             FeatureFlaggable {",
        ""
      ],
      "context_after": [
        "",
        "    private enum UX {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Views/BrowserViewController.swift",
      "line": 92,
      "type": "removal",
      "comment": "Custom UI for FindInPageBar",
      "firefox_code": [
        "    var findInPageBar: FindInPageBar?"
      ],
      "ecosia_code": [],
      "context_before": [
        "    var searchTelemetry: SearchTelemetry?",
        "    var searchLoader: SearchLoader?"
      ],
      "context_after": [
        "    var findInPageBar: EcosiaFindInPageBar?",
        "    var zoomPageBar: ZoomPageBar?"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Views/BrowserViewController.swift",
      "line": 136,
      "type": "addition",
      "comment": "Authentication manager for handling login/logout flows",
      "firefox_code": [],
      "ecosia_code": [
        "    var ecosiaAuth: EcosiaAuth?",
        "    lazy var isTabTrayRefactorEnabled: Bool = TabTrayFlagManager.isRefactorEnabled",
        "    var isToolbarRefactorEnabled: Bool {",
        "        return featureFlags.isFeatureEnabled(.toolbarRefactor, checking: .buildOnly)"
      ],
      "context_before": [
        "    let ratingPromptManager: RatingPromptManager",
        ""
      ],
      "context_after": [
        "    }",
        "    var isUnifiedSearchEnabled: Bool {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Views/BrowserViewController.swift",
      "line": 250,
      "type": "addition",
      "comment": "Add Referrals and WhatsNew",
      "firefox_code": [],
      "ecosia_code": [
        "    let whatsNewDataProvider = WhatsNewLocalDataProvider()",
        "    let referrals = Referrals()"
      ],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "",
        "    // Ecosia: Make `menuHelper` available at class level"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Views/BrowserViewController.swift",
      "line": 254,
      "type": "addition",
      "comment": "Make `menuHelper` available at class level",
      "firefox_code": [],
      "ecosia_code": [
        "    var menuHelper: MainMenuActionHelper?"
      ],
      "context_before": [
        "    let referrals = Referrals()",
        ""
      ],
      "context_after": [
        "",
        "    init("
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Views/BrowserViewController.swift",
      "line": 308,
      "type": "addition",
      "comment": "Unregister window from auth state management",
      "firefox_code": [],
      "ecosia_code": [
        "        EcosiaAuthWindowRegistry.shared.unregisterWindow(windowUUID)"
      ],
      "context_before": [
        "        logger.log(\"BVC deallocating\", level: .info, category: .lifecycle)",
        ""
      ],
      "context_after": [
        "",
        "        unsubscribeFromRedux()"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Views/BrowserViewController.swift",
      "line": 389,
      "type": "addition",
      "comment": "Update toolbar search button",
      "firefox_code": [],
      "ecosia_code": [
        "        toolbar.circleButton.config = isBottomSearchBar ? .newTab : .search",
        "        toolbar.setNeedsDisplay()",
        "        searchBarView.updateConstraints()",
        "        updateMicrosurveyConstraints()"
      ],
      "context_before": [
        "        updateViewConstraints()",
        "        updateHeaderConstraints()"
      ],
      "context_after": [
        "",
        "        let action = GeneralBrowserMiddlewareAction("
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Views/BrowserViewController.swift",
      "line": 405,
      "type": "removal",
      "comment": "actionNeeded set to false",
      "firefox_code": [
        "        let isActionNeeded = RustFirefoxAccounts.shared.isActionNeeded"
      ],
      "ecosia_code": [],
      "context_before": [
        "    @objc",
        "    fileprivate func appMenuBadgeUpdate() {"
      ],
      "context_after": [
        "        let isActionNeeded = false",
        "        let showWarningBadge = isActionNeeded"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Views/BrowserViewController.swift",
      "line": 443,
      "type": "removal",
      "comment": "Change to circle button",
      "firefox_code": [
        "            toolbar.addNewTabButton.isHidden = showNavToolbar"
      ],
      "ecosia_code": [],
      "context_before": [
        "            urlBar.topTabsIsShowing = showTopTabs",
        "            urlBar.setShowToolbar(!showNavToolbar)"
      ],
      "context_after": [
        "            toolbar.circleButton.isHidden = false",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Views/BrowserViewController.swift",
      "line": 494,
      "type": "addition",
      "comment": "Update toolbar search/add button",
      "firefox_code": [],
      "ecosia_code": [
        "        toolbar.circleButton.config = isBottomSearchBar ? .newTab : .search"
      ],
      "context_before": [
        "        }",
        ""
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Views/BrowserViewController.swift",
      "line": 544,
      "type": "removal",
      "comment": "Update background overlay for private tabs",
      "firefox_code": [
        "        privacyWindowHelper.showWindow(withThemedColor: currentTheme().colors.layer3)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "        contentStackView.alpha = 0"
      ],
      "context_after": [
        "        privacyWindowHelper.showWindow(withThemedColor: currentTheme().colors.ecosia.backgroundPrimary)",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Views/BrowserViewController.swift",
      "line": 748,
      "type": "addition",
      "comment": "Register window for auth state management",
      "firefox_code": [],
      "ecosia_code": [
        "        EcosiaAuthWindowRegistry.shared.registerWindow(windowUUID)"
      ],
      "context_before": [
        "        super.viewDidLoad()",
        ""
      ],
      "context_after": [
        "",
        "        KeyboardHelper.defaultHelper.addDelegate(self)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Views/BrowserViewController.swift",
      "line": 776,
      "type": "removal",
      "comment": "Remove SearchTelemetry",
      "firefox_code": [
        "        searchTelemetry = SearchTelemetry(tabManager: tabManager)"
      ],
      "ecosia_code": [],
      "context_before": [
        "        view.addInteraction(dropInteraction)",
        ""
      ],
      "context_after": [
        "",
        "        // Awesomebar Location Telemetry"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Views/BrowserViewController.swift",
      "line": 794,
      "type": "removal",
      "comment": "Remove Credit Cards Save/Autofill",
      "firefox_code": [
        "        // Feature flag for credit card until we fully enable this feature",
        "        let autofillCreditCardStatus = featureFlags.isFeatureEnabled(",
        "            .creditCardAutofillStatus, checking: .buildOnly)",
        "        // We need to update autofill status on sync manager as there could be delay from nimbus",
        "        // in getting the value. When the delay happens the credit cards might not sync",
        "        // as the default value is false",
        "        profile.syncManager.updateCreditCardAutofillStatus(value: autofillCreditCardStatus)",
        "        // Credit card initial setup telemetry",
        "        creditCardInitialSetupTelemetry()"
      ],
      "ecosia_code": [],
      "context_before": [
        "        statusBarOverlay.applyTheme(theme: theme)",
        ""
      ],
      "context_after": [
        "",
        "        // Send settings telemetry for Fakespot"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Views/BrowserViewController.swift",
      "line": 1009,
      "type": "addition",
      "comment": "Present Intro logic",
      "firefox_code": [],
      "ecosia_code": [
        "        presentIntroViewController()"
      ],
      "context_before": [
        "        super.viewDidAppear(animated)",
        ""
      ],
      "context_after": [
        "",
        "        if let toast = self.pendingToast {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Views/BrowserViewController.swift",
      "line": 1393,
      "type": "addition",
      "comment": "Let showOverlayCard() execute",
      "firefox_code": [],
      "ecosia_code": [
        "        browserDelegate?.showPendingOverlayCard(inline: inline)"
      ],
      "context_before": [
        "        }",
        ""
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Views/BrowserViewController.swift",
      "line": 1644,
      "type": "removal",
      "comment": "Update url with currentURL (ecosified)",
      "firefox_code": [
        "        if let nav = tab.loadRequest(URLRequest(url: url)) {"
      ],
      "ecosia_code": [],
      "context_before": [
        "        overlayManager.finishEditing(shouldCancelLoading: false)",
        ""
      ],
      "context_after": [
        "        if let currentURL = urlBar.currentURL, let nav = tab.loadRequest(URLRequest(url: currentURL)) {",
        "            self.recordNavigationInTab(tab, navigation: nav, visitType: visitType)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Views/BrowserViewController.swift",
      "line": 2330,
      "type": "addition",
      "comment": "Add `isPhone`",
      "firefox_code": [],
      "ecosia_code": [
        "            let isPhone = self.traitCollection.userInterfaceIdiom == .phone",
        "            let viewModel = PhotonActionSheetViewModel(",
        "                actions: actions,",
        "                /* Ecosia: Update modal style for phone",
        "                modalStyle: .popover,",
        "                 */",
        "                modalStyle: isPhone ? .pageSheet : .popover,",
        "                isMainMenu: true,",
        "                isMainMenuInverted: shouldInverse",
        "            )",
        "            if self.profile.prefs.boolForKey(PrefsKeys.PhotonMainMenuShown) == nil {",
        "                self.profile.prefs.setBool(true, forKey: PrefsKeys.PhotonMainMenuShown)"
      ],
      "context_before": [
        "                isBottomSearchBar: self.isBottomSearchBar",
        "            )"
      ],
      "context_after": [
        "            }",
        "            self.presentSheetWith(viewModel: viewModel, on: self, from: button)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Views/BrowserViewController.swift",
      "line": 2334,
      "type": "removal",
      "comment": "Update modal style for phone",
      "firefox_code": [
        "                modalStyle: .popover,"
      ],
      "ecosia_code": [],
      "context_before": [
        "            let viewModel = PhotonActionSheetViewModel(",
        "                actions: actions,"
      ],
      "context_after": [
        "                modalStyle: isPhone ? .pageSheet : .popover,",
        "                isMainMenu: true,"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Views/BrowserViewController.swift",
      "line": 2347,
      "type": "addition",
      "comment": "Make `menuHelper` available at class level",
      "firefox_code": [],
      "ecosia_code": [
        "        self.menuHelper = menuHelper"
      ],
      "context_before": [
        "        }",
        ""
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Views/BrowserViewController.swift",
      "line": 2619,
      "type": "removal",
      "comment": "Make available to BrowserViewController+Ecosia",
      "firefox_code": [
        "    fileprivate func popToBVC() {"
      ],
      "ecosia_code": [],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "    func popToBVC() {",
        "        guard let currentViewController = navigationController?.topViewController else { return }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Views/BrowserViewController.swift",
      "line": 3065,
      "type": "removal",
      "comment": "Update backgrounds",
      "firefox_code": [
        "        keyboardBackdrop?.backgroundColor = currentTheme.colors.layer1"
      ],
      "ecosia_code": [],
      "context_before": [
        "        statusBarOverlay.hasTopTabs = ToolbarHelper().shouldShowTopTabs(for: traitCollection)",
        "        statusBarOverlay.applyTheme(theme: currentTheme)"
      ],
      "context_after": [
        "        keyboardBackdrop?.backgroundColor = currentTheme.colors.ecosia.backgroundSecondary",
        "        navigationController?.view.backgroundColor = currentTheme.colors.ecosia.backgroundSecondary"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Views/BrowserViewController.swift",
      "line": 3086,
      "type": "addition",
      "comment": "Update URLBar following PrivateModeUI",
      "firefox_code": [],
      "ecosia_code": [
        "        updateURLBarFollowingPrivateModeUI()"
      ],
      "context_before": [
        "        applyThemeForPreferences(profile.prefs, contentScript: contentScript)",
        ""
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Views/BrowserViewController.swift",
      "line": 3145,
      "type": "addition",
      "comment": "Re-add image so toast looks like v104",
      "firefox_code": [],
      "ecosia_code": [
        "                                             imageName: \"tabs\",",
        "                                             buttonText: .ContextMenuButtonToastNewTabOpenedButtonText)",
        "        let toast = ButtonToast(viewModel: viewModel,",
        "                                theme: currentTheme(),",
        "                                completion: { buttonPressed in",
        "            if buttonPressed {",
        "                self.tabManager.selectTab(tab)"
      ],
      "context_before": [
        "        // We're not showing the top tabs; show a toast to quick switch to the fresh new tab.",
        "        let viewModel = ButtonToastViewModel(labelText: .ContextMenuButtonToastNewTabOpenedLabelText,"
      ],
      "context_after": [
        "            }",
        "        })"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Views/BrowserViewController.swift",
      "line": 3444,
      "type": "removal",
      "comment": "Remove Credit Cards Save/Autofill",
      "firefox_code": [
        "        // Credit card autofill setup and callback",
        "        autofillSetup(tab, didCreateWebView: webView)"
      ],
      "ecosia_code": [],
      "context_before": [
        "        }",
        ""
      ],
      "context_after": [
        "",
        "        let contextMenuHelper = ContextMenuHelper(tab: tab)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Views/BrowserViewController.swift",
      "line": 3620,
      "type": "addition",
      "comment": "Re-add image so toast looks like v104",
      "firefox_code": [],
      "ecosia_code": [
        "                                             imageName: \"tabs\",",
        "                                             buttonText: .ContextMenuButtonToastNewTabOpenedButtonText)",
        "        let toast = ButtonToast(viewModel: viewModel,",
        "                                theme: currentTheme(),",
        "                                completion: { buttonPressed in",
        "            if buttonPressed {",
        "                self.tabManager.selectTab(tab)"
      ],
      "context_before": [
        "        // We're not showing the top tabs; show a toast to quick switch to the fresh new tab.",
        "        let viewModel = ButtonToastViewModel(labelText: .ContextMenuButtonToastNewTabOpenedLabelText,"
      ],
      "context_after": [
        "            }",
        "        })"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/BrowserViewController/Views/BrowserViewController.swift",
      "line": 3804,
      "type": "addition",
      "comment": "Update search engine icon",
      "firefox_code": [],
      "ecosia_code": [
        "            urlBar.updateSearchEngineImage()"
      ],
      "context_before": [
        "            applyTheme()",
        ""
      ],
      "context_after": [
        "",
        "            // TODO: [FXIOS-8907] Ideally we shouldn't create tabs as a side-effect of UI theme updates."
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/ButtonToast.swift",
      "line": 19,
      "type": "addition",
      "comment": "Add custom height",
      "firefox_code": [],
      "ecosia_code": [
        "        static let ecosiaButtonToastHeight: CGFloat = Toast.UX.toastHeight + Toast.UX.toastOffset",
        "        static let delay = DispatchTimeInterval.milliseconds(900)"
      ],
      "context_before": [
        "class ButtonToast: Toast {",
        "    struct UX {"
      ],
      "context_after": [
        "        // Ecosia: Adjust Padding",
        "        // static let padding: CGFloat = 15"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/ButtonToast.swift",
      "line": 22,
      "type": "substitution",
      "comment": "Adjust Padding",
      "firefox_code": [
        "static let padding: CGFloat = 15"
      ],
      "ecosia_code": [
        "        static let padding: CGFloat = 8"
      ],
      "context_before": [
        "        static let ecosiaButtonToastHeight: CGFloat = Toast.UX.toastHeight + Toast.UX.toastOffset",
        "        static let delay = DispatchTimeInterval.milliseconds(900)"
      ],
      "context_after": [
        "        // Ecosia: Adjust Padding",
        "        // static let buttonPadding: CGFloat = 10"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/ButtonToast.swift",
      "line": 25,
      "type": "substitution",
      "comment": "Adjust Padding",
      "firefox_code": [
        "static let buttonPadding: CGFloat = 10"
      ],
      "ecosia_code": [
        "        static let buttonPadding: CGFloat = 16",
        "        static let buttonBorderRadius: CGFloat = 5",
        "        static let buttonBorderWidth: CGFloat = 1"
      ],
      "context_before": [
        "        // static let padding: CGFloat = 15",
        "        static let padding: CGFloat = 8"
      ],
      "context_after": [
        "        // Ecosia: Add title and description font sizes",
        "        static let titleFontSize: CGFloat = 17"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/ButtonToast.swift",
      "line": 30,
      "type": "addition",
      "comment": "Add title and description font sizes",
      "firefox_code": [],
      "ecosia_code": [
        "        static let titleFontSize: CGFloat = 17",
        "        static let descriptionFontSize: CGFloat = 15",
        "        static let widthOffset: CGFloat = 20"
      ],
      "context_before": [
        "        static let buttonBorderRadius: CGFloat = 5",
        "        static let buttonBorderWidth: CGFloat = 1"
      ],
      "context_after": [
        "        // Ecosia: Add properties",
        "        static let standardCornerRadius: CGFloat = 10"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/ButtonToast.swift",
      "line": 34,
      "type": "addition",
      "comment": "Add properties",
      "firefox_code": [],
      "ecosia_code": [
        "        static let standardCornerRadius: CGFloat = 10"
      ],
      "context_before": [
        "        static let descriptionFontSize: CGFloat = 15",
        "        static let widthOffset: CGFloat = 20"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/ButtonToast.swift",
      "line": 43,
      "type": "addition",
      "comment": "Adjust properties",
      "firefox_code": [],
      "ecosia_code": [
        "        stackView.distribution = .fill",
        "        stackView.spacing = 8",
        "        stackView.layer.cornerRadius = UX.standardCornerRadius"
      ],
      "context_before": [
        "        stackView.alignment = .center",
        "        stackView.spacing = UX.padding"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/ButtonToast.swift",
      "line": 50,
      "type": "addition",
      "comment": "Add imageview properties",
      "firefox_code": [],
      "ecosia_code": [
        "        imageView.contentMode = .scaleAspectFit",
        "        imageView.setContentHuggingPriority(.required, for: .horizontal)"
      ],
      "context_before": [
        "",
        "    private var imageView: UIImageView = .build { imageView in"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/ButtonToast.swift",
      "line": 58,
      "type": "addition",
      "comment": "Review ToastView to look like v104",
      "firefox_code": [],
      "ecosia_code": [
        "        stackView.setContentHuggingPriority(.defaultLow, for: .horizontal)"
      ],
      "context_before": [
        "        stackView.axis = .vertical",
        "        stackView.alignment = .leading"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/ButtonToast.swift",
      "line": 63,
      "type": "removal",
      "comment": "Use title font size",
      "firefox_code": [
        "        label.font = FXFontStyles.Bold.subheadline.scaledFont()"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    private var titleLabel: UILabel = .build { label in"
      ],
      "context_after": [
        "        label.font = DefaultDynamicFontHelper.preferredFont(withTextStyle: .body,",
        "                                                            size: UX.titleFontSize)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/ButtonToast.swift",
      "line": 69,
      "type": "addition",
      "comment": "Review ToastView to look like v104",
      "firefox_code": [],
      "ecosia_code": [
        "        label.adjustsFontForContentSizeCategory = true",
        "        label.lineBreakMode = .byTruncatingTail",
        "        label.setContentHuggingPriority(.defaultLow, for: .horizontal)"
      ],
      "context_before": [
        "                                                            size: UX.titleFontSize)",
        "        label.numberOfLines = 0"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/ButtonToast.swift",
      "line": 76,
      "type": "removal",
      "comment": "Use description font size",
      "firefox_code": [
        "        label.font = FXFontStyles.Bold.footnote.scaledFont()"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    private var descriptionLabel: UILabel = .build { label in"
      ],
      "context_after": [
        "        label.font = DefaultDynamicFontHelper.preferredFont(withTextStyle: .body,",
        "                                                            size: UX.descriptionFontSize)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/ButtonToast.swift",
      "line": 85,
      "type": "removal",
      "comment": "Review ToastView to look like v104",
      "firefox_code": [
        "        button.layer.cornerRadius = UX.buttonBorderRadius",
        "        button.layer.borderWidth = UX.buttonBorderWidth",
        "        button.titleLabel?.font = FXFontStyles.Regular.subheadline.scaledFont()"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    private var roundedButton: UIButton = .build { button in"
      ],
      "context_after": [
        "        button.titleLabel?.font = DefaultDynamicFontHelper.preferredBoldFont(withTextStyle: .body,",
        "                                                                             size: UX.titleFontSize)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/ButtonToast.swift",
      "line": 115,
      "type": "removal",
      "comment": "Add custom height",
      "firefox_code": [
        "            heightAnchor.constraint(greaterThanOrEqualToConstant: Toast.UX.toastHeight)"
      ],
      "ecosia_code": [],
      "context_before": [
        "            toastView.heightAnchor.constraint(equalTo: heightAnchor),",
        ""
      ],
      "context_after": [
        "            heightAnchor.constraint(greaterThanOrEqualToConstant: UX.ecosiaButtonToastHeight),",
        "        ])"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/ButtonToast.swift",
      "line": 121,
      "type": "removal",
      "comment": "Add custom height",
      "firefox_code": [
        "        animationConstraint = toastView.topAnchor.constraint(greaterThanOrEqualTo: topAnchor,",
        "                                                             constant: Toast.UX.toastHeight)"
      ],
      "ecosia_code": [],
      "context_before": [
        "        ])",
        ""
      ],
      "context_after": [
        "        animationConstraint = toastView.topAnchor.constraint(greaterThanOrEqualTo: topAnchor,",
        "                                                             constant: UX.ecosiaButtonToastHeight)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/ButtonToast.swift",
      "line": 139,
      "type": "addition",
      "comment": "Review ToastView to look like v104",
      "firefox_code": [],
      "ecosia_code": [
        "        let space = UIView()",
        "        space.widthAnchor.constraint(equalToConstant: UX.padding).isActive = true",
        "        horizontalStackView.addArrangedSubview(space)"
      ],
      "context_before": [
        "    private func createView(viewModel: ButtonToastViewModel) -> UIView {",
        ""
      ],
      "context_after": [
        "",
        "        if let imageName = viewModel.imageName {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/ButtonToast.swift",
      "line": 171,
      "type": "removal",
      "comment": "Review constraints",
      "firefox_code": [
        "            horizontalStackView.leadingAnchor.constraint(equalTo: toastView.leadingAnchor, constant: UX.padding),",
        "            horizontalStackView.trailingAnchor.constraint(equalTo: toastView.trailingAnchor),",
        "            horizontalStackView.bottomAnchor.constraint(equalTo: toastView.safeAreaLayoutGuide.bottomAnchor),",
        "            horizontalStackView.topAnchor.constraint(equalTo: toastView.topAnchor),",
        "            horizontalStackView.heightAnchor.constraint(equalToConstant: Toast.UX.toastHeight),"
      ],
      "ecosia_code": [],
      "context_before": [
        "            labelStackView.centerYAnchor.constraint(equalTo: horizontalStackView.centerYAnchor),",
        ""
      ],
      "context_after": [
        "            horizontalStackView.leadingAnchor.constraint(equalTo: toastView.leadingAnchor, constant: Toast.UX.toastOffset),",
        "            horizontalStackView.trailingAnchor.constraint(equalTo: toastView.trailingAnchor, constant: -Toast.UX.toastOffset),"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/ButtonToast.swift",
      "line": 185,
      "type": "addition",
      "comment": "Review ToastView to look like v104",
      "firefox_code": [],
      "ecosia_code": [
        "        toastView.layer.cornerRadius = UX.standardCornerRadius",
        "        toastView.layer.masksToBounds = true"
      ],
      "context_before": [
        "        ])",
        ""
      ],
      "context_after": [
        "",
        "        return toastView"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/ButtonToast.swift",
      "line": 194,
      "type": "removal",
      "comment": "Review ToastView to look like v104",
      "firefox_code": [
        "        let paddedView = UIView()",
        "        paddedView.translatesAutoresizingMaskIntoConstraints = false",
        "        stackView.addArrangedSubview(paddedView)"
      ],
      "ecosia_code": [],
      "context_before": [
        "    func setupPaddedButton(stackView: UIStackView, buttonText: String?) {",
        "        guard let buttonText = buttonText else { return }"
      ],
      "context_after": [
        "        roundedButton.setTitle(buttonText, for: [])",
        "        // Ecosia: Review ToastView to look like v104"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/ButtonToast.swift",
      "line": 205,
      "type": "removal",
      "comment": "Review ToastView to look like v104",
      "firefox_code": [
        "            roundedButton.heightAnchor.constraint(",
        "                equalToConstant: roundedButton.titleLabel!.intrinsicContentSize.height + 2 * UX.buttonPadding),",
        "            roundedButton.widthAnchor.constraint(",
        "                equalToConstant: roundedButton.titleLabel!.intrinsicContentSize.width + 2 * UX.buttonPadding),",
        "            roundedButton.centerYAnchor.constraint(equalTo: paddedView.centerYAnchor),",
        "            roundedButton.centerXAnchor.constraint(equalTo: paddedView.centerXAnchor),",
        "            paddedView.topAnchor.constraint(equalTo: stackView.topAnchor),",
        "            paddedView.bottomAnchor.constraint(equalTo: stackView.bottomAnchor),",
        "            paddedView.widthAnchor.constraint(equalTo: roundedButton.widthAnchor, constant: UX.widthOffset)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "        NSLayoutConstraint.activate(["
      ],
      "context_after": [
        "            roundedButton.widthAnchor.constraint(",
        "                equalToConstant: roundedButton.titleLabel!.intrinsicContentSize.width + 2 * UX.buttonPadding),"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/ButtonToast.swift",
      "line": 221,
      "type": "substitution",
      "comment": "Review ToastView to look like v104",
      "firefox_code": [
        "roundedButton.addGestureRecognizer(UITapGestureRecognizer(target: self, action: #selector(buttonPressed)))",
        "paddedView.addGestureRecognizer(UITapGestureRecognizer(target: self, action: #selector(buttonPressed)))"
      ],
      "ecosia_code": [
        "        roundedButton.addTarget(self, action: #selector(buttonPressed), for: .primaryActionTriggered)"
      ],
      "context_before": [
        "        ])",
        ""
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/ButtonToast.swift",
      "line": 232,
      "type": "removal",
      "comment": "Add image tintColor to look like v104",
      "firefox_code": [
        "        imageView.tintColor = theme.colors.textInverted"
      ],
      "ecosia_code": [],
      "context_before": [
        "        titleLabel.textColor = theme.colors.textInverted",
        "        descriptionLabel.textColor = theme.colors.textInverted"
      ],
      "context_after": [
        "        imageView.tintColor = theme.colors.ecosia.iconInverseStrong",
        "        roundedButton.setTitleColor(theme.colors.textInverted, for: [])"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/ButtonToast.swift",
      "line": 237,
      "type": "removal",
      "comment": "Add `horizontalStackView` background as the Toast view is made clear",
      "firefox_code": [
        "           so to have the padding effect from bottom, left and right"
      ],
      "ecosia_code": [],
      "context_before": [
        "        imageView.tintColor = theme.colors.ecosia.iconInverseStrong",
        "        roundedButton.setTitleColor(theme.colors.textInverted, for: [])"
      ],
      "context_after": [
        "        horizontalStackView.backgroundColor = theme.colors.ecosia.backgroundNeutralInverse",
        "        // Ecosia: Review ToastView to look like v104"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/DefaultSearchPrefs.swift",
      "line": 76,
      "type": "substitution",
      "comment": "Guarantee the global default engine is included",
      "firefox_code": [
        "This enables ecosia to be set as default even in locales where it normally is not listed"
      ],
      "ecosia_code": [
        "        if !usersEngineList.contains(globalDefaultEngine) {",
        "            usersEngineList.append(globalDefaultEngine)"
      ],
      "context_before": [
        "        }",
        ""
      ],
      "context_after": [
        "        }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/EnhancedTrackingProtection/EnhancedTrackingProtectionVC.swift",
      "line": 127,
      "type": "removal",
      "comment": "Use themed Switch",
      "firefox_code": [
        "    private let toggleSwitch: UISwitch = .build { toggleSwitch in"
      ],
      "ecosia_code": [],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "    private let toggleSwitch: EcosiaThemedSwitch = .build { toggleSwitch in",
        "        toggleSwitch.isEnabled = true"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/EnhancedTrackingProtection/EnhancedTrackingProtectionVC.swift",
      "line": 530,
      "type": "removal",
      "comment": "Use applyTheme from EcosiaThemedSwitch",
      "firefox_code": [
        "        toggleSwitch.tintColor = theme.colors.actionPrimary",
        "        toggleSwitch.onTintColor = theme.colors.actionPrimary"
      ],
      "ecosia_code": [],
      "context_before": [
        "        }",
        "        toggleView.backgroundColor = theme.colors.layer2"
      ],
      "context_after": [
        "        toggleSwitch.applyTheme(theme: theme)",
        "        toggleStatusLabel.textColor = theme.colors.textSecondary"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenu/MainMenuTelemetry.swift",
      "line": 6,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "import Glean"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "import Foundation"
      ],
      "context_after": [
        "",
        "struct MainMenuTelemetry {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenu/MainMenuTelemetry.swift",
      "line": 12,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        let extra = GleanMetrics.AppMenu.MainMenuOptionSelectedExtra(isHomepage: isHomepage, option: option)",
        "        GleanMetrics.AppMenu.mainMenuOptionSelected.record(extra)"
      ],
      "ecosia_code": [],
      "context_before": [
        "struct MainMenuTelemetry {",
        "    func mainMenuOptionTapped(with isHomepage: Bool, and option: String) {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenu/MainMenuTelemetry.swift",
      "line": 19,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        let extra = GleanMetrics.AppMenu.SaveMenuOptionSelectedExtra(isHomepage: isHomepage, option: option)",
        "        GleanMetrics.AppMenu.saveMenuOptionSelected.record(extra)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func saveSubmenuOptionTapped(with isHomepage: Bool, and option: String) {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenu/MainMenuTelemetry.swift",
      "line": 26,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        let extra = GleanMetrics.AppMenu.ToolsMenuOptionSelectedExtra(isHomepage: isHomepage, option: option)",
        "        GleanMetrics.AppMenu.toolsMenuOptionSelected.record(extra)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func toolsSubmenuOptionTapped(with isHomepage: Bool, and option: String) {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenu/MainMenuTelemetry.swift",
      "line": 33,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        let extra = GleanMetrics.AppMenu.CloseButtonExtra(isHomepage: isHomepage)",
        "        GleanMetrics.AppMenu.closeButton.record(extra)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func closeButtonTapped(isHomepage: Bool) {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenu/MainMenuTelemetry.swift",
      "line": 40,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        let extra = GleanMetrics.AppMenu.MenuDismissedExtra(isHomepage: isHomepage)",
        "        GleanMetrics.AppMenu.menuDismissed.record(extra)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func menuDismissed(isHomepage: Bool) {"
      ],
      "context_after": [
        "    }",
        "}"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 5,
      "type": "substitution",
      "comment": "Remove `import Account`",
      "firefox_code": [
        "import Account"
      ],
      "ecosia_code": [
        "import Foundation",
        "import Shared",
        "import Storage",
        "import UIKit",
        "import SwiftUI",
        "import Common",
        "import Ecosia"
      ],
      "context_before": [
        "// file, You can obtain one at http://mozilla.org/MPL/2.0/",
        ""
      ],
      "context_after": [
        "// Ecosia: Need SafariServices to enable \"open in safari\" action",
        "import SafariServices"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 14,
      "type": "addition",
      "comment": "Need SafariServices to enable \"open in safari\" action",
      "firefox_code": [],
      "ecosia_code": [
        "import SafariServices"
      ],
      "context_before": [
        "import Common",
        "import Ecosia"
      ],
      "context_after": [
        "",
        "protocol ToolBarActionMenuDelegate: AnyObject {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 24,
      "type": "addition",
      "comment": "Add option to open in same tab",
      "firefox_code": [],
      "ecosia_code": [
        "    func openURLInCurrentTab(_ url: URL?)"
      ],
      "context_before": [
        "    func openURLInNewTab(_ url: URL?, isPrivate: Bool) -> Tab",
        "    func openNewTabFromMenu(focusLocationField: Bool, isPrivate: Bool)"
      ],
      "context_after": [
        "",
        "    func showLibrary(panel: LibraryPanelType)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 114,
      "type": "substitution",
      "comment": "Remove unused constant",
      "firefox_code": [
        "let firstMiscSection = getFirstMiscSection(navigationController)"
      ],
      "ecosia_code": [],
      "context_before": [
        "                           completion: @escaping ([[PhotonRowActions]]) -> Void) {",
        "        var actions: [[PhotonRowActions]] = []"
      ],
      "context_after": [
        "",
        "        if isHomePage {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 119,
      "type": "removal",
      "comment": "Remove Misc Section",
      "firefox_code": [
        "                firstMiscSection"
      ],
      "ecosia_code": [],
      "context_before": [
        "        if isHomePage {",
        "            actions.append(contentsOf: ["
      ],
      "context_after": [
        "                getLibrarySection(),",
        "                getLastSection()"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 131,
      "type": "removal",
      "comment": "Review Sections",
      "firefox_code": [
        "                    self.getNewTabSection(),",
        "                    getLibrarySection(),",
        "                    firstMiscSection,",
        "                    self.getSecondMiscSection(),",
        "                    self.getLastSection()"
      ],
      "ecosia_code": [],
      "context_before": [
        "            updateData(dataLoadingCompletion: {",
        "                actions.append(contentsOf: ["
      ],
      "context_after": [
        "                    self.getPageActionsSection(navigationController),",
        "                    self.getLibrarySection(),"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 150,
      "type": "addition",
      "comment": "Readd sections from v104",
      "firefox_code": [],
      "ecosia_code": [],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "",
        "    private func getPageActionsSection(_ navigationController: UINavigationController?) -> [PhotonRowActions] {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 169,
      "type": "addition",
      "comment": "Add Zoom Action",
      "firefox_code": [],
      "ecosia_code": [
        "            let zoomAction = getZoomAction()",
        "            append(to: &section, action: zoomAction)"
      ],
      "context_before": [
        "        if !isHomePage && !isFileURL {",
        ""
      ],
      "context_after": [
        "",
        "            let findInPageAction = getFindInPageAction()"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 179,
      "type": "removal",
      "comment": "Remove report issue",
      "firefox_code": [
        "            let reportSiteIssueAction = getReportSiteIssueAction()",
        "            append(to: &section, action: reportSiteIssueAction)"
      ],
      "ecosia_code": [],
      "context_before": [
        "            append(to: &section, action: desktopSiteAction)",
        ""
      ],
      "context_after": [
        "        }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 284,
      "type": "removal",
      "comment": "Rearrange item positions",
      "firefox_code": [
        "            let bookmarkSection = getBookmarkSection()",
        "            append(to: &section, action: bookmarkSection)",
        "            let historySection = getHistoryLibraryAction()",
        "            append(to: &section, action: historySection)",
        "            let downloadSection = getDownloadsLibraryAction()",
        "            append(to: &section, action: downloadSection)",
        "            let readingListSection = getReadingListSection()",
        "            append(to: &section, action: readingListSection)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "        if !isFileURL {"
      ],
      "context_after": [
        "",
        "            let bookmarkSection = getBookmarkSection()"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 311,
      "type": "removal",
      "comment": "Remove sync menu",
      "firefox_code": [
        "        let syncAction = syncMenuButton()",
        "        append(to: &section, action: syncAction)"
      ],
      "ecosia_code": [],
      "context_before": [
        "        }",
        ""
      ],
      "context_after": [
        "        return section",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 321,
      "type": "addition",
      "comment": "Rearrange items",
      "firefox_code": [],
      "ecosia_code": [],
      "context_before": [
        "        var section = [PhotonRowActions]()",
        ""
      ],
      "context_after": [
        "",
        "        if !isHomePage && !isFileURL {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 336,
      "type": "addition",
      "comment": "Adding help button",
      "firefox_code": [],
      "ecosia_code": [
        "        let helpAction = getHelpAction()",
        "        section.append(helpAction)"
      ],
      "context_before": [
        "        }",
        ""
      ],
      "context_after": [
        "",
        "        /* Ecosia: Disable night mode feature flag"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 340,
      "type": "removal",
      "comment": "Disable night mode feature flag",
      "firefox_code": [
        "        if featureFlags.isFeatureEnabled(.nightMode, checking: .buildOnly) {",
        "            let nightModeAction = getNightModeAction()",
        "            append(to: &section, action: nightModeAction)",
        "        }"
      ],
      "ecosia_code": [],
      "context_before": [
        "        section.append(helpAction)",
        ""
      ],
      "context_after": [
        "        let nightModeAction = getNightModeAction()",
        "        append(to: &section, action: nightModeAction)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 349,
      "type": "removal",
      "comment": "Disable Passwords option",
      "firefox_code": [
        "        let passwordsAction = getPasswordAction(navigationController: navigationController)",
        "        append(to: &section, action: passwordsAction)"
      ],
      "ecosia_code": [],
      "context_before": [
        "        append(to: &section, action: nightModeAction)",
        ""
      ],
      "context_after": [
        "        if !isHomePage && !isFileURL {",
        "            let reportSiteIssueAction = getReportSiteIssueAction()"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 394,
      "type": "removal",
      "comment": "Return different items for this sections",
      "firefox_code": [
        "        if isHomePage {",
        "            let whatsNewAction = getWhatsNewAction()",
        "            append(to: &section, action: whatsNewAction)",
        "            let helpAction = getHelpAction()",
        "            section.append(helpAction)",
        "            let customizeHomePageAction = getCustomizeHomePageAction()",
        "            append(to: &section, action: customizeHomePageAction)",
        "        }",
        "        let settingsAction = getSettingsAction()",
        "        section.append(settingsAction)"
      ],
      "ecosia_code": [],
      "context_before": [
        "        var section = [PhotonRowActions]()",
        ""
      ],
      "context_after": [
        "",
        "        let nightModeAction = getNightModeAction()"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 432,
      "type": "addition",
      "comment": "Track new tab action",
      "firefox_code": [],
      "ecosia_code": [
        "            Analytics.shared.menuClick(.newTab)",
        "        }.items"
      ],
      "context_before": [
        "            TelemetryWrapper.recordEvent(category: .action, method: .tap, object: .createNewTab)",
        ""
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 443,
      "type": "addition",
      "comment": "Track history action",
      "firefox_code": [],
      "ecosia_code": [
        "            Analytics.shared.menuClick(.history)",
        "        }.items"
      ],
      "context_before": [
        "            TelemetryWrapper.recordEvent(category: .action, method: .tap, object: .viewHistoryPanel)",
        ""
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 454,
      "type": "addition",
      "comment": "Track downloads action",
      "firefox_code": [],
      "ecosia_code": [
        "            Analytics.shared.menuClick(.downloads)",
        "        }.items"
      ],
      "context_before": [
        "            TelemetryWrapper.recordEvent(category: .action, method: .tap, object: .viewDownloadsPanel)",
        ""
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 469,
      "type": "addition",
      "comment": "Track zoom action",
      "firefox_code": [],
      "ecosia_code": [
        "            Analytics.shared.menuClick(.zoom)",
        "        }.items",
        "        return zoomAction"
      ],
      "context_before": [
        "            self.delegate?.showZoomPage(tab: tab)",
        ""
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 476,
      "type": "removal",
      "comment": "Update Image",
      "firefox_code": [
        "        return SingleActionViewModel(title: .LegacyAppMenu.AppMenuFindInPageTitleString,",
        "                                     iconString: StandardImageIdentifiers.Large.search) { _ in"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    private func getFindInPageAction() -> PhotonRowActions {"
      ],
      "context_after": [
        "        return SingleActionViewModel(title: .LegacyAppMenu.AppMenuFindInPageTitleString,",
        "                                     iconString: \"menu-FindInPageUpdate\") { _ in"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 485,
      "type": "addition",
      "comment": "Track find in page action",
      "firefox_code": [],
      "ecosia_code": [
        "            Analytics.shared.menuClick(.findInPage)",
        "        }.items"
      ],
      "context_before": [
        "            self.delegate?.showFindInPage()",
        ""
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 520,
      "type": "addition",
      "comment": "Track request desktop site action",
      "firefox_code": [],
      "ecosia_code": [
        "                Analytics.shared.menuClick(.requestDesktopSite)"
      ],
      "context_before": [
        "                TelemetryWrapper.recordEvent(category: .action, method: .tap, object: siteTypeTelemetryObject)",
        ""
      ],
      "context_after": [
        "            }",
        "        }.items"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 527,
      "type": "removal",
      "comment": "Update Image",
      "firefox_code": [
        "        return SingleActionViewModel(title: .LegacyAppMenu.AppMenuCopyLinkTitleString,",
        "                                     iconString: StandardImageIdentifiers.Large.link) { _ in"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    private func getCopyAction() -> PhotonRowActions? {"
      ],
      "context_after": [
        "        return SingleActionViewModel(title: .LegacyAppMenu.AppMenuCopyLinkTitleString,",
        "                                     iconString: \"menu-Copy-Link\") { _ in"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 539,
      "type": "addition",
      "comment": "Track copy link action",
      "firefox_code": [],
      "ecosia_code": [
        "            Analytics.shared.menuClick(.copyLink)",
        "        }.items"
      ],
      "context_before": [
        "            }",
        ""
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 584,
      "type": "removal",
      "comment": "Replacing Firefox Support URL with Ecosia FAQ URL",
      "firefox_code": [
        "            if let url = URL(string: \"https://support.mozilla.org/products/ios\") {",
        "                self.delegate?.openURLInNewTab(url, isPrivate: self.tabManager.selectedTab?.isPrivate ?? false)",
        "            }",
        "            TelemetryWrapper.recordEvent(category: .action, method: .tap, object: .help)"
      ],
      "ecosia_code": [],
      "context_before": [
        "        return SingleActionViewModel(title: .LegacyAppMenu.Help,",
        "                                     iconString: StandardImageIdentifiers.Large.helpCircle) { _ in"
      ],
      "context_after": [
        "            self.delegate?.openURLInCurrentTab(EcosiaEnvironment.current.urlProvider.faq)",
        "            Analytics.shared.menuClick(.help)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 601,
      "type": "addition",
      "comment": "Track customize homepage action",
      "firefox_code": [],
      "ecosia_code": [
        "            Analytics.shared.menuClick(.customizeHomepage)",
        "        }.items"
      ],
      "context_before": [
        "            TelemetryWrapper.recordEvent(category: .action, method: .tap, object: .customizeHomePage)",
        ""
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 623,
      "type": "removal",
      "comment": "Update Night mode copy/imagery",
      "firefox_code": [
        "        let nightModeTitle: String = if nightModeEnabled {",
        "            .LegacyAppMenu.AppMenuTurnOffNightMode",
        "        } else {",
        "            .LegacyAppMenu.AppMenuTurnOnNightMode",
        "        }",
        "        let nightMode = SingleActionViewModel(",
        "            title: nightModeTitle,",
        "            iconString: StandardImageIdentifiers.Large.nightMode,",
        "            isEnabled: nightModeEnabled",
        "        ) { _ in"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "        let nightModeEnabled = NightModeHelper.isActivated()"
      ],
      "context_after": [
        "        let nightModeTitle: String = nightModeEnabled ? .localized(.turnOffDarkMode) : .localized(.forceDarkMode)",
        "        let nightMode = SingleActionViewModel(title: nightModeTitle,"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 642,
      "type": "addition",
      "comment": "Track dark mode changes",
      "firefox_code": [],
      "ecosia_code": [
        "            Analytics.shared.menuStatus(changed: .darkMode, to: !nightModeEnabled)"
      ],
      "context_before": [
        "            NightModeHelper.toggle()",
        ""
      ],
      "context_after": [
        "",
        "            if NightModeHelper.isActivated() {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 658,
      "type": "removal",
      "comment": "Remove sync menu button dependant from the Account module",
      "firefox_code": [
        "    private func syncMenuButton() -> PhotonRowActions? {",
        "        let action: (SingleActionViewModel) -> Void = { [weak self] action in",
        "            let fxaParams = FxALaunchParams(entrypoint: .browserMenu, query: [:])",
        "            let parameters = FxASignInViewParameters(launchParameters: fxaParams,",
        "                                                     flowType: .emailLoginFlow,",
        "                                                     referringPage: .appMenu)",
        "            self?.delegate?.showSignInView(fxaParameters: parameters)",
        "            TelemetryWrapper.recordEvent(category: .action, method: .tap, object: .signIntoSync)",
        "        }",
        "        let rustAccount = RustFirefoxAccounts.shared",
        "        let needsReAuth = rustAccount.accountNeedsReauth()",
        "        guard let userProfile = rustAccount.userProfile else {",
        "            return SingleActionViewModel(title: .LegacyAppMenu.SyncAndSaveData,",
        "                                         iconString: StandardImageIdentifiers.Large.sync,",
        "                                         tapHandler: action).items",
        "        }",
        "        let title: String = {",
        "            if rustAccount.accountNeedsReauth() {",
        "                return .FxAAccountVerifyPassword",
        "            }",
        "            return userProfile.displayName ?? userProfile.email",
        "        }()",
        "        let warningImage = StandardImageIdentifiers.Large.warningFill",
        "        let avatarImage = StandardImageIdentifiers.Large.avatarCircle",
        "        let iconString = needsReAuth ? warningImage : avatarImage",
        "        var iconURL: URL?",
        "        if let str = rustAccount.userProfile?.avatarUrl,",
        "            let url = URL(string: str, invalidCharacters: false) {",
        "            iconURL = url",
        "        }",
        "        let iconType: PhotonActionSheetIconType = needsReAuth ? .Image : .URL",
        "        let syncOption = SingleActionViewModel(title: title,",
        "                                               iconString: iconString,",
        "                                               iconURL: iconURL,",
        "                                               iconType: iconType,",
        "                                               needsIconActionableTint: needsReAuth,",
        "                                               tapHandler: action).items",
        "        return syncOption",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "",
        "    // MARK: Whats New"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 744,
      "type": "addition",
      "comment": "Analytics",
      "firefox_code": [],
      "ecosia_code": [
        "            Analytics.shared.menuShare(.file)",
        "        }.items"
      ],
      "context_before": [
        "            self.share(fileURL: url, buttonView: self.buttonView)",
        ""
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 753,
      "type": "substitution",
      "comment": "if we have nothing to share we share Ecosia Root URL",
      "firefox_code": [
        "guard let tab = self.selectedTab, let url = tab.canonicalURL?.displayURL else { return }"
      ],
      "ecosia_code": [
        "            guard let tab = self.selectedTab else { return }",
        "            let url = tab.canonicalURL?.displayURL ?? EcosiaEnvironment.current.urlProvider.root"
      ],
      "context_before": [
        "                                     iconString: StandardImageIdentifiers.Large.share) { _ in",
        ""
      ],
      "context_after": [
        "",
        "            TelemetryWrapper.recordEvent(category: .action, method: .tap, object: .sharePageWith)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 760,
      "type": "addition",
      "comment": "Analytics",
      "firefox_code": [],
      "ecosia_code": [
        "            if tab.canonicalURL?.displayURL == nil {",
        "                Analytics.shared.menuShare(.ntp)",
        "            } else {",
        "                Analytics.shared.menuShare(.web)"
      ],
      "context_before": [
        "            TelemetryWrapper.recordEvent(category: .action, method: .tap, object: .sharePageWith)",
        ""
      ],
      "context_after": [
        "            }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 835,
      "type": "removal",
      "comment": "Update image",
      "firefox_code": [
        "        return SingleActionViewModel(title: .LegacyAppMenu.ReadingList,",
        "                                     iconString: StandardImageIdentifiers.Large.readingList) { _ in"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    private func getReadingListLibraryAction() -> SingleActionViewModel {"
      ],
      "context_after": [
        "        return SingleActionViewModel(title: .LegacyAppMenu.ReadingList,",
        "                                     iconString: \"libraryReading\") { _ in"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 843,
      "type": "addition",
      "comment": "Track reading list action",
      "firefox_code": [],
      "ecosia_code": [
        "            Analytics.shared.menuClick(.readingList)"
      ],
      "context_before": [
        "            self.delegate?.showLibrary(panel: .readingList)",
        ""
      ],
      "context_after": [
        "        }",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 853,
      "type": "removal",
      "comment": "Update Title and Image",
      "firefox_code": [
        "        return SingleActionViewModel(title: .LegacyAppMenu.AddReadingList,",
        "                                     iconString: StandardImageIdentifiers.Large.readingListAdd) { _ in"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    private func getAddReadingListAction() -> SingleActionViewModel {"
      ],
      "context_after": [
        "        return SingleActionViewModel(title: .ShareAddToReadingList,",
        "                                     iconString: \"addToReadingListUpdate\") { _ in"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 876,
      "type": "addition",
      "comment": "Track add reading list",
      "firefox_code": [],
      "ecosia_code": [
        "            Analytics.shared.menuStatus(changed: .readingList, to: true)"
      ],
      "context_before": [
        "            self.delegate?.showToast(message: .LegacyAppMenu.AddToReadingListConfirmMessage, toastAction: .addToReadingList)",
        ""
      ],
      "context_after": [
        "        }",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 896,
      "type": "addition",
      "comment": "Track remove reading list",
      "firefox_code": [],
      "ecosia_code": [
        "            Analytics.shared.menuStatus(changed: .readingList, to: false)"
      ],
      "context_before": [
        "                                         value: .pageActionMenu)",
        ""
      ],
      "context_after": [
        "        }",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 920,
      "type": "addition",
      "comment": "Track reading list action",
      "firefox_code": [],
      "ecosia_code": [
        "            Analytics.shared.menuClick(.bookmarks)"
      ],
      "context_before": [
        "            self.delegate?.showLibrary(panel: .bookmarks)",
        ""
      ],
      "context_after": [
        "        }",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 930,
      "type": "removal",
      "comment": "Update Title and Image",
      "firefox_code": [
        "        return SingleActionViewModel(title: .LegacyAppMenu.AddBookmark,",
        "                                     iconString: StandardImageIdentifiers.Large.bookmark) { _ in"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    private func getAddBookmarkAction() -> SingleActionViewModel {"
      ],
      "context_after": [
        "        return SingleActionViewModel(title: .KeyboardShortcuts.AddBookmark,",
        "                                     iconString: \"menu-Bookmark\") { _ in"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 949,
      "type": "addition",
      "comment": "Track add bookmark",
      "firefox_code": [],
      "ecosia_code": [
        "            Analytics.shared.menuStatus(changed: .bookmark, to: true)"
      ],
      "context_before": [
        "            )",
        ""
      ],
      "context_after": [
        "        }",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 955,
      "type": "substitution",
      "comment": "Update Title",
      "firefox_code": [
        "return SingleActionViewModel(title: .LegacyAppMenu.RemoveBookmark,"
      ],
      "ecosia_code": [
        "        return SingleActionViewModel(title: .RemoveBookmarkContextMenuTitle,",
        "                                     iconString: StandardImageIdentifiers.Large.bookmarkSlash) { _ in",
        "            guard let url = self.tabUrl?.displayURL else { return }"
      ],
      "context_before": [
        "",
        "    private func getRemoveBookmarkAction() -> SingleActionViewModel {"
      ],
      "context_after": [
        "",
        "            self.profile.places.deleteBookmarksWithURL(url: url.absoluteString).uponQueue(.main) { result in"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 977,
      "type": "addition",
      "comment": "Track remove bookmark",
      "firefox_code": [],
      "ecosia_code": [
        "            Analytics.shared.menuStatus(changed: .bookmark, to: false)"
      ],
      "context_before": [
        "            )",
        ""
      ],
      "context_after": [
        "        }",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 989,
      "type": "removal",
      "comment": "Update Image",
      "firefox_code": [
        "        return SingleActionViewModel(title: .AddToShortcutsActionTitle,",
        "                                     iconString: StandardImageIdentifiers.Large.pin) { _ in"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    private func getAddShortcutAction() -> SingleActionViewModel {"
      ],
      "context_after": [
        "        return SingleActionViewModel(title: .AddToShortcutsActionTitle,",
        "                                     iconString: \"action_pin\") { _ in"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 1005,
      "type": "addition",
      "comment": "Track add shortcut",
      "firefox_code": [],
      "ecosia_code": [
        "            Analytics.shared.menuStatus(changed: .shortcut, to: true)"
      ],
      "context_before": [
        "            TelemetryWrapper.recordEvent(category: .action, method: .tap, object: .pinToTopSites)",
        ""
      ],
      "context_after": [
        "        }",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 1011,
      "type": "removal",
      "comment": "Update Image",
      "firefox_code": [
        "        return SingleActionViewModel(title: .LegacyAppMenu.RemoveFromShortcuts,",
        "                                     iconString: StandardImageIdentifiers.Large.pinSlash) { _ in"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    private func getRemoveShortcutAction() -> SingleActionViewModel {"
      ],
      "context_after": [
        "        return SingleActionViewModel(title: .LegacyAppMenu.RemoveFromShortcuts,",
        "                                     iconString: \"action_unpin\") { _ in"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 1030,
      "type": "addition",
      "comment": "Track remove shortcut",
      "firefox_code": [],
      "ecosia_code": [
        "            Analytics.shared.menuStatus(changed: .shortcut, to: false)"
      ],
      "context_before": [
        "            TelemetryWrapper.recordEvent(category: .action, method: .tap, object: .removePinnedSite)",
        ""
      ],
      "context_after": [
        "        }",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/MainMenuActionHelper.swift",
      "line": 1063,
      "type": "addition",
      "comment": "Add helper function from old codebase",
      "firefox_code": [],
      "ecosia_code": [
        "extension MainMenuActionHelper {",
        "    func getSharingAction() -> PhotonRowActions {",
        "        isFileURL ? getShareFileAction() : getShareAction()"
      ],
      "context_before": [
        "}",
        ""
      ],
      "context_after": [
        "    }",
        "}"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Search/SearchViewController.swift",
      "line": 79,
      "type": "removal",
      "comment": "Update image reference for search button",
      "firefox_code": [
        "        let image = UIImage(named: StandardImageIdentifiers.Large.search)?.withRenderingMode(.alwaysTemplate)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    private lazy var searchButton: UIButton = .build { button in"
      ],
      "context_after": [
        "        let image = UIImage(named: \"searches\")?.withRenderingMode(.alwaysTemplate)",
        "        button.setImage(image, for: [])"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Search/SearchViewController.swift",
      "line": 97,
      "type": "removal",
      "comment": "Update init adding `style`",
      "firefox_code": [
        "        super.init(profile: profile, windowUUID: tabManager.windowUUID)"
      ],
      "ecosia_code": [],
      "context_before": [
        "        self.searchTelemetry = SearchTelemetry(tabManager: tabManager)",
        ""
      ],
      "context_after": [
        "        super.init(profile: profile, windowUUID: tabManager.windowUUID, style: .insetGrouped)",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Search/SearchViewController.swift",
      "line": 262,
      "type": "substitution",
      "comment": "Hide `searchEngineScrollView` by changing constraints",
      "firefox_code": [
        "tableView.bottomAnchor.constraint(equalTo: searchEngineScrollView.topAnchor)"
      ],
      "ecosia_code": [
        "            tableView.bottomAnchor.constraint(equalTo: view.bottomAnchor)",
        "        ])"
      ],
      "context_before": [
        "            tableView.leadingAnchor.constraint(equalTo: view.leadingAnchor),",
        "            tableView.trailingAnchor.constraint(equalTo: view.trailingAnchor),"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Search/SearchViewController.swift",
      "line": 450,
      "type": "addition",
      "comment": "Check if this is the AI Search item",
      "firefox_code": [],
      "ecosia_code": [
        "            if isAISearchRow(indexPath) {",
        "                handleAISearchSelection(indexPath)",
        "                return"
      ],
      "context_before": [
        "        switch SearchListSection(rawValue: indexPath.section)! {",
        "        case .searchSuggestions:"
      ],
      "context_after": [
        "            }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Search/SearchViewController.swift",
      "line": 576,
      "type": "removal",
      "comment": "Modified to skip telemetry for AI Search item and use safe array access",
      "firefox_code": [
        "                if let site = viewModel.suggestions?[indexPath.row] {",
        "                    if searchTelemetry?.visibleSuggestions.contains(site) == false {",
        "                        searchTelemetry?.visibleSuggestions.append(site)",
        "                    }",
        "                }"
      ],
      "ecosia_code": [],
      "context_before": [
        "            switch section {",
        "            case .searchSuggestions:"
      ],
      "context_after": [
        "                // Ecosia: Skip telemetry for AI Search item",
        "                if !isAISearchRow(indexPath),"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Search/SearchViewController.swift",
      "line": 636,
      "type": "addition",
      "comment": "Update cell background",
      "firefox_code": [],
      "ecosia_code": [
        "        cell.backgroundColor = currentTheme().colors.ecosia.backgroundElevation1"
      ],
      "context_before": [
        "        }",
        ""
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Search/SearchViewController.swift",
      "line": 643,
      "type": "addition",
      "comment": "Use our custom method that includes AI Search item",
      "firefox_code": [],
      "ecosia_code": [
        "            return numberOfRowsForSearchSuggestions()",
        "            /* Ecosia: Modified to include AI Search item when feature flag is enabled",
        "            guard let count = viewModel.suggestions?.count else { return 0 }",
        "            return count < 4 ? count : 4",
        "            */",
        "        case .openedTabs:",
        "            return viewModel.filteredOpenedTabs.count",
        "        case .remoteTabs:",
        "            return viewModel.shouldShowSyncedTabsSuggestions ? viewModel.filteredRemoteClientTabs.count : 0",
        "        case .history:",
        "            return viewModel.shouldShowBrowsingHistorySuggestions ? viewModel.historySites.count : 0",
        "        case .bookmarks:",
        "            return viewModel.shouldShowBookmarksSuggestions ? viewModel.bookmarkSites.count : 0",
        "        case .searchHighlights:",
        "            return viewModel.searchHighlights.count",
        "        case .firefoxSuggestions:",
        "            return viewModel.firefoxSuggestions.count"
      ],
      "context_before": [
        "        switch SearchListSection(rawValue: section)! {",
        "        case .searchSuggestions:"
      ],
      "context_after": [
        "        }",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Search/SearchViewController.swift",
      "line": 645,
      "type": "removal",
      "comment": "Modified to include AI Search item when feature flag is enabled",
      "firefox_code": [
        "            guard let count = viewModel.suggestions?.count else { return 0 }",
        "            return count < 4 ? count : 4"
      ],
      "ecosia_code": [],
      "context_before": [
        "            // Ecosia: Use our custom method that includes AI Search item",
        "            return numberOfRowsForSearchSuggestions()"
      ],
      "context_after": [
        "        case .openedTabs:",
        "            return viewModel.filteredOpenedTabs.count"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Search/SearchViewController.swift",
      "line": 680,
      "type": "addition",
      "comment": "Check if this is the AI Search item",
      "firefox_code": [],
      "ecosia_code": [
        "            if isAISearchRow(indexPath) {",
        "                handleAISearchHighlight(indexPath)",
        "                return"
      ],
      "context_before": [
        "            searchDelegate?.searchViewController(self, didHighlightText: suggestion.url, search: false)",
        "        case .searchSuggestions:"
      ],
      "context_after": [
        "            }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Search/SearchViewController.swift",
      "line": 686,
      "type": "removal",
      "comment": "Modified to handle AI Search item and use safe array access",
      "firefox_code": [
        "            let suggestion = viewModel.suggestions?[indexPath.item] ?? \"\""
      ],
      "ecosia_code": [],
      "context_before": [
        "            }",
        ""
      ],
      "context_after": [
        "            guard let suggestion = safeSuggestion(at: indexPath.item) else { return }",
        "            searchDelegate?.searchViewController(self, didHighlightText: suggestion, search: false)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Search/SearchViewController.swift",
      "line": 709,
      "type": "removal",
      "comment": "Update background",
      "firefox_code": [
        "        searchEngineContainerView.layer.backgroundColor = currentTheme().colors.layer1.cgColor"
      ],
      "ecosia_code": [],
      "context_before": [
        "        searchButton.tintColor = currentTheme().colors.iconPrimary",
        ""
      ],
      "context_after": [
        "        searchEngineContainerView.layer.backgroundColor = currentTheme().colors.ecosia.backgroundPrimary.cgColor",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Search/SearchViewController.swift",
      "line": 735,
      "type": "addition",
      "comment": "It makes sense to call applyTheme here to let it do the first setup and then override the values appropriately",
      "firefox_code": [],
      "ecosia_code": [
        "        oneLineCell.applyTheme(theme: currentTheme())",
        "        twoLineCell.applyTheme(theme: currentTheme())"
      ],
      "context_before": [
        "                                   for section: SearchListSection,",
        "                                   _ indexPath: IndexPath) -> UITableViewCell {"
      ],
      "context_after": [
        "",
        "        var cell = UITableViewCell()"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Search/SearchViewController.swift",
      "line": 742,
      "type": "removal",
      "comment": "Modified to handle AI Search item and use safe array access",
      "firefox_code": [
        "            if let site = viewModel.suggestions?[indexPath.row] {"
      ],
      "ecosia_code": [],
      "context_before": [
        "        switch section {",
        "        case .searchSuggestions:"
      ],
      "context_after": [
        "            if isAISearchRow(indexPath) {",
        "                cell = configureAISearchCell(oneLineCell)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Search/SearchViewController.swift",
      "line": 759,
      "type": "removal",
      "comment": "Update set image",
      "firefox_code": [
        "                oneLineCell.leftImageView.manuallySetImage(",
        "                    UIImage(named: SearchViewControllerUX.SearchImage)?.withRenderingMode(.alwaysTemplate) ?? UIImage()",
        "                )"
      ],
      "ecosia_code": [],
      "context_before": [
        "                oneLineCell.leftImageView.layer.borderWidth = 0",
        ""
      ],
      "context_after": [
        "                oneLineCell.leftImageView.manuallySetImage(UIImage.templateImageNamed(SearchViewControllerUX.SearchImage) ?? UIImage())",
        "                /* Ecosia: Update tintColor"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Search/SearchViewController.swift",
      "line": 773,
      "type": "removal",
      "comment": "Update image",
      "firefox_code": [
        "                appendButton.setImage(searchAppendImage?.withRenderingMode(.alwaysTemplate), for: .normal)"
      ],
      "ecosia_code": [],
      "context_before": [
        "                let appendButton = UIButton(type: .roundedRect)",
        ""
      ],
      "context_after": [
        "                appendButton.setImage(UIImage.templateImageNamed(\"searchAppend\"), for: .normal)",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Search/SearchViewController.swift",
      "line": 780,
      "type": "removal",
      "comment": "Update tintColor",
      "firefox_code": [
        "                appendButton.tintColor = currentTheme().colors.iconPrimary"
      ],
      "ecosia_code": [],
      "context_before": [
        "                appendButton.addTarget(self, action: #selector(append(_ :)), for: .touchUpInside)",
        ""
      ],
      "context_after": [
        "                appendButton.tintColor = currentTheme().colors.textPrimary",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Search/SearchViewController.swift",
      "line": 788,
      "type": "addition",
      "comment": "Enrich background",
      "firefox_code": [],
      "ecosia_code": [
        "                oneLineCell.backgroundColor = currentTheme().colors.ecosia.backgroundElevation1",
        "                cell = oneLineCell"
      ],
      "context_before": [
        "                oneLineCell.accessoryView = indexPath.row > 0 ? appendButton : nil",
        ""
      ],
      "context_after": [
        "            }",
        "        case .openedTabs:"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Search/SearchViewController.swift",
      "line": 804,
      "type": "addition",
      "comment": "Enrich background",
      "firefox_code": [],
      "ecosia_code": [
        "                twoLineCell.backgroundColor = currentTheme().colors.ecosia.backgroundElevation1",
        "                twoLineCell.accessoryView = nil",
        "                cell = twoLineCell"
      ],
      "context_before": [
        "                    twoLineCell.leftImageView.setFavicon(FaviconImageViewModel(siteURLString: urlString))",
        "                }"
      ],
      "context_after": [
        "            }",
        "        case .remoteTabs:"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Search/SearchViewController.swift",
      "line": 822,
      "type": "addition",
      "comment": "Enrich background",
      "firefox_code": [],
      "ecosia_code": [
        "                twoLineCell.backgroundColor = currentTheme().colors.ecosia.backgroundElevation1",
        "                twoLineCell.accessoryView = nil",
        "                cell = twoLineCell"
      ],
      "context_before": [
        "                let urlString = remoteTab.URL.absoluteString",
        "                twoLineCell.leftImageView.setFavicon(FaviconImageViewModel(siteURLString: urlString))"
      ],
      "context_after": [
        "            }",
        "        case .history:"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Search/SearchViewController.swift",
      "line": 877,
      "type": "removal",
      "comment": "No sense to call applyTheme at this point which overrides all the values set above. Will move up",
      "firefox_code": [
        "        // We need to set the correct theme on the cells when the initial display happens",
        "        oneLineCell.applyTheme(theme: currentTheme())",
        "        twoLineCell.applyTheme(theme: currentTheme())"
      ],
      "ecosia_code": [],
      "context_before": [
        "            cell = twoLineCell",
        "        }"
      ],
      "context_after": [
        "        return cell",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Search/SearchViewController.swift",
      "line": 903,
      "type": "removal",
      "comment": "Modified to handle AI Search item and use safe array access",
      "firefox_code": [
        "        if let indexPath = tableView.indexPathForRow(at: buttonPosition), let newQuery = viewModel.suggestions?[indexPath.row] {"
      ],
      "ecosia_code": [],
      "context_before": [
        "    func append(_ sender: UIButton) {",
        "        let buttonPosition = sender.convert(CGPoint(), to: tableView)"
      ],
      "context_after": [
        "        if let indexPath = tableView.indexPathForRow(",
        "            at: buttonPosition"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Search/SearchViewController.swift",
      "line": 908,
      "type": "addition",
      "comment": "Add AI Search check",
      "firefox_code": [],
      "ecosia_code": [
        "           let newQuery = safeSuggestion(at: indexPath.row) {",
        "            searchDelegate?.searchViewController(self, didAppend: newQuery + \" \")",
        "            viewModel.searchQuery = newQuery + \" \"",
        "            searchTelemetry?.searchQuery = viewModel.searchQuery"
      ],
      "context_before": [
        "        if let indexPath = tableView.indexPathForRow(",
        "            at: buttonPosition"
      ],
      "context_after": [
        "        }",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Search/SearchViewModel.swift",
      "line": 167,
      "type": "removal",
      "comment": "Do not show header",
      "firefox_code": [
        "            return hasFirefoxSuggestions"
      ],
      "ecosia_code": [],
      "context_before": [
        "        switch section {",
        "        case SearchListSection.firefoxSuggestions.rawValue:"
      ],
      "context_after": [
        "            return false",
        "        case SearchListSection.searchSuggestions.rawValue:"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Search/SearchViewModel.swift",
      "line": 290,
      "type": "removal",
      "comment": "hardcode config",
      "firefox_code": [
        "        // Searching within the content will get annoying, so only start searching",
        "        // in content when there are at least one word with more than 3 letters in.",
        "        let searchInContent = config.usePageContent",
        "        && searchTerms.contains(where: { $0.count >= config.minSearchTerm })"
      ],
      "ecosia_code": [],
      "context_before": [
        "        }",
        "        let config = searchFeature.value().awesomeBar"
      ],
      "context_after": [
        "        let searchInContent = searchTerms.contains(where: { $0.count >= 3 })",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/SearchEngines/DefaultSearchEngineProvider.swift",
      "line": 105,
      "type": "addition",
      "comment": "Add lowercased to ensure equality",
      "firefox_code": [],
      "ecosia_code": [
        "                    e.shortName.lowercased() == defaultEngineName.lowercased()"
      ],
      "context_before": [
        "                    parser.parse($0.path, engineID: $0.name)",
        "                }).sorted { e, _ in"
      ],
      "context_after": [
        "                }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/SearchLoader.swift",
      "line": 8,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "import Glean"
      ],
      "ecosia_code": [],
      "context_before": [
        "import Shared",
        "import Storage"
      ],
      "context_after": [
        "import Common",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/SearchLoader.swift",
      "line": 87,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "            let timerid = GleanMetrics.Awesomebar.queryTime.start()"
      ],
      "ecosia_code": [],
      "context_before": [
        "    var query: String = \"\" {",
        "        didSet {"
      ],
      "context_after": [
        "            guard profile is BrowserProfile else {",
        "                assertionFailure(\"nil profile\")"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/SearchLoader.swift",
      "line": 92,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "                GleanMetrics.Awesomebar.queryTime.cancel(timerid)"
      ],
      "ecosia_code": [],
      "context_before": [
        "            guard profile is BrowserProfile else {",
        "                assertionFailure(\"nil profile\")"
      ],
      "context_after": [
        "                return",
        "            }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/SearchLoader.swift",
      "line": 100,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "                GleanMetrics.Awesomebar.queryTime.cancel(timerid)"
      ],
      "ecosia_code": [],
      "context_before": [
        "            if query.isEmpty {",
        "                load(Cursor(status: .success, msg: \"Empty query\"))"
      ],
      "context_after": [
        "                return",
        "            }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/SearchLoader.swift",
      "line": 127,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "                                                             timerid: timerid,"
      ],
      "ecosia_code": [],
      "context_before": [
        "                DispatchQueue.main.async {",
        "                    self.updateUIWithBookmarksAsSitesResults(queries: queries,"
      ],
      "context_after": [
        "                                                             historyHighlightsEnabled: historyHighlightsEnabled,",
        "                                                             oldValue: oldValue)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/SearchLoader.swift",
      "line": 138,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "                                                     timerid: TimerId,"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    private func updateUIWithBookmarksAsSitesResults(queries: [[Site]],"
      ],
      "context_after": [
        "                                                     historyHighlightsEnabled: Bool,",
        "                                                     oldValue: String) {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/SearchLoader.swift",
      "line": 145,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "            GleanMetrics.Awesomebar.queryTime.stopAndAccumulate(timerid)"
      ],
      "ecosia_code": [],
      "context_before": [
        "        let results = queries",
        "        defer {"
      ],
      "context_after": [
        "        }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/SimpleToast.swift",
      "line": 61,
      "type": "substitution",
      "comment": "Modify privacy for func",
      "firefox_code": [
        "private func animate(_ toast: UIView) {"
      ],
      "ecosia_code": [
        "    func animate(_ toast: UIView) {",
        "        UIView.animate(",
        "            withDuration: Toast.UX.toastAnimationDuration,",
        "            animations: {",
        "                var frame = toast.frame",
        "                frame.origin.y = frame.origin.y - Toast.UX.toastHeight",
        "                frame.size.height = Toast.UX.toastHeight",
        "                toast.frame = frame",
        "            },",
        "            completion: { finished in",
        "                let thousandMilliseconds = DispatchTimeInterval.milliseconds(1000)",
        "                let zeroMilliseconds = DispatchTimeInterval.milliseconds(0)",
        "                let voiceOverDelay = UIAccessibility.isVoiceOverRunning ? thousandMilliseconds : zeroMilliseconds",
        "                let dispatchTime = DispatchTime.now() + Toast.UX.toastDismissAfter + voiceOverDelay"
      ],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "",
        "                DispatchQueue.main.asyncAfter(deadline: dispatchTime, execute: {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/StartAtHomeHelper.swift",
      "line": 35,
      "type": "removal",
      "comment": "Set to disabled",
      "firefox_code": [
        "            if let prefs = prefs.stringForKey(PrefsKeys.UserFeatureFlagPrefs.StartAtHome) {",
        "                return StartAtHomeSetting(rawValue: prefs) ?? .afterFourHours",
        "            }",
        "            return .afterFourHours"
      ],
      "ecosia_code": [],
      "context_before": [
        "    var startAtHomeSetting: StartAtHomeSetting {",
        "        get {"
      ],
      "context_after": [
        "            if let prefs = prefs.stringForKey(PrefsKeys.UserFeatureFlagPrefs.StartAtHome) {",
        "                return StartAtHomeSetting(rawValue: prefs) ?? .disabled"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/TabDisplayManager.swift",
      "line": 966,
      "type": "removal",
      "comment": "Skip invisible tabs from being added to UI",
      "firefox_code": [
        "        guard tab.isPrivate == self.isPrivate else { return }"
      ],
      "ecosia_code": [],
      "context_before": [
        "        }",
        ""
      ],
      "context_after": [
        "        guard tab.isPrivate == self.isPrivate, !tab.isInvisible else { return }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/TabTrayButtonExtensions.swift",
      "line": 29,
      "type": "removal",
      "comment": "Update tint",
      "firefox_code": [
        "        tintColor = isPrivate ? theme.colors.iconOnColor : theme.colors.iconPrimary"
      ],
      "ecosia_code": [],
      "context_before": [
        "        isSelected = isPrivate",
        ""
      ],
      "context_after": [
        "        tintColor = isPrivate ? theme.colors.ecosia.backgroundPrimary : theme.colors.ecosia.textPrimary",
        "        imageView?.tintColor = tintColor"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Tabs/Legacy/LegacyGridTabViewController.swift",
      "line": 60,
      "type": "substitution",
      "comment": "hide Toolbar",
      "firefox_code": [
        "return !shouldUseiPadSetup() ? view.safeAreaInsets.bottom : 0"
      ],
      "ecosia_code": [
        "        return 0"
      ],
      "context_before": [
        "",
        "    var toolbarHeight: CGFloat {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Tabs/Legacy/LegacyGridTabViewController.swift",
      "line": 707,
      "type": "substitution",
      "comment": "Change close all button title color",
      "firefox_code": [
        "style: .default,"
      ],
      "ecosia_code": [
        "                                           style: .destructive,",
        "                                           handler: { _ in self.closeTabsTrayBackground() }),",
        "                             accessibilityIdentifier: AccessibilityIdentifiers.TabTray.deleteCloseAllButton)",
        "        controller.addAction(UIAlertAction(title: .TabTrayCloseAllTabsPromptCancel,",
        "                                           style: .cancel,",
        "                                           handler: nil),",
        "                             accessibilityIdentifier: AccessibilityIdentifiers.TabTray.deleteCancelButton)",
        "        controller.popoverPresentationController?.barButtonItem = sender",
        "        present(controller, animated: true, completion: nil)"
      ],
      "context_before": [
        "        let controller = AlertController(title: nil, message: nil, preferredStyle: .actionSheet)",
        "        controller.addAction(UIAlertAction(title: .LegacyAppMenu.AppMenuCloseAllTabsTitleString,"
      ],
      "context_after": [
        "    }",
        "}"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Tabs/Legacy/LegacyInactiveTabs/LegacyInactiveTabButton.swift",
      "line": 98,
      "type": "substitution",
      "comment": "Update button's color",
      "firefox_code": [
        "roundedButton.setTitleColor(theme.colors.textPrimary, for: .normal)"
      ],
      "ecosia_code": [
        "        roundedButton.setTitleColor(theme.colors.iconCritical, for: .normal)",
        "        roundedButton.backgroundColor = theme.colors.layer3",
        "        roundedButton.tintColor = theme.colors.textPrimary",
        "        let image = UIImage.templateImageNamed(StandardImageIdentifiers.Large.delete)",
        "        roundedButton.configuration?.image = image",
        "        let iconDisabledColor = theme.colors.iconDisabled",
        "        let iconPrimaryColor = theme.colors.iconPrimary",
        "        roundedButton.configuration?.imageColorTransformer = UIConfigurationColorTransformer({ [weak roundedButton] _ in",
        "            return roundedButton?.state == .highlighted ? iconDisabledColor : iconPrimaryColor",
        "        })"
      ],
      "context_before": [
        "        backgroundColor = .clear",
        "        selectedView.backgroundColor = theme.colors.layer5Hover"
      ],
      "context_after": [
        "    }",
        "}"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Tabs/Legacy/LegacyInactiveTabs/LegacyInactiveTabCell.swift",
      "line": 229,
      "type": "addition",
      "comment": "add missing ThemeApplicable implementation",
      "firefox_code": [],
      "ecosia_code": [
        "            if let theme = inactiveTabsViewModel?.theme {",
        "                headerView.applyTheme(theme: theme)"
      ],
      "context_before": [
        "                withIdentifier: LegacyInactiveTabHeader.cellIdentifier",
        "            ) as? LegacyInactiveTabHeader else { return nil }"
      ],
      "context_after": [
        "            }",
        "            headerView.state = hasExpanded ? .down : .trailing"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Tabs/Legacy/LegacyInactiveTabs/LegacyInactiveTabHeader.swift",
      "line": 9,
      "type": "addition",
      "comment": "Add missing ThemeApplicable protocol declaration",
      "firefox_code": [],
      "ecosia_code": [
        "class LegacyInactiveTabHeader: UITableViewHeaderFooterView, ReusableCell, ThemeApplicable {",
        "    var state: ExpandButtonState? {",
        "        willSet(state) {",
        "            moreButton.setImage(state?.image, for: .normal)"
      ],
      "context_before": [
        "import Shared",
        ""
      ],
      "context_after": [
        "        }",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Tabs/Legacy/LegacyInactiveTabs/LegacyInactiveTabViewModel.swift",
      "line": 97,
      "type": "addition",
      "comment": "Skip invisible tabs from inactive tab management",
      "firefox_code": [],
      "ecosia_code": [
        "            guard !tab.isInvisible else { continue }"
      ],
      "context_before": [
        "        clearAll()",
        "        for tab in self.allTabs {"
      ],
      "context_after": [
        "",
        "            let status = inactiveTabModel.tabWithStatus[tab.tabUUID]"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Tabs/Legacy/LegacyTabCell.swift",
      "line": 276,
      "type": "substitution",
      "comment": "Update border color",
      "firefox_code": [
        "layer.borderColor = (isPrivate ? theme.colors.borderAccentPrivate : theme.colors.borderAccent).cgColor"
      ],
      "ecosia_code": [
        "        layer.borderColor = theme.colors.ecosia.buttonBackgroundPrimary.cgColor",
        "        layer.borderWidth = LegacyTabCell.borderWidth",
        "        layer.cornerRadius = LegacyGridTabViewController.UX.cornerRadius + LegacyTabCell.borderWidth"
      ],
      "context_before": [
        "                                     bottom: LegacyTabCell.borderWidth,",
        "                                     right: LegacyTabCell.borderWidth)"
      ],
      "context_after": [
        "    }",
        "}"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Tabs/Legacy/LegacyTabTrayViewController.swift",
      "line": 155,
      "type": "substitution",
      "comment": "Update button items",
      "firefox_code": [
        "let items = TabTrayPanelType.allCases.map { $0.label }"
      ],
      "ecosia_code": [
        "        let items: [String] = [TabTrayPanelType.tabs,",
        "                               TabTrayPanelType.privateTabs].map { $0.label }",
        "        return createSegmentedControl(items: items,",
        "                                      action: #selector(segmentIpadChanged),",
        "                                      a11yId: AccessibilityIdentifiers.TabTray.navBarSegmentedControl)",
        "    }()"
      ],
      "context_before": [
        "",
        "    private lazy var segmentedControlIpad: UISegmentedControl = {"
      ],
      "context_after": [
        "",
        "    private lazy var segmentedControlIphone: UISegmentedControl = {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Tabs/Legacy/LegacyTabTrayViewController.swift",
      "line": 165,
      "type": "removal",
      "comment": "Update button items",
      "firefox_code": [
        "         let items = [",
        "             TabTrayPanelType.tabs.image!.overlayWith(image: countLabel),",
        "             TabTrayPanelType.privateTabs.image!,",
        "             TabTrayPanelType.syncedTabs.image!]"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    private lazy var segmentedControlIphone: UISegmentedControl = {"
      ],
      "context_after": [
        "        let items = [",
        "            TabTrayPanelType.tabs.image!.overlayWith(image: countLabel),"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Tabs/Views/EmptyPrivateTabsView.swift",
      "line": 37,
      "type": "addition",
      "comment": "Add StackView to center items without corrupting the containerView as affect the ScrollView and its parent view",
      "firefox_code": [],
      "ecosia_code": [
        "    private lazy var containerStackView: UIStackView = .build { stackView in",
        "        stackView.spacing = UX.paddingInBetweenItems",
        "        stackView.axis = .vertical",
        "        stackView.alignment = .center",
        "        stackView.distribution = .fill"
      ],
      "context_before": [
        "    private lazy var containerView: UIView = .build { _ in }",
        ""
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Tabs/Views/EmptyPrivateTabsView.swift",
      "line": 95,
      "type": "removal",
      "comment": "Remove Learn More button",
      "firefox_code": [
        "        configureLearnMoreButton()",
        "        learnMoreButton.addTarget(self,",
        "                                  action: #selector(didTapLearnMore),",
        "                                  for: .touchUpInside)",
        "        containerView.addSubviews(iconImageView, titleLabel, descriptionLabel, learnMoreButton)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    private func setupLayout() {"
      ],
      "context_after": [
        "        // Ecosia: Move subviews to stackview",
        "        // containerView.addSubviews(iconImageView, titleLabel, descriptionLabel)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Tabs/Views/EmptyPrivateTabsView.swift",
      "line": 128,
      "type": "addition",
      "comment": "Update costraints",
      "firefox_code": [],
      "ecosia_code": [
        "            containerStackView.centerXAnchor.constraint(equalTo: scrollView.centerXAnchor),",
        "            containerStackView.centerYAnchor.constraint(equalTo: scrollView.centerYAnchor,",
        "                                                        constant: -UX.horizontalPadding*2),",
        "            containerStackView.leadingAnchor.constraint(equalTo: containerView.leadingAnchor),",
        "            containerStackView.trailingAnchor.constraint(equalTo: containerView.trailingAnchor),",
        "            iconImageView.heightAnchor.constraint(equalToConstant: UX.imageSize.height),",
        "            iconImageView.widthAnchor.constraint(equalToConstant: UX.imageSize.width),"
      ],
      "context_before": [
        "            scrollView.contentLayoutGuide.trailingAnchor.constraint(equalTo: containerView.trailingAnchor),",
        ""
      ],
      "context_after": [
        "",
        "            /* Ecosia: Remove unneded costraints"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Tabs/Views/EmptyPrivateTabsView.swift",
      "line": 137,
      "type": "removal",
      "comment": "Remove unneded costraints",
      "firefox_code": [
        "            iconImageView.topAnchor.constraint(equalTo: containerView.topAnchor,",
        "                                               constant: UX.paddingInBetweenItems),",
        "            iconImageView.centerXAnchor.constraint(equalTo: containerView.centerXAnchor),",
        "            iconImageView.widthAnchor.constraint(equalToConstant: UX.imageSize.width),",
        "            iconImageView.heightAnchor.constraint(equalToConstant: UX.imageSize.height),",
        "            titleLabel.topAnchor.constraint(equalTo: iconImageView.bottomAnchor,",
        "                                            constant: UX.paddingInBetweenItems),",
        "            titleLabel.leadingAnchor.constraint(equalTo: containerView.leadingAnchor),",
        "            titleLabel.trailingAnchor.constraint(equalTo: containerView.trailingAnchor),",
        "            descriptionLabel.topAnchor.constraint(equalTo: titleLabel.bottomAnchor,",
        "                                                  constant: UX.paddingInBetweenItems),",
        "            descriptionLabel.leadingAnchor.constraint(equalTo: containerView.leadingAnchor),",
        "            descriptionLabel.trailingAnchor.constraint(equalTo: containerView.trailingAnchor),",
        "            learnMoreButton.topAnchor.constraint(equalTo: descriptionLabel.bottomAnchor,",
        "                                                 constant: UX.paddingInBetweenItems),",
        "            learnMoreButton.leadingAnchor.constraint(equalTo: containerView.leadingAnchor),",
        "            learnMoreButton.trailingAnchor.constraint(equalTo: containerView.trailingAnchor),",
        "            learnMoreButton.bottomAnchor.constraint(equalTo: containerView.bottomAnchor,",
        "                                                    constant: -UX.paddingInBetweenItems),"
      ],
      "ecosia_code": [],
      "context_before": [
        "            iconImageView.widthAnchor.constraint(equalToConstant: UX.imageSize.width),",
        ""
      ],
      "context_after": [
        "        ])",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Tabs/Views/EmptyPrivateTabsView.swift",
      "line": 167,
      "type": "substitution",
      "comment": "Remove Learn More button",
      "firefox_code": [
        "learnMoreButton.applyTheme(theme: theme)"
      ],
      "ecosia_code": [
        "        iconImageView.tintColor = theme.colors.iconDisabled",
        "        iconImageView.image = .init(named: \"tigerIncognito\")"
      ],
      "context_before": [
        "        titleLabel.textColor = theme.colors.textPrimary",
        "        descriptionLabel.textColor = theme.colors.textPrimary"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Tabs/Views/TabCell.swift",
      "line": 155,
      "type": "removal",
      "comment": "Add custom theme references",
      "firefox_code": [
        "        backgroundHolder.backgroundColor = theme.colors.layer1",
        "        closeButton.tintColor = theme.colors.indicatorActive",
        "        titleText.textColor = theme.colors.textPrimary",
        "        screenshotView.backgroundColor = theme.colors.layer1",
        "        favicon.tintColor = theme.colors.textPrimary",
        "        smallFaviconView.tintColor = theme.colors.textPrimary"
      ],
      "ecosia_code": [],
      "context_before": [
        "    func applyTheme(theme: Theme) {",
        "        headerView.effect = UIBlurEffect(style: theme.type.tabTitleBlurStyle())"
      ],
      "context_after": [
        "        backgroundHolder.backgroundColor = theme.colors.ecosia.backgroundPrimary",
        "        closeButton.tintColor = theme.colors.ecosia.textPrimary"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Tabs/Views/TabTrayViewController.swift",
      "line": 110,
      "type": "removal",
      "comment": "Update button items",
      "firefox_code": [
        "        let iPhoneItems = [",
        "            TabTrayPanelType.tabs.image!.overlayWith(image: countLabel),",
        "            TabTrayPanelType.privateTabs.image!,",
        "            TabTrayPanelType.syncedTabs.image!]",
        "        let iPhoneItems = [",
        "            TabTrayPanelType.tabs.image!.overlayWith(image: countLabel),",
        "            TabTrayPanelType.privateTabs.image!]",
        "        return isRegularLayout ? TabTrayPanelType.allCases.map { $0.label } : iPhoneItems"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    var segmentControlItems: [Any] {"
      ],
      "context_after": [
        "        let iPhoneItems = [",
        "            TabTrayPanelType.tabs.image!.overlayWith(image: countLabel),"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Tabs/Views/TabTrayViewController.swift",
      "line": 349,
      "type": "addition",
      "comment": "Add segmented control colors",
      "firefox_code": [],
      "ecosia_code": [
        "        segmentedControl.backgroundColor = theme.colors.ecosia.segmentedControlBackgroundRest",
        "        segmentedControl.selectedSegmentTintColor = theme.colors.ecosia.segmentedControlBackgroundActive",
        "        segmentedControl.tintColor = theme.colors.ecosia.buttonContentSecondary"
      ],
      "context_before": [
        "        syncTabButton.tintColor = theme.colors.iconPrimary",
        ""
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Tabs/Views/TabTrayViewController.swift",
      "line": 488,
      "type": "removal",
      "comment": "Remove bottom padding",
      "firefox_code": [
        "                                    theme: currentTheme(),",
        "                                    bottomConstraintPadding: -toolbarHeight)"
      ],
      "ecosia_code": [],
      "context_before": [
        "            toast.showAlertWithText(toastType.title,",
        "                                    bottomContainer: view,"
      ],
      "context_after": [
        "                                    theme: currentTheme())",
        "        }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Toast.swift",
      "line": 97,
      "type": "substitution",
      "comment": "Update background",
      "firefox_code": [
        "toastView.backgroundColor = theme.colors.actionPrimary"
      ],
      "ecosia_code": [
        "        toastView.backgroundColor = .clear"
      ],
      "context_before": [
        "",
        "    func applyTheme(theme: Theme) {"
      ],
      "context_after": [
        "    }",
        "}"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Toolbars/ToolbarTelemetry.swift",
      "line": 6,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "import Glean"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "import Foundation"
      ],
      "context_after": [
        "",
        "struct ToolbarTelemetry {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Toolbars/ToolbarTelemetry.swift",
      "line": 13,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        let isPrivateExtra = GleanMetrics.Toolbar.QrScanButtonTappedExtra(isPrivate: isPrivate)",
        "        GleanMetrics.Toolbar.qrScanButtonTapped.record(isPrivateExtra)"
      ],
      "ecosia_code": [],
      "context_before": [
        "    // Tap",
        "    func qrCodeButtonTapped(isPrivate: Bool) {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Toolbars/ToolbarTelemetry.swift",
      "line": 20,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        let isPrivateExtra = GleanMetrics.Toolbar.ClearSearchButtonTappedExtra(isPrivate: isPrivate)",
        "        GleanMetrics.Toolbar.clearSearchButtonTapped.record(isPrivateExtra)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func clearSearchButtonTapped(isPrivate: Bool) {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Toolbars/ToolbarTelemetry.swift",
      "line": 27,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        let isPrivateExtra = GleanMetrics.Toolbar.ShareButtonTappedExtra(isPrivate: isPrivate)",
        "        GleanMetrics.Toolbar.shareButtonTapped.record(isPrivateExtra)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func shareButtonTapped(isPrivate: Bool) {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Toolbars/ToolbarTelemetry.swift",
      "line": 34,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        let isPrivateExtra = GleanMetrics.Toolbar.RefreshButtonTappedExtra(isPrivate: isPrivate)",
        "        GleanMetrics.Toolbar.refreshButtonTapped.record(isPrivateExtra)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func refreshButtonTapped(isPrivate: Bool) {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Toolbars/ToolbarTelemetry.swift",
      "line": 41,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        let readerModeExtra = GleanMetrics.Toolbar.ReaderModeButtonTappedExtra(enabled: isPrivate,",
        "                                                                               isPrivate: isEnabled)",
        "        GleanMetrics.Toolbar.readerModeButtonTapped.record(readerModeExtra)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func readerModeButtonTapped(isPrivate: Bool, isEnabled: Bool) {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Toolbars/ToolbarTelemetry.swift",
      "line": 49,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        let isPrivateExtra = GleanMetrics.Toolbar.SiteInfoButtonTappedExtra(isPrivate: isPrivate)",
        "        GleanMetrics.Toolbar.siteInfoButtonTapped.record(isPrivateExtra)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func siteInfoButtonTapped(isPrivate: Bool) {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Toolbars/ToolbarTelemetry.swift",
      "line": 56,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        let isPrivateExtra = GleanMetrics.Toolbar.BackButtonTappedExtra(isPrivate: isPrivate)",
        "        GleanMetrics.Toolbar.backButtonTapped.record(isPrivateExtra)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func backButtonTapped(isPrivate: Bool) {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Toolbars/ToolbarTelemetry.swift",
      "line": 63,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        let isPrivateExtra = GleanMetrics.Toolbar.ForwardButtonTappedExtra(isPrivate: isPrivate)",
        "        GleanMetrics.Toolbar.forwardButtonTapped.record(isPrivateExtra)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func forwardButtonTapped(isPrivate: Bool) {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Toolbars/ToolbarTelemetry.swift",
      "line": 70,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        let isPrivateExtra = GleanMetrics.Toolbar.HomeButtonTappedExtra(isPrivate: isPrivate)",
        "        GleanMetrics.Toolbar.homeButtonTapped.record(isPrivateExtra)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func homeButtonTapped(isPrivate: Bool) {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Toolbars/ToolbarTelemetry.swift",
      "line": 77,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        let isPrivateExtra = GleanMetrics.Toolbar.OneTapNewTabButtonTappedExtra(isPrivate: isPrivate)",
        "        GleanMetrics.Toolbar.oneTapNewTabButtonTapped.record(isPrivateExtra)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func oneTapNewTabButtonTapped(isPrivate: Bool) {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Toolbars/ToolbarTelemetry.swift",
      "line": 84,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        let isPrivateExtra = GleanMetrics.Toolbar.SearchButtonTappedExtra(isPrivate: isPrivate)",
        "        GleanMetrics.Toolbar.searchButtonTapped.record(isPrivateExtra)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func searchButtonTapped(isPrivate: Bool) {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Toolbars/ToolbarTelemetry.swift",
      "line": 91,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        let isPrivateExtra = GleanMetrics.Toolbar.TabTrayButtonTappedExtra(isPrivate: isPrivate)",
        "        GleanMetrics.Toolbar.tabTrayButtonTapped.record(isPrivateExtra)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func tabTrayButtonTapped(isPrivate: Bool) {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Toolbars/ToolbarTelemetry.swift",
      "line": 98,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        let isPrivateExtra = GleanMetrics.Toolbar.AppMenuButtonTappedExtra(isPrivate: isPrivate)",
        "        GleanMetrics.Toolbar.appMenuButtonTapped.record(isPrivateExtra)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func menuButtonTapped(isPrivate: Bool) {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Toolbars/ToolbarTelemetry.swift",
      "line": 105,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        let isPrivateExtra = GleanMetrics.Toolbar.DataClearanceButtonTappedExtra(isPrivate: isPrivate)",
        "        GleanMetrics.Toolbar.dataClearanceButtonTapped.record(isPrivateExtra)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func dataClearanceButtonTapped(isPrivate: Bool) {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Toolbars/ToolbarTelemetry.swift",
      "line": 113,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        let isPrivateExtra = GleanMetrics.Toolbar.BackLongPressExtra(isPrivate: isPrivate)",
        "        GleanMetrics.Toolbar.backLongPress.record(isPrivateExtra)"
      ],
      "ecosia_code": [],
      "context_before": [
        "    // Long Press",
        "    func backButtonLongPressed(isPrivate: Bool) {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Toolbars/ToolbarTelemetry.swift",
      "line": 120,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        let isPrivateExtra = GleanMetrics.Toolbar.ForwardLongPressExtra(isPrivate: isPrivate)",
        "        GleanMetrics.Toolbar.forwardLongPress.record(isPrivateExtra)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func forwardButtonLongPressed(isPrivate: Bool) {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Toolbars/ToolbarTelemetry.swift",
      "line": 127,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        let isPrivateExtra = GleanMetrics.Toolbar.OneTapNewTabLongPressExtra(isPrivate: isPrivate)",
        "        GleanMetrics.Toolbar.oneTapNewTabLongPress.record(isPrivateExtra)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func oneTapNewTabButtonLongPressed(isPrivate: Bool) {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Toolbars/ToolbarTelemetry.swift",
      "line": 134,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        let isPrivateExtra = GleanMetrics.Toolbar.TabTrayLongPressExtra(isPrivate: isPrivate)",
        "        GleanMetrics.Toolbar.tabTrayLongPress.record(isPrivateExtra)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func tabTrayButtonLongPressed(isPrivate: Bool) {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/Toolbars/ToolbarTelemetry.swift",
      "line": 142,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        GleanMetrics.Awesomebar.dragLocationBar.record()"
      ],
      "ecosia_code": [],
      "context_before": [
        "    // Other",
        "    func dragInteractionStarted() {"
      ],
      "context_after": [
        "    }",
        "}"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/TopTabCell.swift",
      "line": 121,
      "type": "removal",
      "comment": "Update theme",
      "firefox_code": [
        "        favicon.tintColor = colors.textPrimary",
        "        titleText.textColor = colors.textPrimary",
        "        closeButton.tintColor = colors.textPrimary",
        "        let isToolbarRefactorEnabled = featureFlags.isFeatureEnabled(.toolbarRefactor, checking: .buildOnly)",
        "        let backgroundColor = isToolbarRefactorEnabled ? colors.actionTabActive : colors.layer2",
        "        cellBackground.backgroundColor = backgroundColor",
        "        cellBackground.layer.shadowColor = colors.shadowDefault.cgColor",
        "        cellBackground.isHidden = false"
      ],
      "ecosia_code": [],
      "context_before": [
        "    func applySelectedStyle(theme: Theme) {",
        "        let colors = theme.colors"
      ],
      "context_after": [
        "        cellBackground.backgroundColor = colors.ecosia.buttonBackgroundPrimary",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/TopTabsViewController.swift",
      "line": 197,
      "type": "removal",
      "comment": "update background",
      "firefox_code": [
        "        view.backgroundColor = colors.layer3"
      ],
      "ecosia_code": [],
      "context_before": [
        "        let colors = currentTheme.colors",
        ""
      ],
      "context_after": [
        "        view.backgroundColor = currentTheme.colors.ecosia.backgroundPrimary",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/TopTabsViewController.swift",
      "line": 302,
      "type": "substitution",
      "comment": "Update constraint",
      "firefox_code": [
        "privateModeButton.widthAnchor.constraint(equalTo: view.heightAnchor),",
        "privateModeButton.heightAnchor.constraint(equalTo: view.heightAnchor),"
      ],
      "ecosia_code": [
        "            privateModeButton.heightAnchor.constraint(equalTo: view.heightAnchor, constant: -8),"
      ],
      "context_before": [
        "            privateModeButton.centerYAnchor.constraint(equalTo: view.centerYAnchor),",
        "            privateModeButton.leadingAnchor.constraint(equalTo: view.leadingAnchor, constant: 10),"
      ],
      "context_after": [
        "",
        "            topTabFader.topAnchor.constraint(equalTo: view.topAnchor),"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Browser/TopTabsViewController.swift",
      "line": 309,
      "type": "substitution",
      "comment": "Update constraint",
      "firefox_code": [
        "topTabFader.leadingAnchor.constraint(equalTo: privateModeButton.trailingAnchor),"
      ],
      "ecosia_code": [
        "            topTabFader.leadingAnchor.constraint(equalTo: privateModeButton.trailingAnchor, constant: 8),",
        "            topTabFader.trailingAnchor.constraint(equalTo: newTab.leadingAnchor),"
      ],
      "context_before": [
        "            topTabFader.topAnchor.constraint(equalTo: view.topAnchor),",
        "            topTabFader.bottomAnchor.constraint(equalTo: view.bottomAnchor),"
      ],
      "context_after": [
        "",
        "            collectionView.topAnchor.constraint(equalTo: topTabFader.topAnchor),"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Components/ContentContainer.swift",
      "line": 40,
      "type": "addition",
      "comment": "add computed var due to cherry pick https://github.com/mozilla-mobile/firefox-ios/pull/24609",
      "firefox_code": [],
      "ecosia_code": [
        "    var hasAnyHomepage: Bool {",
        "        return hasLegacyHomepage || hasHomepage || hasPrivateHomepage"
      ],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Components/StatusBarOverlay.swift",
      "line": 74,
      "type": "removal",
      "comment": "update background",
      "firefox_code": [
        "        savedBackgroundColor = hasTopTabs ? theme.colors.layer3 : theme.colors.layer1"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func applyTheme(theme: Theme) {"
      ],
      "context_after": [
        "        savedBackgroundColor = theme.colors.ecosia.backgroundPrimary",
        "        backgroundColor = savedBackgroundColor?.withAlphaComponent(scrollOffset)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/ContextualHint/ContextualHintViewController.swift",
      "line": 227,
      "type": "removal",
      "comment": "Accessing the function of the private `viewProvider`",
      "firefox_code": [
        " via helper function. The scope is to deactivate the hint for new users"
      ],
      "ecosia_code": [],
      "context_before": [
        "}",
        ""
      ],
      "context_after": [
        "extension ContextualHintViewController {",
        "    func deactivateHintForNewUsers() {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Extensions/DevicePickerViewController.swift",
      "line": 81,
      "type": "removal",
      "comment": "Swap Theme Manager with Ecosia's",
      "firefox_code": [
        "    private let themeManager = DefaultThemeManager(sharedContainerIdentifier: AppInfo.sharedContainerIdentifier)"
      ],
      "ecosia_code": [],
      "context_before": [
        "    private var notification: Any?",
        "    private var loadingState = LoadingState.loading"
      ],
      "context_after": [
        "    private let themeManager = EcosiaThemeManager(sharedContainerIdentifier: AppInfo.sharedContainerIdentifier)",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/CustomizeHome/CustomizeHomepageSectionViewModel.swift",
      "line": 22,
      "type": "addition",
      "comment": "Update `sectionType`",
      "firefox_code": [],
      "ecosia_code": [
        "        return .ntpCustomization"
      ],
      "context_before": [
        "extension CustomizeHomepageSectionViewModel: HomepageViewModelProtocol {",
        "    var sectionType: HomepageSectionType {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageContextMenuHelper.swift",
      "line": 68,
      "type": "removal",
      "comment": "Remove History Highlights and Pocket",
      "firefox_code": [
        "        } else if sectionType == .pocket,",
        "                  let pocketActions = getPocketActions(site: site, with: sourceView) {",
        "            actions = pocketActions",
        "        } else if sectionType == .bookmarks,",
        "                  let bookmarksActions = getBookmarksActions(site: site, with: sourceView) {",
        "            actions = bookmarksActions",
        "        } else if sectionType == .jumpBackIn,",
        "                  let jumpBackInActions = getJumpBackInActions(site: site, with: sourceView) {",
        "            actions = jumpBackInActions",
        "        }"
      ],
      "ecosia_code": [],
      "context_before": [
        "            actions = topSitesActions",
        "        }"
      ],
      "context_after": [
        "",
        "        return actions"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageContextMenuHelper.swift",
      "line": 97,
      "type": "removal",
      "comment": "Remove History Highlights and Pocket",
      "firefox_code": [
        "        guard sectionType == .historyHighlights,",
        "              let highlightsActions = getHistoryHighlightsActions(for: highlightItem, with: sourceView)",
        "        else { return nil }",
        "        return highlightsActions"
      ],
      "ecosia_code": [],
      "context_before": [
        "                               sectionType: HomepageSectionType",
        "    ) -> [PhotonRowActions]? {"
      ],
      "context_after": [
        "        return nil",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageContextMenuHelper.swift",
      "line": 108,
      "type": "removal",
      "comment": "Receive `Site` in addition to `URL`. Required for tracking.",
      "firefox_code": [
        "     func getOpenInNewPrivateTabAction(siteURL: URL, sectionType: HomepageSectionType) -> PhotonRowActions {"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    // MARK: - Default actions"
      ],
      "context_after": [
        "    func getOpenInNewPrivateTabAction(site: Site, siteURL: URL, sectionType: HomepageSectionType) -> PhotonRowActions {",
        "        return SingleActionViewModel("
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageContextMenuHelper.swift",
      "line": 118,
      "type": "addition",
      "comment": "Track open in new tab top site action",
      "firefox_code": [],
      "ecosia_code": [
        "            self.viewModel.topSiteViewModel.trackTopSiteMenuAction(site: site, action: .openPrivateTab)"
      ],
      "context_before": [
        "        ) { _ in",
        "            self.delegate?.homePanelDidRequestToOpenInNewTab(siteURL, isPrivate: true)"
      ],
      "context_after": [
        "            // Ecosia: Remove Telemetry section type helper",
        "            // sectionType.newPrivateTabActionTelemetry()"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageContextMenuHelper.swift",
      "line": 120,
      "type": "substitution",
      "comment": "Remove Telemetry section type helper",
      "firefox_code": [
        "sectionType.newPrivateTabActionTelemetry()"
      ],
      "ecosia_code": [
        "        }.items"
      ],
      "context_before": [
        "            // Ecosia: Track open in new tab top site action",
        "            self.viewModel.topSiteViewModel.trackTopSiteMenuAction(site: site, action: .openPrivateTab)"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageContextMenuHelper.swift",
      "line": 125,
      "type": "removal",
      "comment": "Remove History Highlights and Pocket",
      "firefox_code": [
        "    // MARK: - History Highlights",
        "    private func getHistoryHighlightsActions(",
        "        for highlightItem: HighlightItem,",
        "        with sourceView: UIView?",
        "    ) -> [PhotonRowActions]? {",
        "        guard let siteURL = highlightItem.siteUrl else { return nil }",
        "        let site = Site(url: siteURL.absoluteString, title: highlightItem.displayTitle)",
        "        let openInNewTabAction = getOpenInNewTabAction(siteURL: siteURL, sectionType: .historyHighlights)",
        "        let openInNewPrivateTabAction = getOpenInNewPrivateTabAction(siteURL: siteURL, sectionType: .historyHighlights)",
        "        let shareAction = getShareAction(site: site, sourceView: sourceView)",
        "        let bookmarkAction = getBookmarkAction(site: site)",
        "        return [openInNewTabAction, openInNewPrivateTabAction, bookmarkAction, shareAction]",
        "    }",
        "    // MARK: Jump Back In",
        "    private func getJumpBackInActions(site: Site, with sourceView: UIView?) -> [PhotonRowActions]? {",
        "        guard let siteURL = site.url.asURL else { return nil }",
        "        let openInNewTabAction = getOpenInNewTabAction(siteURL: siteURL, sectionType: .jumpBackIn)",
        "        let openInNewPrivateTabAction = getOpenInNewPrivateTabAction(siteURL: siteURL, sectionType: .jumpBackIn)",
        "        let shareAction = getShareAction(site: site, sourceView: sourceView)",
        "        let bookmarkAction = getBookmarkAction(site: site)",
        "        return [openInNewTabAction, openInNewPrivateTabAction, bookmarkAction, shareAction]",
        "    }",
        "    // MARK: Bookmarks",
        "    private func getBookmarksActions(site: Site, with sourceView: UIView?) -> [PhotonRowActions]? {",
        "        guard let siteURL = site.url.asURL else { return nil }",
        "        let openInNewTabAction = getOpenInNewTabAction(siteURL: siteURL, sectionType: .bookmarks)",
        "        let openInNewPrivateTabAction = getOpenInNewPrivateTabAction(siteURL: siteURL, sectionType: .bookmarks)",
        "        let shareAction = getShareAction(site: site, sourceView: sourceView)",
        "        let bookmarkAction = getBookmarkAction(site: site)",
        "        return [openInNewTabAction, openInNewPrivateTabAction, bookmarkAction, shareAction]",
        "    }",
        "    // MARK: - Pocket",
        "    private func getPocketActions(site: Site, with sourceView: UIView?) -> [PhotonRowActions]? {",
        "        guard let siteURL = site.url.asURL else { return nil }",
        "        let openInNewTabAction = getOpenInNewTabAction(siteURL: siteURL, sectionType: .pocket)",
        "        let openInNewPrivateTabAction = getOpenInNewPrivateTabAction(siteURL: siteURL, sectionType: .pocket)",
        "        let shareAction = getShareAction(site: site, sourceView: sourceView)",
        "        let bookmarkAction = getBookmarkAction(site: site)",
        "        return [openInNewTabAction, openInNewPrivateTabAction, bookmarkAction, shareAction]",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "",
        "    /* Ecosia: Receive `Site` in addition to `URL`. Required for tracking."
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageContextMenuHelper.swift",
      "line": 182,
      "type": "removal",
      "comment": "Receive `Site` in addition to `URL`. Required for tracking.",
      "firefox_code": [
        "    private func getOpenInNewTabAction(siteURL: URL, sectionType: HomepageSectionType) -> PhotonRowActions {"
      ],
      "ecosia_code": [],
      "context_before": [
        "     */",
        ""
      ],
      "context_after": [
        "    private func getOpenInNewTabAction(site: Site, siteURL: URL, sectionType: HomepageSectionType) -> PhotonRowActions {",
        "        return SingleActionViewModel("
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageContextMenuHelper.swift",
      "line": 192,
      "type": "addition",
      "comment": "Track open in new tab top site action",
      "firefox_code": [],
      "ecosia_code": [
        "            self.viewModel.topSiteViewModel.trackTopSiteMenuAction(site: site, action: .openNewTab)",
        "            /* Ecosia: Remove History Highlights and Pocket",
        "            if sectionType == .pocket {",
        "                let originExtras = TelemetryWrapper.getOriginExtras(isZeroSearch: self.viewModel.isZeroSearch)",
        "                TelemetryWrapper.recordEvent(category: .action,",
        "                                             method: .tap,",
        "                                             object: .pocketStory,",
        "                                             extras: originExtras)"
      ],
      "context_before": [
        "        ) { _ in",
        "            self.delegate?.homePanelDidRequestToOpenInNewTab(siteURL, isPrivate: false)"
      ],
      "context_after": [
        "            }",
        "             */"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageContextMenuHelper.swift",
      "line": 194,
      "type": "removal",
      "comment": "Remove History Highlights and Pocket",
      "firefox_code": [
        "            if sectionType == .pocket {",
        "                let originExtras = TelemetryWrapper.getOriginExtras(isZeroSearch: self.viewModel.isZeroSearch)",
        "                TelemetryWrapper.recordEvent(category: .action,",
        "                                             method: .tap,",
        "                                             object: .pocketStory,",
        "                                             extras: originExtras)",
        "            }"
      ],
      "ecosia_code": [],
      "context_before": [
        "            // Ecosia: Track open in new tab top site action",
        "            self.viewModel.topSiteViewModel.trackTopSiteMenuAction(site: site, action: .openNewTab)"
      ],
      "context_after": [
        "        }.items",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageContextMenuHelper.swift",
      "line": 287,
      "type": "removal",
      "comment": "Include `site` required by tracking",
      "firefox_code": [
        "                              getOpenInNewTabAction(siteURL: siteURL, sectionType: .topSites),",
        "                              getOpenInNewPrivateTabAction(siteURL: siteURL, sectionType: .topSites),"
      ],
      "ecosia_code": [],
      "context_before": [
        "        if let site = site as? PinnedSite {",
        "            topSiteActions = [getRemovePinTopSiteAction(site: site),"
      ],
      "context_after": [
        "                              getOpenInNewTabAction(site: site, siteURL: siteURL, sectionType: .topSites),",
        "                              getOpenInNewPrivateTabAction(site: site, siteURL: siteURL, sectionType: .topSites),"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageContextMenuHelper.swift",
      "line": 296,
      "type": "removal",
      "comment": "Include `site` required by tracking",
      "firefox_code": [
        "            topSiteActions = [getOpenInNewTabAction(siteURL: siteURL, sectionType: .topSites),",
        "                              getOpenInNewPrivateTabAction(siteURL: siteURL, sectionType: .topSites),"
      ],
      "ecosia_code": [],
      "context_before": [
        "                              getShareAction(site: site, sourceView: sourceView)]",
        "        } else if site as? SponsoredTile != nil {"
      ],
      "context_after": [
        "            topSiteActions = [getOpenInNewTabAction(site: site, siteURL: siteURL, sectionType: .topSites),",
        "                              getOpenInNewPrivateTabAction(site: site, siteURL: siteURL, sectionType: .topSites),"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageContextMenuHelper.swift",
      "line": 307,
      "type": "removal",
      "comment": "Include `site` required by tracking",
      "firefox_code": [
        "                              getOpenInNewTabAction(siteURL: siteURL, sectionType: .topSites),",
        "                              getOpenInNewPrivateTabAction(siteURL: siteURL, sectionType: .topSites),"
      ],
      "ecosia_code": [],
      "context_before": [
        "        } else {",
        "            topSiteActions = [getPinTopSiteAction(site: site),"
      ],
      "context_after": [
        "                              getOpenInNewTabAction(site: site, siteURL: siteURL, sectionType: .topSites),",
        "                              getOpenInNewPrivateTabAction(site: site, siteURL: siteURL, sectionType: .topSites),"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageContextMenuHelper.swift",
      "line": 331,
      "type": "addition",
      "comment": "Track remove top site action",
      "firefox_code": [],
      "ecosia_code": [
        "            self.viewModel.topSiteViewModel.trackTopSiteMenuAction(site: site, action: .remove)",
        "        }).items"
      ],
      "context_before": [
        "",
        "            self.sendTopSiteContextualTelemetry(type: .remove)"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageContextMenuHelper.swift",
      "line": 343,
      "type": "addition",
      "comment": "Track pin top site action",
      "firefox_code": [],
      "ecosia_code": [
        "            self.viewModel.topSiteViewModel.trackTopSiteMenuAction(site: site, action: .pin)",
        "        }).items"
      ],
      "context_before": [
        "            self.viewModel.topSiteViewModel.pinTopSite(site)",
        "            self.sendTopSiteContextualTelemetry(type: .pin)"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageContextMenuHelper.swift",
      "line": 356,
      "type": "addition",
      "comment": "Track unpin top site action",
      "firefox_code": [],
      "ecosia_code": [
        "            self.viewModel.topSiteViewModel.trackTopSiteMenuAction(site: site, action: .unpin)",
        "        }).items"
      ],
      "context_before": [
        "            self.viewModel.topSiteViewModel.removePinTopSite(site)",
        "            self.sendTopSiteContextualTelemetry(type: .unpin)"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageViewModel.swift",
      "line": 19,
      "type": "substitution",
      "comment": "Update `spacingBetweenSections`",
      "firefox_code": [
        "static let spacingBetweenSections: CGFloat = 62"
      ],
      "ecosia_code": [
        "        static let spacingBetweenSections: CGFloat = 32",
        "        static let standardInset: CGFloat = 16",
        "        static let iPadInset: CGFloat = 50",
        "        static let iPadTopSiteInset: CGFloat = 25"
      ],
      "context_before": [
        "class HomepageViewModel: FeatureFlaggable, InjectedThemeUUIDIdentifiable {",
        "    struct UX {"
      ],
      "context_after": [
        "",
        "        // Shadow"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageViewModel.swift",
      "line": 73,
      "type": "removal",
      "comment": "Remove bookmarks section",
      "firefox_code": [
        "            bookmarksViewModel.isZeroSearch = isZeroSearch"
      ],
      "ecosia_code": [],
      "context_before": [
        "        didSet {",
        "            topSiteViewModel.isZeroSearch = isZeroSearch"
      ],
      "context_after": [
        "            /* Ecosia: Remove `jumpBackIn` section reference",
        "            jumpBackInViewModel.isZeroSearch = isZeroSearch"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageViewModel.swift",
      "line": 79,
      "type": "removal",
      "comment": "Remove History Highlights and Pocket",
      "firefox_code": [
        "            pocketViewModel.isZeroSearch = isZeroSearch"
      ],
      "ecosia_code": [],
      "context_before": [
        "            jumpBackInViewModel.isZeroSearch = isZeroSearch",
        "             */"
      ],
      "context_after": [
        "        }",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageViewModel.swift",
      "line": 111,
      "type": "substitution",
      "comment": "Remove message Card  from HomePage",
      "firefox_code": [
        "var messageCardViewModel: HomepageMessageCardViewModel"
      ],
      "ecosia_code": [
        "    var topSiteViewModel: TopSitesViewModel",
        "    /* Ecosia Remove bookmarks section",
        "    var bookmarksViewModel: BookmarksViewModel",
        "     */",
        "    /* Ecosia: Remove `jumpBackIn` section reference",
        "    var jumpBackInViewModel: JumpBackInViewModel",
        "     */",
        "    /* Ecosia: Remove History Highlights and Pocket",
        "    var historyHighlightsViewModel: HistoryHighlightsViewModel",
        "    var pocketViewModel: PocketViewModel",
        "     */",
        "    /* Ecosia: Remove `customizeHome` reference",
        "    var customizeButtonViewModel: CustomizeHomepageSectionViewModel",
        "     */"
      ],
      "context_before": [
        "    private var childViewModels: [HomepageViewModelProtocol]",
        "    var headerViewModel: HomepageHeaderViewModel"
      ],
      "context_after": [
        "",
        "    var shouldDisplayHomeTabBanner: Bool {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageViewModel.swift",
      "line": 117,
      "type": "removal",
      "comment": "Remove `jumpBackIn` section reference",
      "firefox_code": [
        "    var jumpBackInViewModel: JumpBackInViewModel"
      ],
      "ecosia_code": [],
      "context_before": [
        "    var bookmarksViewModel: BookmarksViewModel",
        "     */"
      ],
      "context_after": [
        "    /* Ecosia: Remove History Highlights and Pocket",
        "    var historyHighlightsViewModel: HistoryHighlightsViewModel"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageViewModel.swift",
      "line": 124,
      "type": "removal",
      "comment": "Remove `customizeHome` reference",
      "firefox_code": [
        "    var customizeButtonViewModel: CustomizeHomepageSectionViewModel"
      ],
      "ecosia_code": [],
      "context_before": [
        "    var pocketViewModel: PocketViewModel",
        "     */"
      ],
      "context_after": [
        "",
        "    var shouldDisplayHomeTabBanner: Bool {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageViewModel.swift",
      "line": 130,
      "type": "substitution",
      "comment": "Remove message Card  from HomePage",
      "firefox_code": [
        "return messageCardViewModel.shouldDisplayMessageCard"
      ],
      "ecosia_code": [
        "    }"
      ],
      "context_before": [
        "    var shouldDisplayHomeTabBanner: Bool {",
        "        false"
      ],
      "context_after": [
        "",
        "    // Ecosia: Add Ecosia's ViewModels"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageViewModel.swift",
      "line": 134,
      "type": "addition",
      "comment": "Add Ecosia's ViewModels",
      "firefox_code": [],
      "ecosia_code": [
        "    var multiPurposeEcosiaHeaderViewModel: NTPHeaderViewModel",
        "    var libraryViewModel: NTPLibraryCellViewModel",
        "    var impactViewModel: NTPImpactCellViewModel",
        "    var newsViewModel: NTPNewsCellViewModel",
        "    var ntpCustomizationViewModel: NTPCustomizationCellViewModel"
      ],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "",
        "    /*"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageViewModel.swift",
      "line": 152,
      "type": "addition",
      "comment": "Add referrals",
      "firefox_code": [],
      "ecosia_code": [
        "         isZeroSearch: Bool = false,",
        "         theme: Theme,",
        "         wallpaperManager: WallpaperManager = WallpaperManager(),",
        "         logger: Logger = DefaultLogger.shared,"
      ],
      "context_before": [
        "         tabManager: TabManager,",
        "         nimbus: FxNimbus = FxNimbus.shared,"
      ],
      "context_after": [
        "         // Ecosia: Add EcosiaAuth",
        "         auth: EcosiaAuth,"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageViewModel.swift",
      "line": 157,
      "type": "addition",
      "comment": "Add EcosiaAuth",
      "firefox_code": [],
      "ecosia_code": [
        "         auth: EcosiaAuth,"
      ],
      "context_before": [
        "         wallpaperManager: WallpaperManager = WallpaperManager(),",
        "         logger: Logger = DefaultLogger.shared,"
      ],
      "context_after": [
        "         // Ecosia: Add delegate for multi-purpose header actions",
        "         multiPurposeEcosiaHeaderDelegate: NTPHeaderDelegate? = nil) {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageViewModel.swift",
      "line": 159,
      "type": "addition",
      "comment": "Add delegate for multi-purpose header actions",
      "firefox_code": [],
      "ecosia_code": [
        "         multiPurposeEcosiaHeaderDelegate: NTPHeaderDelegate? = nil) {",
        "        self.profile = profile",
        "        self.isZeroSearch = isZeroSearch",
        "        self.theme = theme",
        "        self.logger = logger",
        "        self.windowUUID = tabManager.windowUUID"
      ],
      "context_before": [
        "         // Ecosia: Add EcosiaAuth",
        "         auth: EcosiaAuth,"
      ],
      "context_after": [
        "",
        "        self.headerViewModel = HomepageHeaderViewModel(profile: profile, theme: theme, tabManager: tabManager)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageViewModel.swift",
      "line": 168,
      "type": "removal",
      "comment": "Remove message Card  from HomePage",
      "firefox_code": [
        "        let messageCardAdaptor = MessageCardDataAdaptorImplementation()",
        "        self.messageCardViewModel = HomepageMessageCardViewModel(dataAdaptor: messageCardAdaptor, theme: theme)",
        "        messageCardAdaptor.delegate = messageCardViewModel"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "        self.headerViewModel = HomepageHeaderViewModel(profile: profile, theme: theme, tabManager: tabManager)"
      ],
      "context_after": [
        "        self.topSiteViewModel = TopSitesViewModel(profile: profile,",
        "                                                  theme: theme,"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageViewModel.swift",
      "line": 176,
      "type": "addition",
      "comment": "Add Ecosia's ViewModels",
      "firefox_code": [],
      "ecosia_code": [
        "        self.multiPurposeEcosiaHeaderViewModel = NTPHeaderViewModel(profile: profile,",
        "                                                                    theme: theme,",
        "                                                                    windowUUID: tabManager.windowUUID,",
        "                                                                    auth: auth,",
        "                                                                    delegate: multiPurposeEcosiaHeaderDelegate)",
        "        self.libraryViewModel = NTPLibraryCellViewModel(theme: theme)",
        "        self.impactViewModel = NTPImpactCellViewModel(referrals: referrals, theme: theme)",
        "        self.newsViewModel = NTPNewsCellViewModel(theme: theme)",
        "        self.ntpCustomizationViewModel = NTPCustomizationCellViewModel(theme: theme)",
        "        self.wallpaperManager = wallpaperManager",
        "        /* Ecosia: Remove `jumpBackIn` section reference",
        "        let jumpBackInAdaptor = JumpBackInDataAdaptorImplementation(profile: profile,",
        "                                                                    tabManager: tabManager)",
        "        self.jumpBackInViewModel = JumpBackInViewModel(",
        "            profile: profile,",
        "            isPrivate: isPrivate,",
        "            theme: theme,",
        "            tabManager: tabManager,",
        "            adaptor: jumpBackInAdaptor,",
        "            wallpaperManager: wallpaperManager)",
        "         */",
        "        /* Ecosia: Remove bookmarks section",
        "        self.bookmarksViewModel = BookmarksViewModel(profile: profile,",
        "                                                     theme: theme,",
        "                                                     wallpaperManager: wallpaperManager)",
        "         */",
        "        /* Ecosia: Remove History Highlights and Pocket",
        "        let deletionUtility = HistoryDeletionUtility(with: profile)",
        "        let historyDataAdaptor = HistoryHighlightsDataAdaptorImplementation(",
        "            profile: profile,",
        "            tabManager: tabManager,",
        "            deletionUtility: deletionUtility)",
        "        self.historyHighlightsViewModel = HistoryHighlightsViewModel(",
        "            with: profile,",
        "            isPrivate: isPrivate,",
        "            theme: theme,",
        "            historyHighlightsDataAdaptor: historyDataAdaptor,",
        "            wallpaperManager: wallpaperManager)"
      ],
      "context_before": [
        "                                                  theme: theme,",
        "                                                  wallpaperManager: wallpaperManager)"
      ],
      "context_after": [
        "",
        "        let pocketDataAdaptor = PocketDataAdaptorImplementation(pocketAPI: PocketProvider(prefs: profile.prefs))"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageViewModel.swift",
      "line": 187,
      "type": "removal",
      "comment": "Remove `jumpBackIn` section reference",
      "firefox_code": [
        "        let jumpBackInAdaptor = JumpBackInDataAdaptorImplementation(profile: profile,",
        "                                                                    tabManager: tabManager)",
        "        self.jumpBackInViewModel = JumpBackInViewModel(",
        "            profile: profile,",
        "            isPrivate: isPrivate,",
        "            theme: theme,",
        "            tabManager: tabManager,",
        "            adaptor: jumpBackInAdaptor,",
        "            wallpaperManager: wallpaperManager)"
      ],
      "ecosia_code": [],
      "context_before": [
        "        self.ntpCustomizationViewModel = NTPCustomizationCellViewModel(theme: theme)",
        "        self.wallpaperManager = wallpaperManager"
      ],
      "context_after": [
        "        /* Ecosia: Remove bookmarks section",
        "        self.bookmarksViewModel = BookmarksViewModel(profile: profile,"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageViewModel.swift",
      "line": 203,
      "type": "removal",
      "comment": "Remove History Highlights and Pocket",
      "firefox_code": [
        "        let deletionUtility = HistoryDeletionUtility(with: profile)",
        "        let historyDataAdaptor = HistoryHighlightsDataAdaptorImplementation(",
        "            profile: profile,",
        "            tabManager: tabManager,",
        "            deletionUtility: deletionUtility)",
        "        self.historyHighlightsViewModel = HistoryHighlightsViewModel(",
        "            with: profile,",
        "            isPrivate: isPrivate,",
        "            theme: theme,",
        "            historyHighlightsDataAdaptor: historyDataAdaptor,",
        "            wallpaperManager: wallpaperManager)",
        "        let pocketDataAdaptor = PocketDataAdaptorImplementation(pocketAPI: PocketProvider(prefs: profile.prefs))",
        "        self.pocketViewModel = PocketViewModel(pocketDataAdaptor: pocketDataAdaptor,",
        "                                               theme: theme,",
        "                                               prefs: profile.prefs,",
        "                                               wallpaperManager: wallpaperManager)",
        "        pocketDataAdaptor.delegate = pocketViewModel"
      ],
      "ecosia_code": [],
      "context_before": [
        "                                                     wallpaperManager: wallpaperManager)",
        "         */"
      ],
      "context_after": [
        "        // Ecosia: Remove `customizeHome` reference",
        "        // self.customizeButtonViewModel = CustomizeHomepageSectionViewModel(theme: theme)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageViewModel.swift",
      "line": 238,
      "type": "addition",
      "comment": "Those models needs to follow strictly the order defined in `enum HomepageSectionType`",
      "firefox_code": [],
      "ecosia_code": [
        "        self.childViewModels = [multiPurposeEcosiaHeaderViewModel,",
        "                                headerViewModel,",
        "                                libraryViewModel,",
        "                                topSiteViewModel,",
        "                                impactViewModel,",
        "                                newsViewModel,",
        "                                ntpCustomizationViewModel]",
        "        self.isPrivate = isPrivate"
      ],
      "context_before": [
        "        ]",
        "         */"
      ],
      "context_after": [
        "",
        "        self.nimbus = nimbus"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageViewModel.swift",
      "line": 249,
      "type": "addition",
      "comment": "Add Ecosia's ViewModels delegates",
      "firefox_code": [],
      "ecosia_code": [
        "        newsViewModel.dataModelDelegate = self",
        "        topSiteViewModel.delegate = self",
        "        /* Ecosia Remove bookmarks section",
        "        bookmarksViewModel.delegate = self",
        "         */",
        "        /* Ecosia: Remove History Highlights and Pocket",
        "        historyHighlightsViewModel.delegate = self",
        "         */",
        "        /* Ecosia: Remove History Highlights and Pocket",
        "        pocketViewModel.delegate = self",
        "         */",
        "        /* Ecosia: Remove `jumpBackIn` section reference",
        "        jumpBackInViewModel.delegate = self",
        "         */",
        "        /* Ecosia: Remove message Card  from HomePage",
        "        messageCardViewModel.delegate = self",
        "         */"
      ],
      "context_before": [
        "",
        "        self.nimbus = nimbus"
      ],
      "context_after": [
        "",
        "        /* Ecosia: Remove `jumpBackIn` section reference"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageViewModel.swift",
      "line": 255,
      "type": "removal",
      "comment": "Remove History Highlights and Pocket",
      "firefox_code": [
        "        historyHighlightsViewModel.delegate = self"
      ],
      "ecosia_code": [],
      "context_before": [
        "        bookmarksViewModel.delegate = self",
        "         */"
      ],
      "context_after": [
        "        /* Ecosia: Remove History Highlights and Pocket",
        "        pocketViewModel.delegate = self"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageViewModel.swift",
      "line": 261,
      "type": "removal",
      "comment": "Remove `jumpBackIn` section reference",
      "firefox_code": [
        "        jumpBackInViewModel.delegate = self"
      ],
      "ecosia_code": [],
      "context_before": [
        "        pocketViewModel.delegate = self",
        "         */"
      ],
      "context_after": [
        "        /* Ecosia: Remove message Card  from HomePage",
        "        messageCardViewModel.delegate = self"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageViewModel.swift",
      "line": 268,
      "type": "removal",
      "comment": "Remove `jumpBackIn` section reference",
      "firefox_code": [
        "        Task {",
        "            await jumpBackInAdaptor.setDelegate(delegate: jumpBackInViewModel)",
        "        }"
      ],
      "ecosia_code": [],
      "context_before": [
        "         */",
        ""
      ],
      "context_after": [
        "        updateEnabledSections()",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageViewModel.swift",
      "line": 301,
      "type": "substitution",
      "comment": "Only execute screenWasShown for shown sections",
      "firefox_code": [
        "childViewModels.forEach { $0.screenWasShown() }"
      ],
      "ecosia_code": [
        "        shownSections.forEach { section in",
        "            if let viewModel = childViewModels.first(where: { $0.sectionType == section }) {",
        "                viewModel.screenWasShown()"
      ],
      "context_before": [
        "                                     value: trackingValue,",
        "                                     extras: nil)"
      ],
      "context_after": [
        "            }",
        "        }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageViewModel.swift",
      "line": 319,
      "type": "addition",
      "comment": "Unsubscribe to projections",
      "firefox_code": [],
      "ecosia_code": [
        "        impactViewModel.unsubscribeToProjections()"
      ],
      "context_before": [
        "    func recordViewDisappeared() {",
        "        viewAppeared = false"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageViewModel.swift",
      "line": 328,
      "type": "removal",
      "comment": "Handle priority of cards view models",
      "firefox_code": [
        "         childViewModels.forEach {",
        "             if $0.shouldShow { shownSections.append($0.sectionType) }",
        "         }"
      ],
      "ecosia_code": [],
      "context_before": [
        "        shownSections.removeAll()",
        ""
      ],
      "context_after": [
        "        var prioritySectionAdded = false",
        "        childViewModels.forEach {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/HomepageViewModel.swift",
      "line": 373,
      "type": "addition",
      "comment": "NTPLayoutHighlightDataSource",
      "firefox_code": [],
      "ecosia_code": [
        "extension HomepageViewModel: NTPLayoutHighlightDataSource {",
        "    func getSectionViewModel(shownSection: Int) -> HomepageViewModelProtocol? {",
        "        guard let actualSectionNumber = shownSections[safe: shownSection]?.rawValue else { return nil }",
        "        return childViewModels[safe: actualSectionNumber]"
      ],
      "context_before": [
        "}",
        ""
      ],
      "context_after": [
        "    }",
        "}"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/JumpBackIn/JumpBackInSectionLayout.swift",
      "line": 61,
      "type": "substitution",
      "comment": "Remove `jumpBackIn` section reference",
      "firefox_code": [
        "syncedTabCount: hasAccount ? JumpBackInViewModel.UX.maxDisplayedSyncedTabs : 0"
      ],
      "ecosia_code": [
        "            syncedTabCount: 0",
        "        )"
      ],
      "context_before": [
        "        return JumpBackInDisplayGroupCount(",
        "            tabsCount: maxJumpBackInItemsToDisplay(device: device),"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/LegacyHomepageViewController.swift",
      "line": 38,
      "type": "substitution",
      "comment": "Expose `viewModel` in extensions",
      "firefox_code": [
        "private var viewModel: HomepageViewModel"
      ],
      "ecosia_code": [
        "    var viewModel: HomepageViewModel",
        "    private var contextMenuHelper: HomepageContextMenuHelper",
        "    private var tabManager: TabManager",
        "    private var overlayManager: OverlayModeManager",
        "    private var userDefaults: UserDefaultsInterface",
        "    private lazy var wallpaperView: WallpaperBackgroundView = .build { _ in }",
        "    private var jumpBackInContextualHintViewController: ContextualHintViewController",
        "    private var syncTabContextualHintViewController: ContextualHintViewController"
      ],
      "context_before": [
        "    weak var statusBarScrollDelegate: StatusBarScrollDelegate?",
        ""
      ],
      "context_after": [
        "    // Ecosia: Expose `collectionView` in extensions",
        "    // private var collectionView: UICollectionView! = nil"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/LegacyHomepageViewController.swift",
      "line": 48,
      "type": "substitution",
      "comment": "Expose `collectionView` in extensions",
      "firefox_code": [
        "private var collectionView: UICollectionView! = nil"
      ],
      "ecosia_code": [
        "    var collectionView: UICollectionView! = nil",
        "    private var lastContentOffsetY: CGFloat = 0",
        "    private var logger: Logger",
        "    var windowUUID: WindowUUID { return tabManager.windowUUID }",
        "    var currentWindowUUID: UUID? { return windowUUID }"
      ],
      "context_before": [
        "    private var jumpBackInContextualHintViewController: ContextualHintViewController",
        "    private var syncTabContextualHintViewController: ContextualHintViewController"
      ],
      "context_after": [
        "",
        "    var contentType: ContentType = .legacyHomepage"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/LegacyHomepageViewController.swift",
      "line": 71,
      "type": "addition",
      "comment": "Add referrals",
      "firefox_code": [],
      "ecosia_code": [
        "    weak var referrals: Referrals!"
      ],
      "context_before": [
        "        return tabManager.selectedTab",
        "    }"
      ],
      "context_after": [
        "    // Ecosia: Add HomePageViewControllerDelegate reference",
        "    weak var delegate: HomepageViewControllerDelegate?"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/LegacyHomepageViewController.swift",
      "line": 73,
      "type": "addition",
      "comment": "Add HomePageViewControllerDelegate reference",
      "firefox_code": [],
      "ecosia_code": [
        "    weak var delegate: HomepageViewControllerDelegate?"
      ],
      "context_before": [
        "    // Ecosia: Add referrals",
        "    weak var referrals: Referrals!"
      ],
      "context_after": [
        "",
        "    // MARK: - Initializers"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/LegacyHomepageViewController.swift",
      "line": 86,
      "type": "addition",
      "comment": "Add Referrals",
      "firefox_code": [],
      "ecosia_code": [
        "         referrals: Referrals,"
      ],
      "context_before": [
        "         notificationCenter: NotificationProtocol = NotificationCenter.default,",
        "         logger: Logger = DefaultLogger.shared,"
      ],
      "context_after": [
        "         // Ecosia: Add HomePageViewControllerDelegate",
        "         delegate: HomepageViewControllerDelegate?,"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/LegacyHomepageViewController.swift",
      "line": 88,
      "type": "addition",
      "comment": "Add HomePageViewControllerDelegate",
      "firefox_code": [],
      "ecosia_code": [
        "         delegate: HomepageViewControllerDelegate?,"
      ],
      "context_before": [
        "         // Ecosia: Add Referrals",
        "         referrals: Referrals,"
      ],
      "context_after": [
        "         // Ecosia: Add EcosiaAuth",
        "         auth: EcosiaAuth"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/LegacyHomepageViewController.swift",
      "line": 90,
      "type": "addition",
      "comment": "Add EcosiaAuth",
      "firefox_code": [],
      "ecosia_code": [
        "         auth: EcosiaAuth",
        "    ) {",
        "        self.overlayManager = overlayManager",
        "        self.tabManager = tabManager",
        "        self.userDefaults = userDefaults",
        "        let isPrivate = tabManager.selectedTab?.isPrivate ?? true",
        "        self.viewModel = HomepageViewModel(profile: profile,",
        "                                           isPrivate: isPrivate,",
        "                                           tabManager: tabManager,",
        "                                           referrals: referrals, // Ecosia: Add referrals",
        "                                           theme: themeManager.getCurrentTheme(for: tabManager.windowUUID),",
        "                                           auth: auth) // Ecosia: Add EcosiaAuth"
      ],
      "context_before": [
        "         // Ecosia: Add HomePageViewControllerDelegate",
        "         delegate: HomepageViewControllerDelegate?,"
      ],
      "context_after": [
        "",
        "        let jumpBackInContextualViewProvider = ContextualHintViewProvider(forHintType: .jumpBackIn,"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/LegacyHomepageViewController.swift",
      "line": 100,
      "type": "addition",
      "comment": "Add referrals",
      "firefox_code": [],
      "ecosia_code": [
        "                                           theme: themeManager.getCurrentTheme(for: tabManager.windowUUID),",
        "                                           auth: auth) // Ecosia: Add EcosiaAuth"
      ],
      "context_before": [
        "                                           isPrivate: isPrivate,",
        "                                           tabManager: tabManager,"
      ],
      "context_after": [
        "",
        "        let jumpBackInContextualViewProvider = ContextualHintViewProvider(forHintType: .jumpBackIn,"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/LegacyHomepageViewController.swift",
      "line": 102,
      "type": "addition",
      "comment": "Add EcosiaAuth",
      "firefox_code": [],
      "ecosia_code": [],
      "context_before": [
        "                                           referrals: referrals, // Ecosia: Add referrals",
        "                                           theme: themeManager.getCurrentTheme(for: tabManager.windowUUID),"
      ],
      "context_after": [
        "",
        "        let jumpBackInContextualViewProvider = ContextualHintViewProvider(forHintType: .jumpBackIn,"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/LegacyHomepageViewController.swift",
      "line": 120,
      "type": "addition",
      "comment": "Add referrals",
      "firefox_code": [],
      "ecosia_code": [
        "        self.referrals = referrals"
      ],
      "context_before": [
        "        self.notificationCenter = notificationCenter",
        "        self.logger = logger"
      ],
      "context_after": [
        "        // Ecosia: Add HomePageViewControllerDelegate",
        "        self.delegate = delegate"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/LegacyHomepageViewController.swift",
      "line": 122,
      "type": "addition",
      "comment": "Add HomePageViewControllerDelegate",
      "firefox_code": [],
      "ecosia_code": [
        "        self.delegate = delegate",
        "        super.init(nibName: nil, bundle: nil)"
      ],
      "context_before": [
        "        // Ecosia: Add referrals",
        "        self.referrals = referrals"
      ],
      "context_after": [
        "",
        "        // Ecosia: Set multi-purpose header delegate after super.init"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/LegacyHomepageViewController.swift",
      "line": 126,
      "type": "addition",
      "comment": "Set multi-purpose header delegate after super.init",
      "firefox_code": [],
      "ecosia_code": [
        "        viewModel.multiPurposeEcosiaHeaderViewModel.delegate = self"
      ],
      "context_before": [
        "        super.init(nibName: nil, bundle: nil)",
        ""
      ],
      "context_after": [
        "",
        "        updateHeaderToShowPrivateModeToggle()"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/LegacyHomepageViewController.swift",
      "line": 181,
      "type": "addition",
      "comment": "Refresh referral claims",
      "firefox_code": [],
      "ecosia_code": [
        "        Task {",
        "            try? await referrals.refresh()"
      ],
      "context_before": [
        "        viewModel.recordViewAppeared()",
        ""
      ],
      "context_after": [
        "        }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/LegacyHomepageViewController.swift",
      "line": 278,
      "type": "addition",
      "comment": "NTP Toltip",
      "firefox_code": [],
      "ecosia_code": [
        "        collectionView.register(NTPTooltip.self,",
        "                                forSupplementaryViewOfKind: UICollectionView.elementKindSectionHeader,",
        "                                withReuseIdentifier: NTPTooltip.key)",
        "        collectionView.register(NTPImpactDividerFooter.self,",
        "                                forSupplementaryViewOfKind: UICollectionView.elementKindSectionFooter,",
        "                                withReuseIdentifier: NTPImpactDividerFooter.cellIdentifier)",
        "        /* Ecosia: Remove PocketFooterView",
        "        collectionView.register(PocketFooterView.self,",
        "                                forSupplementaryViewOfKind: UICollectionView.elementKindSectionFooter,",
        "                                withReuseIdentifier: PocketFooterView.cellIdentifier)",
        "         */",
        "        collectionView.keyboardDismissMode = .onDrag",
        "        collectionView.addGestureRecognizer(longPressRecognizer)",
        "        collectionView.delegate = self",
        "        collectionView.dataSource = self",
        "        collectionView.showsVerticalScrollIndicator = false",
        "        collectionView.autoresizingMask = [.flexibleWidth, .flexibleHeight]",
        "        collectionView.backgroundColor = .clear",
        "        collectionView.accessibilityIdentifier = a11y.collectionView",
        "        collectionView.addInteraction(UIContextMenuInteraction(delegate: self))",
        "        contentStackView.addArrangedSubview(collectionView)"
      ],
      "context_before": [
        "                                forSupplementaryViewOfKind: UICollectionView.elementKindSectionHeader,",
        "                                withReuseIdentifier: LegacyLabelButtonHeaderView.cellIdentifier)"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/LegacyHomepageViewController.swift",
      "line": 285,
      "type": "removal",
      "comment": "Remove PocketFooterView",
      "firefox_code": [
        "        collectionView.register(PocketFooterView.self,",
        "                                forSupplementaryViewOfKind: UICollectionView.elementKindSectionFooter,",
        "                                withReuseIdentifier: PocketFooterView.cellIdentifier)"
      ],
      "ecosia_code": [],
      "context_before": [
        "                                forSupplementaryViewOfKind: UICollectionView.elementKindSectionFooter,",
        "                                withReuseIdentifier: NTPImpactDividerFooter.cellIdentifier)"
      ],
      "context_after": [
        "        collectionView.keyboardDismissMode = .onDrag",
        "        collectionView.addGestureRecognizer(longPressRecognizer)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/LegacyHomepageViewController.swift",
      "line": 329,
      "type": "removal",
      "comment": "Update Layout type",
      "firefox_code": [
        "        let layout = UICollectionViewCompositionalLayout { [weak self] (sectionIndex: Int, layoutEnvironment: NSCollectionLayoutEnvironment)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func createLayout() -> UICollectionViewLayout {"
      ],
      "context_after": [
        "        let layout = NTPLayout { [weak self] (sectionIndex: Int, layoutEnvironment: NSCollectionLayoutEnvironment)",
        "            -> NSCollectionLayoutSection? in"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/LegacyHomepageViewController.swift",
      "line": 435,
      "type": "removal",
      "comment": "Update NTP background",
      "firefox_code": [
        "        view.backgroundColor = theme.colors.layer1"
      ],
      "ecosia_code": [],
      "context_before": [
        "        let theme = themeManager.getCurrentTheme(for: windowUUID)",
        "        viewModel.theme = theme"
      ],
      "context_after": [
        "        view.backgroundColor = theme.colors.ecosia.backgroundPrimaryDecorative",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/LegacyHomepageViewController.swift",
      "line": 609,
      "type": "removal",
      "comment": "Adjust HomePageViewController's CollectionView",
      "firefox_code": [
        "        if kind == UICollectionView.elementKindSectionHeader {",
        "            guard let headerView = collectionView.dequeueReusableSupplementaryView(",
        "                ofKind: kind,",
        "                withReuseIdentifier: LegacyLabelButtonHeaderView.cellIdentifier,",
        "                for: indexPath) as? LegacyLabelButtonHeaderView else { return reusableView }",
        "            guard let sectionViewModel = viewModel.getSectionViewModel(shownSection: indexPath.section)",
        "            else { return reusableView }",
        "            // Configure header only if section is shown",
        "            // swiftlint:disable line_length",
        "            let headerViewModel = sectionViewModel.shouldShow ? sectionViewModel.headerViewModel : LabelButtonHeaderViewModel.emptyHeader",
        "            // swiftlint:enable line_length",
        "            headerView.configure(viewModel: headerViewModel,",
        "                                 theme: themeManager.getCurrentTheme(for: windowUUID))",
        "            /* Ecosia: Remove `jumpBackIn` section reference",
        "            // Jump back in header specific setup",
        "            if sectionViewModel.sectionType == .jumpBackIn {",
        "                self.viewModel.jumpBackInViewModel.sendImpressionTelemetry()",
        "                // Moving called after header view gets configured",
        "                // and delaying to wait for header view layout readjust",
        "                DispatchQueue.main.asyncAfter(deadline: .now() + 0.5) { [weak self] in",
        "                    self?.prepareJumpBackInContextualHint(onView: headerView)",
        "                }",
        "            }"
      ],
      "ecosia_code": [],
      "context_before": [
        "                        at indexPath: IndexPath) -> UICollectionReusableView {",
        "        let reusableView = UICollectionReusableView()"
      ],
      "context_after": [
        "            return headerView",
        "        }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/LegacyHomepageViewController.swift",
      "line": 661,
      "type": "addition",
      "comment": "tooltip for impact",
      "firefox_code": [],
      "ecosia_code": [
        "        if sectionViewModel.sectionType == .impact,",
        "            let text = NTPTooltip.highlight()?.text,",
        "            kind == UICollectionView.elementKindSectionHeader {",
        "            let tooltip = collectionView.dequeueReusableSupplementaryView(ofKind: kind, withReuseIdentifier: NTPTooltip.key, for: indexPath) as! NTPTooltip",
        "            tooltip.applyTheme(theme: themeManager.getCurrentTheme(for: windowUUID))",
        "            tooltip.setText(text)",
        "            tooltip.delegate = self",
        "            return tooltip"
      ],
      "context_before": [
        "        else { return reusableView }",
        ""
      ],
      "context_after": [
        "        }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/LegacyHomepageViewController.swift",
      "line": 672,
      "type": "addition",
      "comment": "footer for impact",
      "firefox_code": [],
      "ecosia_code": [
        "        if sectionViewModel.sectionType == .impact, kind == UICollectionView.elementKindSectionFooter {",
        "            let dividerFooter = collectionView",
        "                .dequeueReusableSupplementaryView(ofKind: kind,",
        "                                                  withReuseIdentifier: NTPImpactDividerFooter.cellIdentifier,",
        "                                                  for: indexPath) as? NTPImpactDividerFooter",
        "            dividerFooter?.applyTheme(theme: themeManager.getCurrentTheme(for: windowUUID))",
        "            return dividerFooter ?? UICollectionReusableView()"
      ],
      "context_before": [
        "        }",
        ""
      ],
      "context_after": [
        "        }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/LegacyHomepageViewController.swift",
      "line": 738,
      "type": "removal",
      "comment": "Remove message Card  from HomePage",
      "firefox_code": [
        "        // Message card",
        "        viewModel.messageCardViewModel.dismissClosure = { [weak self] in",
        "            self?.reloadView()",
        "        }"
      ],
      "ecosia_code": [],
      "context_before": [
        "        }",
        ""
      ],
      "context_after": [
        "",
        "        // Top sites"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/LegacyHomepageViewController.swift",
      "line": 759,
      "type": "removal",
      "comment": "Remove `bookmarks` reference",
      "firefox_code": [
        "        // Bookmarks",
        "        viewModel.bookmarksViewModel.headerButtonAction = { [weak self] button in",
        "            self?.openBookmarks(button)",
        "        }",
        "        viewModel.bookmarksViewModel.onLongPressTileAction = { [weak self] (site, sourceView) in",
        "            self?.contextMenuHelper.presentContextMenu(",
        "                for: site,",
        "                with: sourceView,",
        "                sectionType: .bookmarks",
        "            )",
        "        }"
      ],
      "ecosia_code": [],
      "context_before": [
        "        }",
        ""
      ],
      "context_after": [
        "",
        "        /* Ecosia: Remove `jumpBackIn` reference"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/LegacyHomepageViewController.swift",
      "line": 774,
      "type": "removal",
      "comment": "Remove `jumpBackIn` reference",
      "firefox_code": [
        "        // Jumpback in",
        "        viewModel.jumpBackInViewModel.headerButtonAction = { [weak self] button in",
        "            self?.openTabTray(button)",
        "        }",
        "        viewModel.jumpBackInViewModel.onLongPressTileAction = { [weak self] (site, sourceView) in",
        "            self?.contextMenuHelper.presentContextMenu(",
        "                for: site,",
        "                with: sourceView,",
        "                sectionType: .bookmarks",
        "            )",
        "        }",
        "        viewModel.jumpBackInViewModel.syncedTabsShowAllAction = { [weak self] in",
        "            self?.homePanelDelegate?.homePanelDidRequestToOpenTabTray(focusedSegment: .syncedTabs)",
        "            var extras: [String: String]?",
        "            if let isZeroSearch = self?.viewModel.isZeroSearch {",
        "                extras = TelemetryWrapper.getOriginExtras(isZeroSearch: isZeroSearch)",
        "            }",
        "            TelemetryWrapper.recordEvent(category: .action,",
        "                                         method: .tap,",
        "                                         object: .firefoxHomepage,",
        "                                         value: .jumpBackInSectionSyncedTabShowAll,",
        "                                         extras: extras)",
        "        }",
        "        viewModel.jumpBackInViewModel.openSyncedTabAction = { [weak self] tabURL in",
        "            self?.homePanelDelegate?.homePanelDidRequestToOpenInNewTab(",
        "                tabURL,",
        "                isPrivate: false,",
        "                selectNewTab: true",
        "            )",
        "            var extras: [String: String]?",
        "            if let isZeroSearch = self?.viewModel.isZeroSearch {",
        "                extras = TelemetryWrapper.getOriginExtras(isZeroSearch: isZeroSearch)",
        "            }",
        "            TelemetryWrapper.recordEvent(category: .action,",
        "                                         method: .tap,",
        "                                         object: .firefoxHomepage,",
        "                                         value: .jumpBackInSectionSyncedTabOpened,",
        "                                         extras: extras)",
        "        }",
        "        viewModel.jumpBackInViewModel.prepareContextualHint = { [weak self] syncedTabCell in",
        "            self?.prepareSyncedTabContextualHint(onCell: syncedTabCell)",
        "        }"
      ],
      "ecosia_code": [],
      "context_before": [
        "         */",
        ""
      ],
      "context_after": [
        "",
        "        /* Ecosia: Remove History Highlights and Pocket"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/LegacyHomepageViewController.swift",
      "line": 825,
      "type": "removal",
      "comment": "Remove History Highlights and Pocket",
      "firefox_code": [
        "        // History highlights",
        "        viewModel.historyHighlightsViewModel.onTapItem = { [weak self] highlight in",
        "            guard let url = highlight.siteUrl else {",
        "                self?.openHistoryHighlightsSearchGroup(item: highlight)",
        "                return",
        "            }",
        "            self?.homePanelDelegate?.homePanel(didSelectURL: url,",
        "                                               visitType: .link,",
        "                                               isGoogleTopSite: false)",
        "        }",
        "        viewModel.historyHighlightsViewModel",
        "            .historyHighlightLongPressHandler = { [weak self] (highlightItem, sourceView) in",
        "                self?.contextMenuHelper.presentContextMenu(for: highlightItem,",
        "                                                           with: sourceView,",
        "                                                           sectionType: .historyHighlights)",
        "            }",
        "        viewModel.historyHighlightsViewModel.headerButtonAction = { [weak self] button in",
        "            self?.openHistory(button)",
        "        }",
        "        // Pocket",
        "        viewModel.pocketViewModel.onTapTileAction = { [weak self] url in",
        "            self?.showSiteWithURLHandler(url)",
        "        }",
        "        viewModel.pocketViewModel.onLongPressTileAction = { [weak self] (site, sourceView) in",
        "            self?.contextMenuHelper.presentContextMenu(for: site, with: sourceView, sectionType: .pocket)",
        "        }"
      ],
      "ecosia_code": [],
      "context_before": [
        "         */",
        ""
      ],
      "context_after": [
        "        /* Ecosia: Remove `customizeHome` reference",
        "        // Customize home"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/LegacyHomepageViewController.swift",
      "line": 858,
      "type": "removal",
      "comment": "Remove `customizeHome` reference",
      "firefox_code": [
        "        // Customize home",
        "        viewModel.customizeButtonViewModel.onTapAction = { [weak self] _ in",
        "            self?.openCustomizeHomeSettings()",
        "        }"
      ],
      "ecosia_code": [],
      "context_before": [
        "        }",
        "         */"
      ],
      "context_after": [
        "        // Ecosia: Adjust HomePageViewController's CollectionView",
        "        viewModel.libraryViewModel.delegate = self"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/LogoHeader/HomeLogoHeaderViewModel.swift",
      "line": 12,
      "type": "substitution",
      "comment": "Update bottom spacing",
      "firefox_code": [
        "static let bottomSpacing: CGFloat = 30"
      ],
      "ecosia_code": [
        "        static let bottomSpacing: CGFloat = 8",
        "        static let topSpacing: CGFloat = 16"
      ],
      "context_before": [
        "class HomepageHeaderViewModel {",
        "    struct UX {"
      ],
      "context_after": [
        "        // Ecosia: Update top inset for Seed Experiment",
        "        static let seedCounterNTPExperimentTopInset: CGFloat = 24"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/LogoHeader/HomeLogoHeaderViewModel.swift",
      "line": 16,
      "type": "addition",
      "comment": "Update top inset for Seed Experiment",
      "firefox_code": [],
      "ecosia_code": [
        "        static let seedCounterNTPExperimentTopInset: CGFloat = 24"
      ],
      "context_before": [
        "        static let bottomSpacing: CGFloat = 8",
        "        static let topSpacing: CGFloat = 16"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/LogoHeader/HomeLogoHeaderViewModel.swift",
      "line": 55,
      "type": "removal",
      "comment": "Migrate the top edge inset calculation from older app version",
      "firefox_code": [
        "        let leadingInset = HomepageViewModel.UX.leadingInset(traitCollection: traitCollection)",
        "        section.contentInsets = NSDirectionalEdgeInsets(",
        "            top: UX.topSpacing,",
        "            leading: leadingInset,",
        "            bottom: UX.bottomSpacing,",
        "            trailing: leadingInset)"
      ],
      "ecosia_code": [],
      "context_before": [
        "        let section = NSCollectionLayoutSection(group: group)",
        ""
      ],
      "context_after": [
        "        let height = max(UIScreen.main.bounds.width, UIScreen.main.bounds.height)",
        "        let pos: SearchBarPosition = LegacyFeatureFlagsManager.shared.getCustomState(for: .searchBarPosition) ?? .top"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/LogoHeader/HomeLogoHeaderViewModel.swift",
      "line": 93,
      "type": "removal",
      "comment": "Cell as NTPLogoCell",
      "firefox_code": [
        "        guard let headerCell = cell as? LegacyHomepageHeaderCell else { return UICollectionViewCell() }",
        "        headerCell.configure(",
        "            with: HomepageHeaderCellViewModel(",
        "                isPrivate: false,",
        "                showiPadSetup: showiPadSetup,",
        "                showPrivateModeToggle: showPrivateModeToggle,",
        "                action: { [weak self] in",
        "                    self?.tabManager.switchPrivacyMode()",
        "                })",
        "        )",
        "        headerCell.applyTheme(theme: theme)",
        "        return headerCell"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func configure(_ cell: UICollectionViewCell, at indexPath: IndexPath) -> UICollectionViewCell {"
      ],
      "context_after": [
        "        guard let logoHeaderCell = cell as? NTPLogoCell else { return UICollectionViewCell() }",
        "        logoHeaderCell.applyTheme(theme: theme)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/TopSites/DataManagement/TopSitesDataAdaptor.swift",
      "line": 89,
      "type": "removal",
      "comment": "remove sponsored tiles",
      "firefox_code": [
        "        let availableSpaceCount = getAvailableSpaceCount(maxTopSites: maxTopSites)",
        "        let shouldAddGoogle = shouldAddGoogle(availableSpaceCount: availableSpaceCount)",
        "        // Add Sponsored tile",
        "        if shouldAddSponsoredTiles {",
        "            addSponsoredTiles(sites: &sites,",
        "                              shouldAddGoogle: shouldAddGoogle,",
        "                              availableSpaceCount: availableSpaceCount)",
        "        }",
        "        // Add Google Tile",
        "        if shouldAddGoogle {",
        "            addGoogleTopSite(sites: &sites)",
        "        }"
      ],
      "ecosia_code": [],
      "context_before": [
        "    private func recalculateTopSiteData() {",
        "        var sites = historySites"
      ],
      "context_after": [
        "        sites.removeDuplicates()",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/TopSites/DataManagement/TopSitesDataAdaptor.swift",
      "line": 125,
      "type": "removal",
      "comment": "deactivate sponsored tiles",
      "firefox_code": [
        "        guard shouldLoadSponsoredTiles else { return }",
        "        dispatchGroup.enter()",
        "        contileProvider.fetchContiles { [weak self] result in",
        "            if case .success(let contiles) = result {",
        "                self?.contiles = contiles",
        "            } else {",
        "                self?.contiles = []",
        "            }",
        "            self?.dispatchGroup.leave()",
        "        }"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    private func loadContiles() {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/TopSites/DataManagement/TopSitesDataAdaptor.swift",
      "line": 169,
      "type": "removal",
      "comment": "remove sponsored tiles",
      "firefox_code": [
        "    func addSponsoredTiles(sites: inout [Site],",
        "                           shouldAddGoogle: Bool,",
        "                           availableSpaceCount: Int) {",
        "        let sponsoredTileSpaces = getSponsoredNumberTiles(shouldAddGoogle: shouldAddGoogle,",
        "                                                          availableSpaceCount: availableSpaceCount)",
        "        if sponsoredTileSpaces > 0 {",
        "            sites.addSponsoredTiles(sponsoredTileSpaces: sponsoredTileSpaces,",
        "                                    contiles: contiles,",
        "                                    defaultSearchEngine: profile.searchEnginesManager.defaultEngine)",
        "        }",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "        return Int(preferredNumberOfRows ?? defaultNumberOfRows)",
        "    }"
      ],
      "context_after": [
        "",
        "    private func countPinnedSites(sites: [Site]) -> Int {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/TopSites/DataManagement/TopSitesDataAdaptor.swift",
      "line": 192,
      "type": "removal",
      "comment": "remove sponsored tiles",
      "firefox_code": [
        "    // MARK: - Google Tile",
        "    private func shouldAddGoogle(availableSpaceCount: Int) -> Bool {",
        "        googleTopSiteManager.shouldAddGoogleTopSite(hasSpace: availableSpaceCount > 0)",
        "    }",
        "    private func addGoogleTopSite(sites: inout [Site]) {",
        "        googleTopSiteManager.addGoogleTopSite(sites: &sites)",
        "    }",
        "    // MARK: - Sponsored tiles (Contiles)",
        "    private var shouldLoadSponsoredTiles: Bool {",
        "        return profile.prefs.boolForKey(PrefsKeys.UserFeatureFlagPrefs.SponsoredShortcuts) ?? true",
        "    }",
        "    private var shouldAddSponsoredTiles: Bool {",
        "        return !contiles.isEmpty && shouldLoadSponsoredTiles",
        "    }",
        "    /// Google tile has precedence over Sponsored Tiles, if Google tile is present",
        "    private func getSponsoredNumberTiles(shouldAddGoogle: Bool, availableSpaceCount: Int) -> Int {",
        "        let googleAdjustedSpaceCount = availableSpaceCount - GoogleTopSiteManager.Constants.reservedSpaceCount",
        "        return shouldAddGoogle ? googleAdjustedSpaceCount : availableSpaceCount",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "}",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/TopSites/DataManagement/TopSitesDataAdaptor.swift",
      "line": 223,
      "type": "removal",
      "comment": "remove sponsored tiles",
      "firefox_code": [
        "    /// Add sponsored tiles to the top sites.",
        "    /// - Parameters:",
        "    ///   - sponsoredTileSpaces: The number of spaces available for sponsored tiles",
        "    ///   - contiles: An array of Contiles a type of tiles belonging in the Shortcuts section on the Firefox home page.",
        "    ///   - defaultSearchEngine: The default engine to filter sponsored tiles against",
        "    ///   - maxNumberOfSponsoredTile: maximum number of sponsored tiles",
        "    mutating func addSponsoredTiles(sponsoredTileSpaces: Int,",
        "                                    contiles: [Contile],",
        "                                    defaultSearchEngine: OpenSearchEngine?,",
        "                                    maxNumberOfSponsoredTile: Int = 2) {",
        "        guard maxNumberOfSponsoredTile > 0 else { return }",
        "        var siteAddedCount = 0",
        "        for (index, _) in contiles.enumerated() {",
        "            guard siteAddedCount < sponsoredTileSpaces, let contile = contiles[safe: index] else { return }",
        "            let site = SponsoredTile(contile: contile)",
        "            // Show the next sponsored site if site is already present in the pinned sites",
        "            // or if it's the default search engine",
        "            guard !siteIsAlreadyPresent(site: site),",
        "                  SponsoredTileDataUtility().shouldAdd(site: site, with: defaultSearchEngine)",
        "            else { continue }",
        "            insert(site, at: siteAddedCount)",
        "            siteAddedCount += 1",
        "            // Do not add more sponsored tile if we reach the maximum",
        "            guard siteAddedCount < maxNumberOfSponsoredTile else { break }",
        "        }",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "// MARK: Site Array extension",
        "private extension Array where Element == Site {"
      ],
      "context_after": [
        "    // Keeping the order of the sites, we remove duplicate tiles.",
        "    // Ex: If a sponsored tile is present then it has precedence over the history sites."
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/TopSites/DataManagement/TopSitesDataAdaptor.swift",
      "line": 269,
      "type": "substitution",
      "comment": "don't sort out suggested sites",
      "firefox_code": [
        "let shouldAddSite = !alreadyThere.contains(where: { $0.url.asURL?.shortDomain == siteDomain })"
      ],
      "ecosia_code": [
        "            let shouldAddSite = !alreadyThere.contains(where: { $0.url.asURL?.shortDomain == siteDomain }) || site is SuggestedSite"
      ],
      "context_before": [
        "",
        "            let siteDomain = site.url.asURL?.shortDomain"
      ],
      "context_after": [
        "            // If shouldAddSite or site domain was not found, then insert the site",
        "            guard shouldAddSite || siteDomain == nil else { return nil }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/TopSites/TopSitesDimension.swift",
      "line": 71,
      "type": "removal",
      "comment": "The design decided to have 4 tiles per row by default.",
      "firefox_code": [
        "        let cellWidth = TopSitesViewModel.UX.cellEstimatedSize.width",
        "        let leadingInset = HomepageViewModel.UX.leadingInset(traitCollection: interface.trait,",
        "                                                             interfaceIdiom: interface.interfaceIdiom)",
        "        var availableWidth = interface.availableWidth - leadingInset * 2",
        "        var numberOfTiles = 0",
        "        while availableWidth > cellWidth {",
        "            numberOfTiles += 1",
        "            availableWidth = availableWidth - cellWidth - TopSitesViewModel.UX.cardSpacing",
        "        }",
        "        return numberOfTiles < TopSitesViewModel.UX.minCards ? TopSitesViewModel.UX.minCards : numberOfTiles"
      ],
      "ecosia_code": [],
      "context_before": [
        "    /// - Returns: The number of tiles per row the user will see",
        "    private func getNumberOfTilesPerRow(for interface: TopSitesUIInterface) -> Int {"
      ],
      "context_after": [
        "        4",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/TopSites/TopSitesViewModel.swift",
      "line": 13,
      "type": "substitution",
      "comment": "Update `cellEstimatedSize`",
      "firefox_code": [
        "static let cellEstimatedSize = CGSize(width: 85, height: 94)"
      ],
      "ecosia_code": [
        "        static let cellEstimatedSize = CGSize(width: 100, height: 100)"
      ],
      "context_before": [
        "class TopSitesViewModel {",
        "    struct UX {"
      ],
      "context_after": [
        "        // Ecosia: Update `cardSpacing`",
        "        // static let cardSpacing: CGFloat = 16"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/TopSites/TopSitesViewModel.swift",
      "line": 16,
      "type": "substitution",
      "comment": "Update `cardSpacing`",
      "firefox_code": [
        "static let cardSpacing: CGFloat = 16"
      ],
      "ecosia_code": [
        "        static let cardSpacing: CGFloat = 8",
        "        static let minCards: Int = 4"
      ],
      "context_before": [
        "        // static let cellEstimatedSize = CGSize(width: 85, height: 94)",
        "        static let cellEstimatedSize = CGSize(width: 100, height: 100)"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/TopSites/TopSitesViewModel.swift",
      "line": 62,
      "type": "addition",
      "comment": "Track Top Site click",
      "firefox_code": [],
      "ecosia_code": [
        "        trackTopSitePressed(topSite: site, position: position)",
        "        tilePressedHandler?(site.site, site.isGoogleURL)"
      ],
      "context_before": [
        "    func tilePressed(site: TopSite, position: Int) {",
        "        topSitePressTracking(homeTopSite: site, position: position)"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/TopSites/TopSitesViewModel.swift",
      "line": 161,
      "type": "removal",
      "comment": "no header for top sites",
      "firefox_code": [
        "        return LabelButtonHeaderViewModel(",
        "            title: nil,",
        "            titleA11yIdentifier: AccessibilityIdentifiers.FirefoxHomepage.SectionTitles.topSites,",
        "            isButtonHidden: true,",
        "            textColor: wallpaperManager.currentWallpaper.textColor)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    var headerViewModel: LabelButtonHeaderViewModel {"
      ],
      "context_after": [
        "        .emptyHeader",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/TopSites/TopSitesViewModel.swift",
      "line": 172,
      "type": "substitution",
      "comment": "Check against different value",
      "firefox_code": [
        "return profile.prefs.boolForKey(PrefsKeys.UserFeatureFlagPrefs.TopSiteSection) ?? true"
      ],
      "ecosia_code": [
        "        User.shared.showTopSites"
      ],
      "context_before": [
        "",
        "    var isEnabled: Bool {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/TopSites/TopSitesViewModel.swift",
      "line": 200,
      "type": "substitution",
      "comment": "Remove group spacing",
      "firefox_code": [
        "group.interItemSpacing = NSCollectionLayoutSpacing.fixed(UX.cardSpacing)"
      ],
      "ecosia_code": [
        "        let section = NSCollectionLayoutSection(group: group)"
      ],
      "context_before": [
        "                                                       subitem: item,",
        "                                                       count: sectionDimension.numberOfTilesPerRow)"
      ],
      "context_after": [
        "",
        "        /* Ecosia: Use sectionType's section insets with updated bottom spacing"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Home/TopSites/TopSitesViewModel.swift",
      "line": 204,
      "type": "removal",
      "comment": "Use sectionType's section insets with updated bottom spacing",
      "firefox_code": [
        "        let leadingInset = HomepageViewModel.UX.leadingInset(traitCollection: traitCollection)",
        "        section.contentInsets = NSDirectionalEdgeInsets(",
        "            top: 0,",
        "            leading: leadingInset,",
        "            bottom: HomepageViewModel.UX.spacingBetweenSections - TopSiteItemCell.UX.bottomSpace,",
        "            trailing: leadingInset",
        "        )"
      ],
      "ecosia_code": [],
      "context_before": [
        "        let section = NSCollectionLayoutSection(group: group)",
        ""
      ],
      "context_after": [
        "        section.contentInsets = sectionType.sectionInsets(traitCollection, bottomSpacing: 24)",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/InternalSchemeHandler/ErrorPageHelper.swift",
      "line": 202,
      "type": "removal",
      "comment": "Update button text",
      "firefox_code": [
        "        let tryAgain: String = .ErrorPageTryAgain"
      ],
      "ecosia_code": [],
      "context_before": [
        "            ]",
        ""
      ],
      "context_after": [
        "        let tryAgain: String = noConnectionErrorButtonTitle",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/InternalSchemeHandler/ErrorPageHelper.swift",
      "line": 212,
      "type": "removal",
      "comment": "Add custom no internet screen",
      "firefox_code": [
        "        if errDomain == kCFErrorDomainCFNetwork as String {"
      ],
      "ecosia_code": [],
      "context_before": [
        "        // swiftlint:enable line_length",
        ""
      ],
      "context_after": [
        "        if errDomain == NSURLErrorDomain {",
        "            asset = Bundle.main.path(forResource: \"EcosiaNetError\", ofType: \"html\")"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/InternalSchemeHandler/InternalSchemeHandler.swift",
      "line": 36,
      "type": "addition",
      "comment": "Allow EcosiaNetError resources",
      "firefox_code": [],
      "ecosia_code": [
        "            \"/errorpage-resource/EcosiaNetError.css\",",
        "            \"/errorpage-resource/EcosiaErrorPlaceholderPath.png\","
      ],
      "context_before": [
        "            \"/errorpage-resource/NetError.css\",",
        "            \"/errorpage-resource/CertError.css\","
      ],
      "context_after": [
        "           // \"/reader-mode/...\"",
        "        ]"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/InternalSchemeHandler/InternalSchemeHandler.swift",
      "line": 60,
      "type": "addition",
      "comment": "Replace placeholder error image",
      "firefox_code": [],
      "ecosia_code": [
        "            } else if path.hasSuffix(\"EcosiaErrorPlaceholderPath.png\"),",
        "                      let data = UIImage(named: \"noInternet\")?.pngData() {",
        "                urlSchemeTask.didReceive(URLResponse(url: url, mimeType: nil, expectedContentLength: -1, textEncodingName: nil))",
        "                urlSchemeTask.didReceive(data)",
        "                urlSchemeTask.didFinish()",
        "                return true"
      ],
      "context_before": [
        "                urlSchemeTask.didFinish()",
        "                return true"
      ],
      "context_after": [
        "            }",
        "        }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/Bookmarks/Legacy/BookmarksPanelViewModel.swift",
      "line": 11,
      "type": "removal",
      "comment": "Import all of MozillaAppServices for legacy code usage",
      "firefox_code": [
        "import class MozillaAppServices.BookmarkFolderData",
        "import enum MozillaAppServices.BookmarkRoots"
      ],
      "ecosia_code": [],
      "context_before": [
        "import Ecosia",
        ""
      ],
      "context_after": [
        "import MozillaAppServices",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/Bookmarks/Legacy/BookmarksPanelViewModel.swift",
      "line": 17,
      "type": "removal",
      "comment": "Inherit NSObject so it can extend UIDocumentPickerDelegate",
      "firefox_code": [
        "class BookmarksPanelViewModel {"
      ],
      "ecosia_code": [],
      "context_before": [
        "import MozillaAppServices",
        ""
      ],
      "context_after": [
        "class BookmarksPanelViewModel: NSObject {",
        "    enum BookmarksSection: Int, CaseIterable {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/Bookmarks/Legacy/BookmarksPanelViewModel.swift",
      "line": 36,
      "type": "addition",
      "comment": "Import Bookmarks Helper",
      "firefox_code": [],
      "ecosia_code": [
        "    private let bookmarksExchange: BookmarksExchangable",
        "    private var documentPickerPresentingViewController: UIViewController?",
        "    private var onImportDoneHandler: ((URL?, Error?) -> Void)?",
        "    private var onExportDoneHandler: ((Error?) -> Void)?"
      ],
      "context_before": [
        "    private var flashLastRowOnNextReload = false",
        "    private var logger: Logger"
      ],
      "context_after": [
        "",
        "    /// By default our root folder is the mobile folder. Desktop folders are shown in the local desktop folders."
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/Bookmarks/Legacy/BookmarksPanelViewModel.swift",
      "line": 51,
      "type": "addition",
      "comment": "BookmarksExchange",
      "firefox_code": [],
      "ecosia_code": [
        "        self.bookmarksExchange = BookmarksExchange(profile: profile)"
      ],
      "context_before": [
        "        self.bookmarkFolderGUID = bookmarkFolderGUID",
        "        self.logger = logger"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/Bookmarks/Legacy/BookmarksPanelViewModel.swift",
      "line": 131,
      "type": "removal",
      "comment": "remove desktop folder",
      "firefox_code": [
        "                let desktopFolder = LocalDesktopFolder()",
        "                self.bookmarkNodes.insert(desktopFolder, at: 0)"
      ],
      "ecosia_code": [],
      "context_before": [
        "                self.bookmarkNodes = mobileFolder.fxChildren ?? []",
        ""
      ],
      "context_after": [
        "                completion()",
        "            }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/Bookmarks/Legacy/BookmarksPanelViewModel.swift",
      "line": 178,
      "type": "addition",
      "comment": "Import Bookmarks Helper",
      "firefox_code": [],
      "ecosia_code": [
        "extension BookmarksPanelViewModel {"
      ],
      "context_before": [
        "}",
        ""
      ],
      "context_after": [
        "",
        "    func bookmarkExportSelected(in viewController: LegacyBookmarksPanel, onDone: @escaping (Error?) -> Void) {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/Bookmarks/Legacy/BookmarksPanelViewModel.swift",
      "line": 199,
      "type": "addition",
      "comment": "Theming",
      "firefox_code": [],
      "ecosia_code": [
        "        let themeManager: ThemeManager = AppContainer.shared.resolve()",
        "        let theme = themeManager.getCurrentTheme(for: viewController.view.currentWindowUUID)",
        "        documentPicker.view.tintColor = theme.colors.ecosia.buttonBackgroundPrimary",
        "        documentPicker.delegate = self",
        "        viewController.present(documentPicker, animated: true)"
      ],
      "context_before": [
        "        let documentPicker = UIDocumentPickerViewController(documentTypes: [\"public.html\"], in: .open)",
        "        documentPicker.allowsMultipleSelection = false"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/Bookmarks/Legacy/LegacyBookmarkDetailPanel.swift",
      "line": 251,
      "type": "addition",
      "comment": "Fix edit bookmark navigation items color",
      "firefox_code": [],
      "ecosia_code": [
        "        navigationItem.rightBarButtonItem?.tintColor = currentTheme().colors.actionPrimary",
        "        navigationItem.leftBarButtonItem?.tintColor = currentTheme().colors.actionPrimary"
      ],
      "context_before": [
        "        deleteBookmarkButton.setTitle(.Bookmarks.Menu.DeleteBookmark, for: .normal)",
        "        deleteBookmarkButton.setTitleColor(currentTheme().colors.textCritical, for: .normal)"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/Bookmarks/Legacy/LegacyBookmarksPanel.swift",
      "line": 52,
      "type": "removal",
      "comment": "Split mainView and inFolder staes",
      "firefox_code": [
        "        case .bookmarks(state: .mainView), .bookmarks(state: .inFolder):",
        "            bottomRightButton.title = .BookmarksEdit",
        "            return [flexibleSpace, bottomRightButton]"
      ],
      "ecosia_code": [],
      "context_before": [
        "    private var toolbarButtonItems: [UIBarButtonItem] {",
        "        switch state {"
      ],
      "context_after": [
        "        case .bookmarks(state: .mainView):",
        "            bottomRightButton.title = .BookmarksEdit"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/Bookmarks/Legacy/LegacyBookmarksPanel.swift",
      "line": 65,
      "type": "addition",
      "comment": "Enable the Done button after closing the panel details",
      "firefox_code": [],
      "ecosia_code": [
        "            bottomRightButton.isEnabled = true",
        "            return [bottomLeftButton, flexibleSpace, bottomRightButton]",
        "        case .bookmarks(state: .itemEditMode):",
        "            bottomRightButton.title = String.AppSettingsDone",
        "            bottomRightButton.isEnabled = true",
        "            return [flexibleSpace, bottomRightButton]",
        "        case .bookmarks(state: .itemEditModeInvalidField):",
        "            bottomRightButton.title = String.AppSettingsDone",
        "            bottomRightButton.isEnabled = false",
        "            return [flexibleSpace, bottomRightButton]",
        "        default:",
        "            return [UIBarButtonItem]()"
      ],
      "context_before": [
        "        case .bookmarks(state: .inFolderEditMode):",
        "            bottomRightButton.title = String.AppSettingsDone"
      ],
      "context_after": [
        "        }",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/Bookmarks/Legacy/LegacyBookmarksPanel.swift",
      "line": 92,
      "type": "substitution",
      "comment": "Import Bookmarks Helper",
      "firefox_code": [
        "Add `moreButton`"
      ],
      "ecosia_code": [
        "    lazy var moreButton: UIBarButtonItem = {",
        "        let button = UIBarButtonItem(title: .localized(.bookmarksPanelMore),",
        "                                     style: .plain,",
        "                                     target: self,",
        "                                     action: #selector(showMoreDialog))",
        "        button.accessibilityIdentifier = AccessibilityIdentifiers.LibraryPanels.bottomLeftButton",
        "        return button",
        "    }()"
      ],
      "context_before": [
        "    }()",
        ""
      ],
      "context_after": [
        "",
        "    private lazy var bottomRightButton: UIBarButtonItem = {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/Bookmarks/Legacy/LegacyBookmarksPanel.swift",
      "line": 114,
      "type": "addition",
      "comment": "add bookmarks empty state",
      "firefox_code": [],
      "ecosia_code": [
        "    private lazy var emptyHeader = EmptyHeader(icon: \"bookmarksEmpty\", title: .localized(.noBookmarksYet), subtitle: .localized(.AddYourFavoritePages))"
      ],
      "context_before": [
        "    }()",
        ""
      ],
      "context_after": [
        "",
        "    // Ecosia: Tooltip"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/Bookmarks/Legacy/LegacyBookmarksPanel.swift",
      "line": 117,
      "type": "addition",
      "comment": "Tooltip",
      "firefox_code": [],
      "ecosia_code": [
        "    private lazy var bookmarksTooltip: NTPTooltip = {",
        "        let tooltip = NTPTooltip()",
        "        tooltip.tailPosition = .leading",
        "        tooltip.applyTheme(theme: currentTheme())",
        "        tooltip.setText(.localized(.bookmarksToolTipText))",
        "        tooltip.setLinkTitle(.localized(.learnMore), theme: currentTheme())",
        "        return tooltip",
        "    }()"
      ],
      "context_before": [
        "    private lazy var emptyHeader = EmptyHeader(icon: \"bookmarksEmpty\", title: .localized(.noBookmarksYet), subtitle: .localized(.AddYourFavoritePages))",
        ""
      ],
      "context_after": [
        "",
        "    // MARK: - Init"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/Bookmarks/Legacy/LegacyBookmarksPanel.swift",
      "line": 165,
      "type": "addition",
      "comment": "Update TableView properties",
      "firefox_code": [],
      "ecosia_code": [
        "        tableView.contentInset.top = 32"
      ],
      "context_before": [
        "        tableView.allowsSelectionDuringEditing = true",
        "        tableView.dragInteractionEnabled = false"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/Bookmarks/Legacy/LegacyBookmarksPanel.swift",
      "line": 169,
      "type": "addition",
      "comment": "Tooltip",
      "firefox_code": [],
      "ecosia_code": [
        "    override func viewDidAppear(_ animated: Bool) {",
        "        super.viewDidAppear(animated)"
      ],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "",
        "        if EcosiaInstallType.get() == .upgrade && User.shared.showsBookmarksImportExportTooltip {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/Bookmarks/Legacy/LegacyBookmarksPanel.swift",
      "line": 196,
      "type": "addition",
      "comment": "add bookmarks empty state",
      "firefox_code": [],
      "ecosia_code": [
        "            self?.updateEmptyView()"
      ],
      "context_before": [
        "            }",
        ""
      ],
      "context_after": [
        "        }",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/Bookmarks/Legacy/LegacyBookmarksPanel.swift",
      "line": 201,
      "type": "addition",
      "comment": "add bookmarks empty state",
      "firefox_code": [],
      "ecosia_code": [
        "    private func updateEmptyView() {",
        "        switch (viewModel.isRootNode, viewModel.bookmarkNodes.isEmpty) {",
        "        case (true, true): // is first level, no bookmarks -> show explainative empty view"
      ],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "            // Ecosia: Add `bottomAnchorDelta` util to determine `bottomAnchor` margin",
        "            let navigationControllerHeight: CGFloat = (navigationController?.toolbar.bounds.size.height ?? 0)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/Bookmarks/Legacy/LegacyBookmarksPanel.swift",
      "line": 205,
      "type": "addition",
      "comment": "Add `bottomAnchorDelta` util to determine `bottomAnchor` margin",
      "firefox_code": [],
      "ecosia_code": [
        "            let navigationControllerHeight: CGFloat = (navigationController?.toolbar.bounds.size.height ?? 0)",
        "            let topAnchorDelta: CGFloat = UIDevice.current.userInterfaceIdiom == .pad ? -navigationControllerHeight : -navigationControllerHeight*3",
        "            /* Update EmptyBookmarksView initialization",
        "            let emptyBookmarksView = EmptyBookmarksView(",
        "                initialBottomMargin: -(navigationController?.toolbar.bounds.size.height ?? 0)",
        "            )",
        "             */",
        "            let emptyBookmarksView = EmptyBookmarksView(initialBottomMargin: topAnchorDelta)",
        "            emptyBookmarksView.delegate = self",
        "            emptyBookmarksView.applyTheme(theme: currentTheme())",
        "            tableView.tableHeaderView = nil",
        "            tableView.backgroundView = emptyBookmarksView",
        "        case (false, true): // is folder which is empty -> show \"old\" empty view",
        "            tableView.tableHeaderView = emptyHeader",
        "            tableView.backgroundView = nil",
        "        case (_, false): // got bookmarks, don't show any empty view",
        "            tableView.tableHeaderView = nil",
        "            tableView.backgroundView = nil"
      ],
      "context_before": [
        "        switch (viewModel.isRootNode, viewModel.bookmarkNodes.isEmpty) {",
        "        case (true, true): // is first level, no bookmarks -> show explainative empty view"
      ],
      "context_after": [
        "        }",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/Bookmarks/Legacy/LegacyBookmarksPanel.swift",
      "line": 719,
      "type": "addition",
      "comment": "add bookmarks empty state",
      "firefox_code": [],
      "ecosia_code": [
        "extension LegacyBookmarksPanel: EmptyBookmarksViewDelegate {",
        "    func emptyBookmarksViewLearnMoreTapped(_ view: EmptyBookmarksView) {",
        "        libraryPanelDelegate?.libraryPanel(",
        "            didSelectURL: EcosiaEnvironment.current.urlProvider.bookmarksHelp,",
        "            visitType: .link",
        "        )"
      ],
      "context_before": [
        "}",
        ""
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/Bookmarks/Legacy/LegacyBookmarksPanel.swift",
      "line": 733,
      "type": "addition",
      "comment": "Tooltip delegate",
      "firefox_code": [],
      "ecosia_code": [
        "extension LegacyBookmarksPanel: NTPTooltipDelegate {",
        "    func ntpTooltipTapped(_ tooltip: NTPTooltip?) {",
        "        hideBookmarksTooltip()"
      ],
      "context_before": [
        "}",
        ""
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/Bookmarks/Legacy/LegacyBookmarksPanel.swift",
      "line": 751,
      "type": "addition",
      "comment": "Import Bookmarks Helper",
      "firefox_code": [],
      "ecosia_code": [
        "extension LegacyBookmarksPanel {"
      ],
      "context_before": [
        "}",
        ""
      ],
      "context_after": [
        "",
        "    func importBookmarksActionHandler() {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/Downloads/DownloadsPanel.swift",
      "line": 234,
      "type": "addition",
      "comment": "Add `topAnchorDelta` util to determine `topAnchor` margin",
      "firefox_code": [],
      "ecosia_code": [
        "                let topAnchorDelta: CGFloat = UIDevice.current.userInterfaceIdiom == .phone ? -50 : 0"
      ],
      "context_before": [
        "                view.addSubview(emptyStateOverlayView)",
        "                view.bringSubviewToFront(emptyStateOverlayView)"
      ],
      "context_after": [
        "",
        "                NSLayoutConstraint.activate(["
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/Downloads/DownloadsPanel.swift",
      "line": 238,
      "type": "substitution",
      "comment": "Update reading list top anchor constant only if iPhone",
      "firefox_code": [
        "emptyStateOverlayView.topAnchor.constraint(equalTo: view.topAnchor),"
      ],
      "ecosia_code": [
        "                    emptyStateOverlayView.topAnchor.constraint(equalTo: view.topAnchor, constant: topAnchorDelta),",
        "                    emptyStateOverlayView.leadingAnchor.constraint(equalTo: view.leadingAnchor),",
        "                    emptyStateOverlayView.bottomAnchor.constraint(equalTo: view.bottomAnchor),",
        "                    emptyStateOverlayView.trailingAnchor.constraint(equalTo: view.trailingAnchor)",
        "                ])"
      ],
      "context_before": [
        "",
        "                NSLayoutConstraint.activate(["
      ],
      "context_after": [
        "            }",
        "        } else {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/Downloads/DownloadsPanel.swift",
      "line": 260,
      "type": "substitution",
      "comment": "Update icon color",
      "firefox_code": [
        "imageView.tintColor = theme.colors.iconSecondary"
      ],
      "ecosia_code": [
        "            imageView.tintColor = theme.colors.textPrimary"
      ],
      "context_before": [
        "            imageView.image = UIImage.templateImageNamed(StandardImageIdentifiers.Large.download)?",
        "                .withRenderingMode(.alwaysTemplate)"
      ],
      "context_after": [
        "        }",
        "        let welcomeLabel: UILabel = .build { label in"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/HistoryPanel/HistoryPanel.swift",
      "line": 78,
      "type": "substitution",
      "comment": "Update button position",
      "firefox_code": [
        "return [bottomDeleteButton, flexibleSpace, bottomSearchButton, flexibleSpace]"
      ],
      "ecosia_code": [
        "        return [flexibleSpace, bottomSearchButton, flexibleSpace, bottomDeleteButton]"
      ],
      "context_before": [
        "        }",
        ""
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/HistoryPanel/HistoryPanel.swift",
      "line": 85,
      "type": "removal",
      "comment": "Updare bottom search button",
      "firefox_code": [
        "        let button = UIBarButtonItem(image: UIImage.templateImageNamed(StandardImageIdentifiers.Large.search),",
        "                                     style: .plain,",
        "                                     target: self,",
        "                                     action: #selector(bottomSearchButtonAction))"
      ],
      "ecosia_code": [],
      "context_before": [
        "    // UI",
        "    private lazy var bottomSearchButton: UIBarButtonItem = {"
      ],
      "context_after": [
        "        let button = UIBarButtonItem(image: UIImage.templateImageNamed(\"searchFilled\"),",
        "                                     style: .plain,"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/HistoryPanel/HistoryPanel.swift",
      "line": 100,
      "type": "removal",
      "comment": "Updare clear all button",
      "firefox_code": [
        "        let button = UIBarButtonItem(image: UIImage.templateImageNamed(StandardImageIdentifiers.Large.delete),",
        "                                     style: .plain,",
        "                                     target: self,",
        "                                     action: #selector(bottomDeleteButtonAction))"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    private lazy var bottomDeleteButton: UIBarButtonItem = {"
      ],
      "context_after": [
        "        let button = UIBarButtonItem(title: .localized(.clearAll),",
        "                                     style: .plain,"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/HistoryPanel/HistoryPanel.swift",
      "line": 120,
      "type": "addition",
      "comment": "Update SearchBar properties",
      "firefox_code": [],
      "ecosia_code": [
        "        searchbar.searchBarStyle = .prominent",
        "        searchbar.searchTextField.layer.cornerRadius = 18",
        "        searchbar.searchTextField.layer.masksToBounds = true",
        "        searchbar.backgroundImage = .init()"
      ],
      "context_before": [
        "        searchbar.returnKeyType = .go",
        "        searchbar.delegate = self"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/HistoryPanel/HistoryPanel.swift",
      "line": 127,
      "type": "substitution",
      "comment": "Update TableView init to make it grouped",
      "firefox_code": [
        "private lazy var tableView: UITableView = .build { [weak self] tableView in"
      ],
      "ecosia_code": [
        "    private lazy var tableView: UITableView = {",
        "        let tableView = UITableView(frame: .zero, style: .insetGrouped)",
        "        tableView.translatesAutoresizingMaskIntoConstraints = false",
        "        tableView.dataSource = self.diffableDataSource",
        "        tableView.addGestureRecognizer(self.longPressRecognizer)",
        "        tableView.accessibilityIdentifier = a11yIds.tableView",
        "        tableView.prefetchDataSource = self",
        "        tableView.delegate = self",
        "        tableView.register(TwoLineImageOverlayCell.self,",
        "                           forCellReuseIdentifier: TwoLineImageOverlayCell.cellIdentifier)",
        "        tableView.register(TwoLineImageOverlayCell.self,",
        "                           forCellReuseIdentifier: TwoLineImageOverlayCell.accessoryUsageReuseIdentifier)",
        "        tableView.register(OneLineTableViewCell.self,",
        "                           forCellReuseIdentifier: OneLineTableViewCell.cellIdentifier)",
        "        tableView.register(SiteTableViewHeader.self,",
        "                           forHeaderFooterViewReuseIdentifier: SiteTableViewHeader.cellIdentifier)",
        "        tableView.sectionHeaderTopPadding = 0"
      ],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "",
        "        // Ecosia: Update tableView properties"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/HistoryPanel/HistoryPanel.swift",
      "line": 147,
      "type": "addition",
      "comment": "Update tableView properties",
      "firefox_code": [],
      "ecosia_code": [
        "        tableView.contentInset.top = 32",
        "        return tableView",
        "    }()"
      ],
      "context_before": [
        "        tableView.sectionHeaderTopPadding = 0",
        ""
      ],
      "context_after": [
        "",
        "    lazy var longPressRecognizer: UILongPressGestureRecognizer = {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/HistoryPanel/HistoryPanel.swift",
      "line": 165,
      "type": "addition",
      "comment": "Add Empty Header",
      "firefox_code": [],
      "ecosia_code": [
        "    private lazy var emptyHeader = EmptyHeader(icon: \"libraryHistory\", title: .localized(.noHistory), subtitle: .localized(.websitesYouHave))",
        "    var refreshControl: UIRefreshControl?",
        "    var recentlyClosedCell: OneLineTableViewCell?"
      ],
      "context_before": [
        "        label.adjustsFontSizeToFitWidth = true",
        "    }"
      ],
      "context_after": [
        "",
        "    // MARK: - Inits"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/HistoryPanel/HistoryPanel.swift",
      "line": 254,
      "type": "removal",
      "comment": "Update constraints",
      "firefox_code": [
        "             bottomStackView.leadingAnchor.constraint(equalTo: view.safeAreaLayoutGuide.leadingAnchor),",
        "             bottomStackView.bottomAnchor.constraint(equalTo: view.safeAreaLayoutGuide.bottomAnchor),",
        "             bottomStackView.trailingAnchor.constraint(equalTo: view.safeAreaLayoutGuide.trailingAnchor)"
      ],
      "ecosia_code": [],
      "context_before": [
        "            tableView.trailingAnchor.constraint(equalTo: view.safeAreaLayoutGuide.trailingAnchor),",
        ""
      ],
      "context_after": [
        "            bottomStackView.leadingAnchor.constraint(equalTo: view.safeAreaLayoutGuide.leadingAnchor, constant: 8),",
        "            bottomStackView.bottomAnchor.constraint(equalTo: view.safeAreaLayoutGuide.bottomAnchor),"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/HistoryPanel/HistoryPanel.swift",
      "line": 369,
      "type": "removal",
      "comment": "Remove emptyStateOverlayView ref",
      "firefox_code": [
        "            if emptyStateOverlayView.superview != nil {",
        "                emptyStateOverlayView.removeFromSuperview()",
        "            }",
        "            emptyStateOverlayView = createEmptyStateOverlayView()"
      ],
      "ecosia_code": [],
      "context_before": [
        "            break",
        "        case .DynamicFontChanged:"
      ],
      "context_after": [
        "            resyncHistory()",
        "            break"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/HistoryPanel/HistoryPanel.swift",
      "line": 626,
      "type": "substitution",
      "comment": "Replace empty header",
      "firefox_code": [
        "tableView.tableFooterView = emptyStateOverlayView"
      ],
      "ecosia_code": [
        "            tableView.tableFooterView = emptyHeader",
        "            emptyHeader.applyTheme(theme: currentTheme())",
        "        } else {",
        "            tableView.alwaysBounceVertical = true",
        "            tableView.tableFooterView = nil"
      ],
      "context_before": [
        "            applyEmptyStateViewTheme(currentTheme())",
        "            welcomeLabel.text = viewModel.emptyStateText"
      ],
      "context_after": [
        "        }",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/HistoryPanel/HistoryPanel.swift",
      "line": 680,
      "type": "removal",
      "comment": "Search Bar and TableView with same color",
      "firefox_code": [
        "        searchbar.backgroundColor = theme.colors.layer3"
      ],
      "ecosia_code": [],
      "context_before": [
        "        emptyStateOverlayView.backgroundColor = theme.colors.layer1",
        ""
      ],
      "context_after": [
        "        searchbar.barTintColor = tableView.backgroundColor",
        "        searchbar.backgroundColor = tableView.backgroundColor"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/HistoryPanel/HistoryPanel.swift",
      "line": 687,
      "type": "removal",
      "comment": "Update search bar image",
      "firefox_code": [
        "        let tintColor = theme.colors.textPrimary",
        "        let searchBarImage = UIImage(named: StandardImageIdentifiers.Large.history)?",
        "            .withRenderingMode(.alwaysTemplate)",
        "            .tinted(withColor: tintColor)"
      ],
      "ecosia_code": [],
      "context_before": [
        "        searchbar.searchTextField.backgroundColor = theme.colors.ecosia.backgroundPrimary",
        ""
      ],
      "context_after": [
        "        let searchBarImage = UIImage(named: \"search\")?.tinted(withColor: theme.colors.ecosia.textSecondary).createScaled(.init(width: 16, height: 16))",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/HistoryPanel/HistoryPanel.swift",
      "line": 697,
      "type": "removal",
      "comment": "Update search bar tint color",
      "firefox_code": [
        "        searchbar.tintColor = theme.colors.textPrimary"
      ],
      "ecosia_code": [],
      "context_before": [
        "        searchbar.setImage(searchBarImage, for: .search, state: .normal)",
        ""
      ],
      "context_after": [
        "        searchbar.tintColor = theme.colors.textPrimary",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/HistoryPanel/HistoryPanel.swift",
      "line": 706,
      "type": "removal",
      "comment": "Update bottomSearchButton theming",
      "firefox_code": [
        "        bottomSearchButton.tintColor = theme.colors.iconPrimary",
        "        bottomDeleteButton.tintColor = theme.colors.iconPrimary"
      ],
      "ecosia_code": [],
      "context_before": [
        "        ]",
        ""
      ],
      "context_after": [
        "        bottomSearchButton.tintColor = theme.colors.ecosia.textPrimary",
        "        bottomDeleteButton.tintColor = theme.colors.ecosia.stateError"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/LibraryPanelHelper.swift",
      "line": 53,
      "type": "removal",
      "comment": "Invert Download and Reading list positions in the LibraryViewController",
      "firefox_code": [
        "    case downloads = 2",
        "    case readingList = 3"
      ],
      "ecosia_code": [],
      "context_before": [
        "    case bookmarks = 0",
        "    case history = 1"
      ],
      "context_after": [
        "    case readingList = 2",
        "    case downloads = 3"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/LibraryPanelHelper.swift",
      "line": 104,
      "type": "removal",
      "comment": "Invert Download and Reading list positions in the LibraryViewController",
      "firefox_code": [
        "             LibraryPanelDescriptor(",
        "                accessibilityLabel: .LibraryPanelDownloadsAccessibilityLabel,",
        "                accessibilityIdentifier: AccessibilityIdentifiers.LibraryPanels.downloadsView,",
        "                panelType: .downloads),",
        "            LibraryPanelDescriptor(",
        "                accessibilityLabel: .LibraryPanelReadingListAccessibilityLabel,",
        "                accessibilityIdentifier: AccessibilityIdentifiers.LibraryPanels.readingListView,",
        "                panelType: .readingList),"
      ],
      "ecosia_code": [],
      "context_before": [
        "                panelType: .history),",
        ""
      ],
      "context_after": [
        "            LibraryPanelDescriptor(",
        "                accessibilityLabel: .LibraryPanelReadingListAccessibilityLabel,"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/LibraryViewController/LibraryViewController.swift",
      "line": 172,
      "type": "removal",
      "comment": "Invert Download and Reading list positions in the LibraryViewController",
      "firefox_code": [
        "        case 2:",
        "            selectedPanel = .downloads",
        "            eventValue = .downloadsPanel",
        "        case 3:",
        "            selectedPanel = .readingList",
        "            eventValue = .readingListPanel"
      ],
      "ecosia_code": [],
      "context_before": [
        "            selectedPanel = .history",
        "            eventValue = .historyPanel"
      ],
      "context_after": [
        "        case 2:",
        "            selectedPanel = .readingList"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/LibraryViewController/LibraryViewController.swift",
      "line": 329,
      "type": "removal",
      "comment": "Update theming",
      "firefox_code": [
        "        standardAppearance.backgroundColor = theme.colors.layer1"
      ],
      "ecosia_code": [],
      "context_before": [
        "        standardAppearance.configureWithDefaultBackground()",
        ""
      ],
      "context_after": [
        "        standardAppearance.backgroundColor = theme.colors.ecosia.backgroundPrimary",
        "        standardAppearance.shadowColor = theme.colors.ecosia.borderDecorative"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/LibraryViewController/LibraryViewController.swift",
      "line": 351,
      "type": "removal",
      "comment": "Update background from layer1",
      "firefox_code": [
        "        view.backgroundColor = theme.colors.layer1",
        "        navigationController?.navigationBar.barTintColor = theme.colors.layer1",
        "        navigationController?.navigationBar.tintColor = theme.colors.actionPrimary",
        "        navigationController?.navigationBar.backgroundColor = theme.colors.layer1",
        "        navigationController?.toolbar.barTintColor = theme.colors.layer1",
        "        navigationController?.toolbar.tintColor = theme.colors.actionPrimary",
        "        segmentControlToolbar.barTintColor = theme.colors.layer1"
      ],
      "ecosia_code": [],
      "context_before": [
        "        let theme = themeManager.getCurrentTheme(for: windowUUID)",
        ""
      ],
      "context_after": [
        "        view.backgroundColor = theme.colors.layer3",
        "        navigationController?.navigationBar.barTintColor = theme.colors.ecosia.backgroundPrimaryDecorative"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/LibraryViewController/LibraryViewController.swift",
      "line": 369,
      "type": "addition",
      "comment": "Add segmented control colors",
      "firefox_code": [],
      "ecosia_code": [
        "        librarySegmentControl.backgroundColor = theme.colors.ecosia.segmentedControlBackgroundRest",
        "        librarySegmentControl.selectedSegmentTintColor = theme.colors.ecosia.segmentedControlBackgroundActive",
        "        librarySegmentControl.tintColor = theme.colors.ecosia.buttonContentSecondary"
      ],
      "context_before": [
        "        segmentControlToolbar.isTranslucent = false",
        ""
      ],
      "context_after": [
        "",
        "        setNeedsStatusBarAppearanceUpdate()"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/LibraryViewController/LibraryViewModel.swift",
      "line": 14,
      "type": "removal",
      "comment": "Update images and positions",
      "firefox_code": [
        "        [UIImage(named: StandardImageIdentifiers.Large.bookmarkTrayFill) ?? UIImage(),",
        "         UIImage(named: StandardImageIdentifiers.Large.history) ?? UIImage(),",
        "         UIImage(named: StandardImageIdentifiers.Large.download) ?? UIImage(),",
        "         UIImage(named: StandardImageIdentifiers.Large.readingList) ?? UIImage()]"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    var segmentedControlItems: [UIImage] {"
      ],
      "context_after": [
        "        [",
        "            UIImage(named: \"libraryFavorites\"),"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/Reader/ReaderPanel.swift",
      "line": 295,
      "type": "addition",
      "comment": "Add `topAnchorDelta` util to determine `topAnchor` margin",
      "firefox_code": [],
      "ecosia_code": [
        "            let topAnchorDelta: CGFloat = UIDevice.current.userInterfaceIdiom == .phone ? -50 : 0",
        "            if visible {",
        "                guard scrollView.superview == nil else { return }",
        "                scrollView.addSubview(emptyView)",
        "                NSLayoutConstraint.activate([",
        "                    emptyView.leadingAnchor.constraint(equalTo: scrollView.leadingAnchor),"
      ],
      "context_before": [
        "            let scrollView = self.emptyStateViewA11YScroll",
        "            let emptyView = self.emptyStateView"
      ],
      "context_after": [
        "                    // Ecosia: Update reading list top anchor constant only if iPhone",
        "                    // emptyView.topAnchor.constraint(equalTo: scrollView.topAnchor),"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/Reader/ReaderPanel.swift",
      "line": 302,
      "type": "substitution",
      "comment": "Update reading list top anchor constant only if iPhone",
      "firefox_code": [
        "emptyView.topAnchor.constraint(equalTo: scrollView.topAnchor),"
      ],
      "ecosia_code": [
        "                    emptyView.topAnchor.constraint(equalTo: scrollView.topAnchor, constant: topAnchorDelta),",
        "                    emptyView.widthAnchor.constraint(equalTo: scrollView.widthAnchor),",
        "                    emptyView.heightAnchor.constraint(greaterThanOrEqualTo: scrollView.heightAnchor)",
        "                ])",
        "                self.tableView.superview?.insertSubview(scrollView, aboveSubview: self.tableView)",
        "                scrollView.frame = self.tableView.bounds",
        "                scrollView.autoresizingMask = [.flexibleWidth, .flexibleHeight]",
        "                scrollView.translatesAutoresizingMaskIntoConstraints = true",
        "                scrollView.isScrollEnabled = true",
        "            } else {",
        "                scrollView.subviews.forEach { $0.removeFromSuperview() }",
        "                scrollView.removeFromSuperview()"
      ],
      "context_before": [
        "                NSLayoutConstraint.activate([",
        "                    emptyView.leadingAnchor.constraint(equalTo: scrollView.leadingAnchor),"
      ],
      "context_after": [
        "            }",
        "        }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Library/Reader/ReaderPanel.swift",
      "line": 334,
      "type": "removal",
      "comment": "Update Empty State View reference",
      "firefox_code": [
        "    private lazy var emptyStateView: UIView = {",
        "        return ReaderPanelEmptyStateView(windowUUID: self.windowUUID)",
        "    }()"
      ],
      "ecosia_code": [],
      "context_before": [
        "        EmptyReadingListView(windowUUID: self.windowUUID)",
        "    }()"
      ],
      "context_after": [
        "",
        "    @objc"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Microsurvey/MicrosurveyTelemetry.swift",
      "line": 6,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "import Glean"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "import Foundation"
      ],
      "context_after": [
        "",
        "struct MicrosurveyTelemetry {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Microsurvey/MicrosurveyTelemetry.swift",
      "line": 12,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        let surveyIdExtra = GleanMetrics.Microsurvey.ShownExtra(surveyId: surveyId)",
        "        GleanMetrics.Microsurvey.shown.record(surveyIdExtra)"
      ],
      "ecosia_code": [],
      "context_before": [
        "struct MicrosurveyTelemetry {",
        "    func surveyViewed(surveyId: String) {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Microsurvey/MicrosurveyTelemetry.swift",
      "line": 19,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        let surveyIdExtra = GleanMetrics.Microsurvey.PrivacyNoticeTappedExtra(surveyId: surveyId)",
        "        GleanMetrics.Microsurvey.privacyNoticeTapped.record(surveyIdExtra)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func privacyNoticeTapped(surveyId: String) {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Microsurvey/MicrosurveyTelemetry.swift",
      "line": 26,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        let surveyIdExtra = GleanMetrics.Microsurvey.DismissButtonTappedExtra(surveyId: surveyId)",
        "        GleanMetrics.Microsurvey.dismissButtonTapped.record(surveyIdExtra)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func dismissButtonTapped(surveyId: String) {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Microsurvey/MicrosurveyTelemetry.swift",
      "line": 33,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        let submitExtra = GleanMetrics.Microsurvey.SubmitButtonTappedExtra(surveyId: surveyId, userSelection: userSelection)",
        "        GleanMetrics.Microsurvey.submitButtonTapped.record(submitExtra)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func userResponseSubmitted(surveyId: String, userSelection: String) {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Microsurvey/MicrosurveyTelemetry.swift",
      "line": 40,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        let surveyIdExtra = GleanMetrics.Microsurvey.ConfirmationShownExtra(surveyId: surveyId)",
        "        GleanMetrics.Microsurvey.confirmationShown.record(surveyIdExtra)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func confirmationShown(surveyId: String) {"
      ],
      "context_after": [
        "    }",
        "}"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/ClearPrivateDataTableViewController.swift",
      "line": 108,
      "type": "removal",
      "comment": "Use EcosiaThemedSwitch",
      "firefox_code": [
        "            let control = ThemedSwitch()",
        "            control.applyTheme(theme: currentTheme())"
      ],
      "ecosia_code": [],
      "context_before": [
        "            cell.textLabel?.text = clearables[indexPath.item].clearable.label",
        "            cell.textLabel?.numberOfLines = 0"
      ],
      "context_after": [
        "            let control = EcosiaThemedSwitch()",
        "            /* Ecosia: No need for `onTintColor` with EcosiaThemedSwitch"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/ClearPrivateDataTableViewController.swift",
      "line": 118,
      "type": "addition",
      "comment": "Apply theme only after `isOn` to use correct color",
      "firefox_code": [],
      "ecosia_code": [
        "            control.applyTheme(theme: currentTheme())",
        "            cell.accessoryView = control",
        "            cell.selectionStyle = .none",
        "            control.tag = indexPath.item",
        "            return cell",
        "        } else if let cell = cell as? ThemedCenteredTableViewCell {",
        "            cell.setTitle(to: .SettingsClearPrivateDataClearButton)",
        "            cell.setAccessibilities(",
        "                traits: .button,",
        "                identifier: AccessibilityIdentifiers.Settings.ClearData.clearPrivateDataSection)",
        "            clearButton = cell",
        "            return cell",
        "        } else {",
        "            return ThemedTableViewCell()"
      ],
      "context_before": [
        "            control.addTarget(self, action: #selector(switchValueChanged), for: .valueChanged)",
        "            control.isOn = toggles[indexPath.item]"
      ],
      "context_after": [
        "        }",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/ClearPrivateDataTableViewController.swift",
      "line": 165,
      "type": "addition",
      "comment": "Track \"Clear Private Data\" button click",
      "firefox_code": [],
      "ecosia_code": [
        "            Analytics.shared.clearsDataFromSection(.main)",
        "            let alert: UIAlertController",
        "            if self.toggles[historyClearableIndex] && profile.hasAccount() {",
        "                alert = clearSyncedHistoryAlert(okayCallback: clearPrivateData)",
        "            } else {",
        "                alert = clearPrivateDataAlert(okayCallback: clearPrivateData)"
      ],
      "context_before": [
        "            navigationController?.pushViewController(view, animated: true)",
        "        } else if indexPath.section == sectionButton {"
      ],
      "context_after": [
        "            }",
        "            present(alert, animated: true, completion: nil)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/Clearables.swift",
      "line": 158,
      "type": "addition",
      "comment": "Trigger native logout when cookies are cleared",
      "firefox_code": [],
      "ecosia_code": [
        "        Task {",
        "            await DataClearingIntegration.handleEcosiaAuthCookieClearing()"
      ],
      "context_before": [
        "        )",
        ""
      ],
      "context_after": [
        "        }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/HomepageSettings/HomePageSettingViewController.swift",
      "line": 265,
      "type": "removal",
      "comment": "Override accessibilityIdentifier",
      "firefox_code": [
        "            return AccessibilityIdentifiers.Settings.Homepage.CustomizeFirefox.Shortcuts.settingsPage"
      ],
      "ecosia_code": [],
      "context_before": [
        "        override var accessoryType: UITableViewCell.AccessoryType { return .disclosureIndicator }",
        "        override var accessibilityIdentifier: String? {"
      ],
      "context_after": [
        "            return CustomizableNTPSettingConfig.topSites.accessibilityIdentifierPrefix",
        "        }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/HomepageSettings/HomePageSettingViewController.swift",
      "line": 273,
      "type": "removal",
      "comment": "Update contidion",
      "firefox_code": [
        "            let areShortcutsOn = profile.prefs.boolForKey(PrefsKeys.UserFeatureFlagPrefs.TopSiteSection) ?? true"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "        override var status: NSAttributedString {"
      ],
      "context_after": [
        "            let areShortcutsOn = User.shared.showTopSites",
        "            typealias Shortcuts = String.Settings.Homepage.Shortcuts"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/HomepageSettings/HomePageSettingViewController.swift",
      "line": 285,
      "type": "removal",
      "comment": "rename to Top Sites",
      "firefox_code": [
        "            super.init(title: NSAttributedString(string: .Settings.Homepage.Shortcuts.ShortcutsPageTitle))"
      ],
      "ecosia_code": [],
      "context_before": [
        "            self.profile = settings.profile",
        "            self.windowUUID = settings.windowUUID"
      ],
      "context_after": [
        "            super.init(title: NSAttributedString(string: .localized(.topSites)))",
        "        }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/HomepageSettings/TopSitesSettings/TopSitesSettingsViewController.swift",
      "line": 32,
      "type": "removal",
      "comment": "custom top site setting",
      "firefox_code": [
        "        let topSitesSetting = BoolSetting(",
        "            prefs: profile.prefs,",
        "            theme: themeManager.getCurrentTheme(for: windowUUID),",
        "            prefKey: PrefsKeys.UserFeatureFlagPrefs.TopSiteSection,",
        "            defaultValue: true,",
        "            titleText: .Settings.Homepage.Shortcuts.ShortcutsToggle",
        "        )",
        "        sections.append(topSitesSetting)",
        "        let sponsoredShortcutSetting = BoolSetting(",
        "            prefs: profile.prefs,",
        "            theme: themeManager.getCurrentTheme(for: windowUUID),",
        "            prefKey: PrefsKeys.UserFeatureFlagPrefs.SponsoredShortcuts,",
        "            defaultValue: true,",
        "            titleText: .Settings.Homepage.Shortcuts.SponsoredShortcutsToggle",
        "        )",
        "        sections.append(sponsoredShortcutSetting)"
      ],
      "ecosia_code": [],
      "context_before": [
        "    override func generateSettings() -> [SettingSection] {",
        "        var sections = [Setting]()"
      ],
      "context_after": [
        "        let topSitesSetting = NTPCustomizationSetting(prefs: profile.prefs,",
        "                                                      theme: themeManager.getCurrentTheme(for: windowUUID),"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/Main/AppSettingsTableViewController.swift",
      "line": 68,
      "type": "substitution",
      "comment": "Update TableView to grouped style",
      "firefox_code": [
        "super.init(windowUUID: tabManager.windowUUID)"
      ],
      "ecosia_code": [
        "        super.init(style: .insetGrouped, windowUUID: tabManager.windowUUID)"
      ],
      "context_before": [
        "        self.applicationHelper = applicationHelper",
        ""
      ],
      "context_after": [
        "",
        "        self.profile = profile"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/Main/AppSettingsTableViewController.swift",
      "line": 90,
      "type": "addition",
      "comment": "Register Nudge Card if needed",
      "firefox_code": [],
      "ecosia_code": [
        "        if User.shared.shouldShowDefaultBrowserSettingNudgeCard {",
        "            tableView.register(DefaultBrowserSettingsNudgeCardHeaderView.self,",
        "                               forHeaderFooterViewReuseIdentifier: DefaultBrowserSettingsNudgeCardHeaderView.cellIdentifier)"
      ],
      "context_before": [
        "        configureAccessibilityIdentifiers()",
        ""
      ],
      "context_after": [
        "        }",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/Main/AppSettingsTableViewController.swift",
      "line": 97,
      "type": "removal",
      "comment": "Move settings reload to `viewWillAppear`",
      "firefox_code": [
        "    override func viewDidAppear(_ animated: Bool) {",
        "        super.viewDidAppear(animated)",
        "        askedToReload()",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "    override func viewWillAppear(_ animated: Bool) {",
        "        super.viewWillAppear(animated)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/Main/AppSettingsTableViewController.swift",
      "line": 230,
      "type": "removal",
      "comment": "Review Settings",
      "firefox_code": [
        "        var settings = [SettingSection]()",
        "        settings += getDefaultBrowserSetting()",
        "        settings += getAccountSetting()",
        "        settings += getGeneralSettings()",
        "        settings += getPrivacySettings()",
        "        settings += getSupportSettings()",
        "        settings += getAboutSettings()",
        "        if showDebugSettings {",
        "            settings += getDebugSettings()",
        "        }",
        "        return settings"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    override func generateSettings() -> [SettingSection] {"
      ],
      "context_after": [
        "        getEcosiaSettingsSectionsShowingDebug(showDebugSettings)",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/Main/AppSettingsTableViewController.swift",
      "line": 499,
      "type": "removal",
      "comment": "Set the header view for the table view with custom handling for the default browser nudge card",
      "firefox_code": [
        "       Adds other overrides after this one to modify the UI logic",
        "    override func tableView(_ tableView: UITableView, viewForHeaderInSection section: Int) -> UIView? {",
        "        let headerView = super.tableView(",
        "            tableView,",
        "            viewForHeaderInSection: section",
        "        ) as! ThemedTableSectionHeaderFooterView",
        "        return headerView",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "    // MARK: - UITableViewDelegate",
        ""
      ],
      "context_after": [
        "    override func tableView(_ tableView: UITableView, viewForHeaderInSection section: Int) -> UIView? {",
        "        if shouldShowDefaultBrowserNudgeCardInSection(section),"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/Main/Debug/OpenFiftyTabsDebugOption.swift",
      "line": 18,
      "type": "removal",
      "comment": "Update Debug message",
      "firefox_code": [
        "        return NSAttributedString(",
        "            string: \"Open 50 `mozilla.org` tabs âš ï¸\",",
        "            attributes: [NSAttributedString.Key.foregroundColor: theme.colors.textPrimary]",
        "        )"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    override var title: NSAttributedString? {"
      ],
      "context_after": [
        "        return NSAttributedString(",
        "            string: \"Open 50 `ecosia.org` tabs âš ï¸\","
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/Main/Privacy/ContentBlockerSetting.swift",
      "line": 19,
      "type": "removal",
      "comment": "Remove `status` as there is a UI issue in showing the content in e.g. German",
      "firefox_code": [
        "    override var status: NSAttributedString? {",
        "        let defaultValue = ContentBlockingConfig.Defaults.NormalBrowsing",
        "        let isOn = profile.prefs.boolForKey(ContentBlockingConfig.Prefs.EnabledKey) ?? defaultValue",
        "        if isOn {",
        "            let currentBlockingStrength = profile",
        "                .prefs",
        "                .stringForKey(ContentBlockingConfig.Prefs.StrengthKey)",
        "                .flatMap(BlockingStrength.init(rawValue:)) ?? .basic",
        "            return NSAttributedString(string: currentBlockingStrength.settingStatus)",
        "        } else {",
        "            return NSAttributedString(string: .Settings.Homepage.Shortcuts.ToggleOff)",
        "        }",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "        return AccessibilityIdentifiers.Settings.ContentBlocker.title",
        "    }"
      ],
      "context_after": [
        "",
        "    override var style: UITableViewCell.CellStyle { return .value1 }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/Main/SettingDisclosureUtility.swift",
      "line": 11,
      "type": "removal",
      "comment": "Custom chevron disclosure indicator",
      "firefox_code": [
        "        let disclosureIndicator = UIImageView()",
        "        disclosureIndicator.image = UIImage(",
        "            named: StandardImageIdentifiers.Large.chevronRight",
        "        )?.withRenderingMode(.alwaysTemplate).imageFlippedForRightToLeftLayoutDirection()",
        "        disclosureIndicator.tintColor = theme.colors.iconSecondary",
        "        disclosureIndicator.sizeToFit()",
        "        disclosureIndicator.adjustsImageSizeForAccessibilityContentSizeCategory = true",
        "        return disclosureIndicator"
      ],
      "ecosia_code": [],
      "context_before": [
        "struct SettingDisclosureUtility {",
        "    static func buildDisclosureIndicator(theme: Theme) -> UIImageView {"
      ],
      "context_after": [
        "        ecosiaDisclosureIndicator(theme: theme)",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/SearchBar/SearchBarSettingsViewModel.swift",
      "line": 45,
      "type": "removal",
      "comment": "Search Bar stays on top by default",
      "firefox_code": [
        "            return .bottom"
      ],
      "ecosia_code": [],
      "context_before": [
        "    var searchBarPosition: SearchBarPosition {",
        "        guard let position: SearchBarPosition = featureFlags.getCustomState(for: .searchBarPosition) else {"
      ],
      "context_after": [
        "            return .top",
        "        }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/SearchBar/SearchBarSettingsViewModel.swift",
      "line": 113,
      "type": "addition",
      "comment": "Track toolbar position change",
      "firefox_code": [],
      "ecosia_code": [
        "        Analytics.shared.searchbarChanged(to: searchBarPosition.rawValue)"
      ],
      "context_before": [
        "        notificationCenter.post(name: .SearchBarPositionDidChange, withObject: notificationObject)",
        ""
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/SearchSettingsTableViewController.swift",
      "line": 154,
      "type": "removal",
      "comment": "Remove UI that let User indicate a detail scren",
      "firefox_code": [
        "                cell.editingAccessoryType = .disclosureIndicator"
      ],
      "ecosia_code": [],
      "context_before": [
        "        case .defaultEngine:",
        "                engine = model.defaultEngine"
      ],
      "context_after": [
        "                cell.accessibilityLabel = .Settings.Search.AccessibilityLabels.DefaultSearchEngine",
        "                cell.accessibilityValue = engine.shortName"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/SearchSettingsTableViewController.swift",
      "line": 373,
      "type": "removal",
      "comment": "Hide possibility to show Default Engine selection screen",
      "firefox_code": [
        "            let searchEnginePicker = SearchEnginePicker(windowUUID: windowUUID)",
        "            // Order alphabetically, so that picker is always consistently ordered.",
        "            // Every engine is a valid choice for the default engine, even the current default engine.",
        "            searchEnginePicker.engines = model.orderedEngines.sorted { e, f in e.shortName < f.shortName }",
        "            searchEnginePicker.delegate = self",
        "            searchEnginePicker.selectedSearchEngineName = model.defaultEngine?.shortName",
        "            navigationController?.pushViewController(searchEnginePicker, animated: true)"
      ],
      "ecosia_code": [],
      "context_before": [
        "        case .defaultEngine:",
        "            guard indexPath.item == 0 else { return nil }"
      ],
      "context_after": [
        "            tableView.deselectRow(at: indexPath, animated: false)",
        "        case .alternateEngines:"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/SettingsNavigationController.swift",
      "line": 55,
      "type": "addition",
      "comment": "Define `largeTitleTextAttributes` as done for ThemedDefaultNavigationController utilized in Widgets",
      "firefox_code": [],
      "ecosia_code": [
        "        standardAppearance.largeTitleTextAttributes = [.foregroundColor: theme.colors.textPrimary]",
        "        standardAppearance.titleTextAttributes = [.foregroundColor: theme.colors.textPrimary]"
      ],
      "context_before": [
        "        standardAppearance.configureWithDefaultBackground()",
        "        standardAppearance.backgroundColor = theme.colors.layer1"
      ],
      "context_after": [
        "",
        "        // Ecosia: Update navigationBar properties"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/SettingsNavigationController.swift",
      "line": 59,
      "type": "addition",
      "comment": "Update navigationBar properties",
      "firefox_code": [],
      "ecosia_code": [
        "        navigationBar.setBackgroundImage(UIImage(), for: .default)",
        "        standardAppearance.shadowImage = .init()",
        "        standardAppearance.shadowColor = nil",
        "        navigationBar.prefersLargeTitles = true"
      ],
      "context_before": [
        "        standardAppearance.titleTextAttributes = [.foregroundColor: theme.colors.textPrimary]",
        ""
      ],
      "context_after": [
        "",
        "        navigationBar.standardAppearance = standardAppearance"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/SettingsTableViewController.swift",
      "line": 105,
      "type": "addition",
      "comment": "Update identifier",
      "firefox_code": [],
      "ecosia_code": [
        "        if let accessibilityIdentifier {",
        "            cell.textLabel?.accessibilityIdentifier = \"\\(accessibilityIdentifier)_title\"",
        "            cell.detailTextLabel?.accessibilityIdentifier = \"\\(accessibilityIdentifier)_detail\"",
        "            cell.imageView?.accessibilityIdentifier = \"\\(accessibilityIdentifier)_image\""
      ],
      "context_before": [
        "        cell.imageView?.image = _image",
        ""
      ],
      "context_after": [
        "        }",
        "        if let title = title?.string {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/SettingsTableViewController.swift",
      "line": 197,
      "type": "removal",
      "comment": "Use themed Switch",
      "firefox_code": [
        "    let switchView: UISwitch"
      ],
      "ecosia_code": [],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "    let switchView: EcosiaThemedSwitch",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/SettingsTableViewController.swift",
      "line": 203,
      "type": "removal",
      "comment": "Use themed Switch",
      "firefox_code": [
        "        self.switchView = UISwitch()"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    init() {"
      ],
      "context_after": [
        "        self.switchView = EcosiaThemedSwitch()",
        "        super.init(frame: .zero)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/SettingsTableViewController.swift",
      "line": 251,
      "type": "addition",
      "comment": "Add accessibility identifier",
      "firefox_code": [],
      "ecosia_code": [
        "        accessibilityIdentifier: String? = nil,",
        "        defaultValue: Bool?,",
        "        attributedTitleText: NSAttributedString,",
        "        attributedStatusText: NSAttributedString? = nil,",
        "        featureFlagName: NimbusFeatureFlagID? = nil,",
        "        settingDidChange: ((Bool) -> Void)? = nil",
        "    ) {",
        "        self.prefs = prefs",
        "        self.prefKey = prefKey",
        "        self.defaultValue = defaultValue",
        "        self.settingDidChange = settingDidChange",
        "        self.statusText = attributedStatusText",
        "        self.featureFlagName = featureFlagName",
        "        super.init(title: attributedTitleText)"
      ],
      "context_before": [
        "        prefs: Prefs?,",
        "        prefKey: String? = nil,"
      ],
      "context_after": [
        "        // Ecosia: Add accessibility identifier",
        "        self.accessibilityIdentifier = accessibilityIdentifier"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/SettingsTableViewController.swift",
      "line": 266,
      "type": "addition",
      "comment": "Add accessibility identifier",
      "firefox_code": [],
      "ecosia_code": [
        "        self.accessibilityIdentifier = accessibilityIdentifier"
      ],
      "context_before": [
        "        self.featureFlagName = featureFlagName",
        "        super.init(title: attributedTitleText)"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/SettingsTableViewController.swift",
      "line": 274,
      "type": "addition",
      "comment": "Add accessibility identifier",
      "firefox_code": [],
      "ecosia_code": [
        "        accessibilityIdentifier: String? = nil,",
        "        defaultValue: Bool,",
        "        titleText: String,",
        "        statusText: String? = nil,",
        "        settingDidChange: ((Bool) -> Void)? = nil",
        "    ) {",
        "        var statusTextAttributedString: NSAttributedString?",
        "        if let statusTextString = statusText {",
        "            let attributes = [NSAttributedString.Key.foregroundColor: theme.colors.textSecondary]",
        "            statusTextAttributedString = NSAttributedString(string: statusTextString,",
        "                                                            attributes: attributes)"
      ],
      "context_before": [
        "        theme: Theme,",
        "        prefKey: String? = nil,"
      ],
      "context_after": [
        "        }",
        "        self.init("
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/SettingsTableViewController.swift",
      "line": 290,
      "type": "addition",
      "comment": "Add accessibility identifier",
      "firefox_code": [],
      "ecosia_code": [
        "            accessibilityIdentifier: accessibilityIdentifier,",
        "            defaultValue: defaultValue,",
        "            attributedTitleText: NSAttributedString(",
        "                string: titleText,",
        "                attributes: [NSAttributedString.Key.foregroundColor: theme.colors.textPrimary]),",
        "            attributedStatusText: statusTextAttributedString,",
        "            settingDidChange: settingDidChange)"
      ],
      "context_before": [
        "            prefs: prefs,",
        "            prefKey: prefKey,"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/SettingsTableViewController.swift",
      "line": 340,
      "type": "removal",
      "comment": "Update identifier",
      "firefox_code": [
        "        control.switchView.accessibilityIdentifier = prefKey"
      ],
      "ecosia_code": [],
      "context_before": [
        "    public lazy var control: PaddedSwitch = {",
        "        let control = PaddedSwitch()"
      ],
      "context_after": [
        "        if let accessibilityIdentifier {",
        "            control.accessibilityIdentifier = \"\\(accessibilityIdentifier)_switch\""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/SettingsTableViewController.swift",
      "line": 358,
      "type": "addition",
      "comment": "Apply Switch theme when cell is configured (triggered on theme change)",
      "firefox_code": [],
      "ecosia_code": [
        "        control.switchView.applyTheme(theme: theme)"
      ],
      "context_before": [
        "        )",
        ""
      ],
      "context_after": [
        "",
        "        displayBool(control.switchView)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/SettingsTableViewController.swift",
      "line": 910,
      "type": "addition",
      "comment": "Reload after ntp customization changes",
      "firefox_code": [],
      "ecosia_code": [
        "    func reloadHomepage()"
      ],
      "context_before": [
        "    func settingsOpenURLInNewTab(_ url: URL)",
        "    func didFinish()"
      ],
      "context_after": [
        "}",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/ThemeSettings/ThemeSettingsController.swift",
      "line": 240,
      "type": "removal",
      "comment": "Use EcosiaThemedSwitch",
      "firefox_code": [
        "            let control = ThemedSwitch()",
        "            control.applyTheme(theme: theme)"
      ],
      "ecosia_code": [],
      "context_before": [
        "            cell.textLabel?.lineBreakMode = .byWordWrapping",
        ""
      ],
      "context_after": [
        "            let control = EcosiaThemedSwitch()",
        "            control.accessibilityIdentifier = \"SystemThemeSwitchValue\""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/ThemeSettings/ThemeSettingsController.swift",
      "line": 246,
      "type": "removal",
      "comment": "No need for `onTintColor` with EcosiaThemedSwitch",
      "firefox_code": [
        "            control.onTintColor = theme.colors.actionPrimary"
      ],
      "ecosia_code": [],
      "context_before": [
        "            let control = EcosiaThemedSwitch()",
        "            control.accessibilityIdentifier = \"SystemThemeSwitchValue\""
      ],
      "context_after": [
        "            control.addTarget(self, action: #selector(systemThemeSwitchValueChanged), for: .valueChanged)",
        "            control.isOn = themeState.useSystemAppearance"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/ThemeSettings/ThemeSettingsController.swift",
      "line": 251,
      "type": "addition",
      "comment": "Apply theme only after `isOn` to use correct color",
      "firefox_code": [],
      "ecosia_code": [
        "            control.applyTheme(theme: theme)"
      ],
      "context_before": [
        "            control.addTarget(self, action: #selector(systemThemeSwitchValueChanged), for: .valueChanged)",
        "            control.isOn = themeState.useSystemAppearance"
      ],
      "context_after": [
        "",
        "            cell.accessoryView = control"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Settings/WebsiteDataManagement/WebsiteDataManagementViewController.swift",
      "line": 259,
      "type": "addition",
      "comment": "Track \"Clear Private Data\" button click",
      "firefox_code": [],
      "ecosia_code": [
        "            Analytics.shared.clearsDataFromSection(.websites)",
        "            let generator = UIImpactFeedbackGenerator(style: .heavy)",
        "            generator.impactOccurred()",
        "            let alert = viewModel.createAlertToRemove()",
        "            present(alert, animated: true, completion: nil)",
        "            tableView.deselectRow(at: indexPath, animated: true)"
      ],
      "context_before": [
        "            tableView.reloadData()",
        "        case .clearButton:"
      ],
      "context_after": [
        "        }",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Theme/ThemedTableViewCells/ThemedTableViewCell.swift",
      "line": 16,
      "type": "addition",
      "comment": "adjust layout margins",
      "firefox_code": [],
      "ecosia_code": [
        "        contentView.directionalLayoutMargins.leading = 16"
      ],
      "context_before": [
        "        self.cellStyle = style",
        "        super.init(style: style, reuseIdentifier: reuseIdentifier)"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Theme/ThemedTableViewCells/ThemedTableViewCell.swift",
      "line": 78,
      "type": "substitution",
      "comment": "Update background color",
      "firefox_code": [
        "backgroundColor = viewModel?.backgroundColor ?? theme.colors.layer5"
      ],
      "ecosia_code": [
        "        backgroundColor = viewModel?.backgroundColor ?? theme.colors.ecosia.backgroundElevation1",
        "        tintColor = viewModel?.tintColor ?? theme.colors.actionPrimary"
      ],
      "context_before": [
        "        textLabel?.textColor = viewModel?.textColor ?? theme.colors.textPrimary",
        "        detailTextLabel?.textColor = viewModel?.detailTextColor ?? theme.colors.textSecondary"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/LockButton.swift",
      "line": 43,
      "type": "addition",
      "comment": "Remove trailing image insets",
      "firefox_code": [],
      "ecosia_code": [
        "        configuration?.contentInsets = .init(top: 0, leading: 10, bottom: 0, trailing: 0)"
      ],
      "context_before": [
        "        imageView?.contentMode = .scaleAspectFill",
        "        configuration = .plain()"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/LockButton.swift",
      "line": 57,
      "type": "removal",
      "comment": "Set same tint as selected state",
      "firefox_code": [
        "        unselectedTintColor = theme.colors.textPrimary"
      ],
      "ecosia_code": [],
      "context_before": [
        "        selectedTintColor = theme.colors.actionPrimary",
        "        disabledTintColor = theme.colors.iconDisabled"
      ],
      "context_after": [
        "        unselectedTintColor = theme.colors.actionPrimary",
        "        tintColor = isEnabled ? unselectedTintColor : disabledTintColor"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/OverlayModeManager.swift",
      "line": 47,
      "type": "addition",
      "comment": "Add override to manage the overlay mode in case of other pages being shown",
      "firefox_code": [],
      "ecosia_code": [
        "    var overrideShouldEnterOverlayMode: Bool?",
        "    private var urlBarView: URLBarViewProtocol?"
      ],
      "context_before": [
        "",
        "class DefaultOverlayModeManager: OverlayModeManager {"
      ],
      "context_after": [
        "",
        "    var inOverlayMode: Bool {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/OverlayModeManager.swift",
      "line": 87,
      "type": "addition",
      "comment": "Add override to manage the overlay mode in case of other pages being shown",
      "firefox_code": [],
      "ecosia_code": [
        "        guard overrideShouldEnterOverlayMode == nil else {",
        "            return overrideShouldEnterOverlayMode!"
      ],
      "context_before": [
        "",
        "    private func shouldEnterOverlay(for url: URL?, newTabSettings: NewTabPage) -> Bool {"
      ],
      "context_after": [
        "        }",
        "        // The NewTabPage cases are weird topSites = homepage"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/TabLocationContainerView.swift",
      "line": 11,
      "type": "substitution",
      "comment": "Update `CornerRadius`",
      "firefox_code": [
        "static let CornerRadius: CGFloat = 8"
      ],
      "ecosia_code": [
        "        static let CornerRadius: CGFloat = 22"
      ],
      "context_before": [
        "class TabLocationContainerView: UIView {",
        "    private struct LocationContainerUX {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/TabToolbar.swift",
      "line": 15,
      "type": "removal",
      "comment": "Change `addNewTabButton` to configurable CircleButton",
      "firefox_code": [
        "    let addNewTabButton = ToolbarButton()"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    let tabsButton = TabsButton()"
      ],
      "context_after": [
        "    let circleButton = CircleButton(config: .search)",
        "    let appMenuButton = ToolbarButton()"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/TabToolbar.swift",
      "line": 38,
      "type": "substitution",
      "comment": "Update toolbar search button",
      "firefox_code": [
        "actionButtons = [backButton, forwardButton, multiStateButton, circleButton, tabsButton, appMenuButton]"
      ],
      "ecosia_code": [
        "        actionButtons = [backButton, forwardButton, circleButton, tabsButton, appMenuButton]",
        "        super.init(frame: frame)",
        "        setupAccessibility()"
      ],
      "context_before": [
        "    // MARK: - Initializers",
        "    override private init(frame: CGRect) {"
      ],
      "context_after": [
        "",
        "        addSubview(contentView)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/TabToolbar.swift",
      "line": 48,
      "type": "substitution",
      "comment": "Remove private mode badge",
      "firefox_code": [
        "privateModeBadge.add(toParent: contentView)"
      ],
      "ecosia_code": [
        "        warningMenuBadge.add(toParent: contentView)"
      ],
      "context_before": [
        "        addButtons(actionButtons)",
        ""
      ],
      "context_after": [
        "",
        "        contentView.axis = .horizontal"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/TabToolbar.swift",
      "line": 64,
      "type": "substitution",
      "comment": "Remove private mode badge",
      "firefox_code": [
        "privateModeBadge.layout(onButton: tabsButton)"
      ],
      "ecosia_code": [
        "        warningMenuBadge.layout(onButton: appMenuButton)"
      ],
      "context_before": [
        "",
        "    override func updateConstraints() {"
      ],
      "context_after": [
        "",
        "        NSLayoutConstraint.activate(["
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/TabToolbar.swift",
      "line": 113,
      "type": "substitution",
      "comment": "Remove private mode badge",
      "firefox_code": [
        "privateModeBadge.show(visible)"
      ],
      "ecosia_code": [
        "    }"
      ],
      "context_before": [
        "extension TabToolbar: TabToolbarProtocol {",
        "    func privateModeBadge(visible: Bool) {"
      ],
      "context_after": [
        "",
        "    func warningMenuBadge(setVisible: Bool) {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/TabToolbar.swift",
      "line": 149,
      "type": "removal",
      "comment": "Update theme colors",
      "firefox_code": [
        "        backgroundColor = theme.colors.layer1"
      ],
      "ecosia_code": [],
      "context_before": [
        "extension TabToolbar: ThemeApplicable, PrivateModeUI {",
        "    func applyTheme(theme: Theme) {"
      ],
      "context_after": [
        "        backgroundColor = theme.colors.ecosia.backgroundPrimary",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/TabToolbar.swift",
      "line": 156,
      "type": "addition",
      "comment": "Badges are not used",
      "firefox_code": [],
      "ecosia_code": [
        "        privateModeBadge.badge.tintBackground(color: theme.colors.layer1)",
        "        warningMenuBadge.badge.tintBackground(color: theme.colors.layer1)"
      ],
      "context_before": [
        "        actionButtons.forEach { $0.applyTheme(theme: theme) }",
        ""
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/TabToolbar.swift",
      "line": 162,
      "type": "substitution",
      "comment": "Remove private mode badge",
      "firefox_code": [
        "privateModeBadge(visible: isPrivate)"
      ],
      "ecosia_code": [
        "    }"
      ],
      "context_before": [
        "",
        "    func applyUIMode(isPrivate: Bool, theme: Theme) {"
      ],
      "context_after": [
        "}"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/TabToolbarHelper.swift",
      "line": 11,
      "type": "removal",
      "comment": "Change `addNewTabButton` to configurable CircleButton",
      "firefox_code": [
        "    var addNewTabButton: ToolbarButton { get }"
      ],
      "ecosia_code": [],
      "context_before": [
        "protocol TabToolbarProtocol: AnyObject {",
        "    var tabToolbarDelegate: TabToolbarDelegate? { get set }"
      ],
      "context_after": [
        "    var circleButton: CircleButton { get }",
        "    var tabsButton: TabsButton { get }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/TabToolbarHelper.swift",
      "line": 58,
      "type": "removal",
      "comment": "Updates images in batch.",
      "firefox_code": [
        "       Some of them are the same but easier to solve when rebasing/merging",
        "    let ImageSearch = UIImage.templateImageNamed(StandardImageIdentifiers.Large.search)",
        "    let ImageNewTab = UIImage.templateImageNamed(StandardImageIdentifiers.Large.plus)",
        "    let ImageHome = UIImage.templateImageNamed(StandardImageIdentifiers.Large.home)"
      ],
      "ecosia_code": [],
      "context_before": [
        "open class TabToolbarHelper: NSObject {",
        "    let toolbar: TabToolbarProtocol"
      ],
      "context_after": [
        "    let ImageSearch = UIImage.templateImageNamed(\"searchUrl\")",
        "    let ImageNewTab = UIImage.templateImageNamed(\"nav-add\")"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/TabToolbarHelper.swift",
      "line": 154,
      "type": "removal",
      "comment": "Change `addNewTabButton` to configurable CircleButton",
      "firefox_code": [
        "        toolbar.addNewTabButton.setImage(UIImage.templateImageNamed(StandardImageIdentifiers.Large.plus), for: .normal)",
        "        toolbar.addNewTabButton.accessibilityLabel = .AddTabAccessibilityLabel",
        "        toolbar.addNewTabButton.showsLargeContentViewer = true",
        "        toolbar.addNewTabButton.largeContentTitle = .AddTabAccessibilityLabel",
        "        toolbar.addNewTabButton.addTarget(self, action: #selector(didClickAddNewTab), for: .touchUpInside)",
        "        toolbar.addNewTabButton.accessibilityIdentifier = AccessibilityIdentifiers.Toolbar.addNewTabButton"
      ],
      "ecosia_code": [],
      "context_before": [
        "        longPressGestureRecognizers.append(longPressGestureTabsButton)",
        ""
      ],
      "context_after": [
        "        toolbar.circleButton.accessibilityLabel = .AddTabAccessibilityLabel",
        "        toolbar.circleButton.addTarget(self, action: #selector(didClickCircleButton), for: .touchUpInside)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/TabToolbarHelper.swift",
      "line": 249,
      "type": "removal",
      "comment": "Change `addNewTabButton` to configurable CircleButton",
      "firefox_code": [
        "    func didClickAddNewTab() {",
        "        TelemetryWrapper.recordEvent(category: .action, method: .tap, object: .addNewTabButton)",
        "        toolbar.tabToolbarDelegate?.tabToolbarDidPressAddNewTab(toolbar, button: toolbar.addNewTabButton)",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "",
        "    func didPressMultiStateButton() {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/TabToolbarHelper.swift",
      "line": 268,
      "type": "addition",
      "comment": "Change addNewTabButton to configurable CircleButton",
      "firefox_code": [],
      "ecosia_code": [
        "    func didClickCircleButton() {",
        "        switch toolbar.circleButton.config {",
        "        case .search:",
        "            TelemetryWrapper.recordEvent(category: .action, method: .tap, object: .startSearchButton)",
        "            toolbar.tabToolbarDelegate?.tabToolbarDidPressSearch(toolbar, button: toolbar.circleButton)",
        "        case .newTab:",
        "            TelemetryWrapper.recordEvent(category: .action, method: .tap, object: .addNewTabButton)",
        "            toolbar.tabToolbarDelegate?.tabToolbarDidPressAddNewTab(toolbar, button: toolbar.circleButton)"
      ],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "        }",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/ToolbarButton.swift",
      "line": 9,
      "type": "removal",
      "comment": "Update ToolbarButton to allow ThemeApplicable",
      "firefox_code": [
        "   functions to be overridden",
        "class ToolbarButton: UIButton {"
      ],
      "ecosia_code": [],
      "context_before": [
        "import Shared",
        ""
      ],
      "context_after": [
        "class ToolbarButton: UIButton, ThemeApplicable {",
        "    // MARK: - Variables"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/ToolbarButton.swift",
      "line": 16,
      "type": "substitution",
      "comment": "Modify accessors",
      "firefox_code": [
        "private var selectedTintColor: UIColor!",
        "private var unselectedTintColor: UIColor!"
      ],
      "ecosia_code": [
        "    var selectedTintColor: UIColor!",
        "    var unselectedTintColor: UIColor!",
        "    private var disabledTintColor: UIColor!"
      ],
      "context_before": [
        "    // MARK: - Variables",
        ""
      ],
      "context_after": [
        "",
        "    // Optionally can associate a separator line that hide/shows along with the button"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/ToolbarButton.swift",
      "line": 63,
      "type": "removal",
      "comment": "Update ToolbarButton to allow ThemeApplicable",
      "firefox_code": [
        "       functions to be overridden",
        "}",
        "// MARK: - Theme protocols",
        "extension ToolbarButton: ThemeApplicable {",
        "    func applyTheme(theme: Theme) {",
        "        selectedTintColor = theme.colors.actionPrimary",
        "        disabledTintColor = theme.colors.iconDisabled",
        "        unselectedTintColor = theme.colors.iconPrimary",
        "        tintColor = isEnabled ? unselectedTintColor : disabledTintColor",
        "        imageView?.tintColor = tintColor",
        "    }",
        "}"
      ],
      "ecosia_code": [],
      "context_before": [
        "        fatalError(\"init(coder:) has not been implemented\")",
        "    }"
      ],
      "context_after": [
        "    // MARK: - Theme protocols",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/ToolbarButton.swift",
      "line": 82,
      "type": "removal",
      "comment": "Update colors",
      "firefox_code": [
        "        selectedTintColor = theme.colors.actionPrimary",
        "        disabledTintColor = theme.colors.iconDisabled"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func applyTheme(theme: Theme) {"
      ],
      "context_after": [
        "        selectedTintColor = theme.colors.ecosia.brandPrimary",
        "        disabledTintColor = UIColor.Photon.Grey30"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/ToolbarButton.swift",
      "line": 90,
      "type": "substitution",
      "comment": "Unneded as set in didSet{} accessor",
      "firefox_code": [
        "imageView?.tintColor = tintColor"
      ],
      "ecosia_code": [
        "    }"
      ],
      "context_before": [
        "        unselectedTintColor = theme.colors.iconPrimary",
        "        tintColor = isEnabled ? unselectedTintColor : disabledTintColor"
      ],
      "context_after": [
        "}"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 17,
      "type": "substitution",
      "comment": "Update Corner Radius",
      "firefox_code": [
        "static let TextFieldCornerRadius: CGFloat = 8"
      ],
      "ecosia_code": [
        "    static let TextFieldCornerRadius: CGFloat = 22",
        "    static let TextFieldBorderWidth: CGFloat = 0"
      ],
      "context_before": [
        "    static let ButtonHeight: CGFloat = 44",
        "    static let LocationContentOffset: CGFloat = 8"
      ],
      "context_after": [
        "    // Ecosia: Update Border width in selected state",
        "    // static let TextFieldBorderWidthSelected: CGFloat = 4"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 21,
      "type": "substitution",
      "comment": "Update Border width in selected state",
      "firefox_code": [
        "static let TextFieldBorderWidthSelected: CGFloat = 4"
      ],
      "ecosia_code": [
        "    static let TextFieldBorderWidthSelected: CGFloat = 2",
        "    static let ProgressBarHeight: CGFloat = 3"
      ],
      "context_before": [
        "    static let TextFieldCornerRadius: CGFloat = 22",
        "    static let TextFieldBorderWidth: CGFloat = 0"
      ],
      "context_after": [
        "    // Ecosia: Update search icon size",
        "    static let SearchIconWidthSmall: CGFloat = 16"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 25,
      "type": "addition",
      "comment": "Update search icon size",
      "firefox_code": [],
      "ecosia_code": [
        "    static let SearchIconWidthSmall: CGFloat = 16",
        "    static let SearchIconWidthMedium: CGFloat = 24",
        "    static let TabsButtonRotationOffset: CGFloat = 1.5",
        "    static let TabsButtonHeight: CGFloat = 18.0",
        "    static let ToolbarButtonInsets = UIEdgeInsets(equalInset: Padding)",
        "    static let urlBarLineHeight = 0.5"
      ],
      "context_before": [
        "    static let TextFieldBorderWidthSelected: CGFloat = 2",
        "    static let ProgressBarHeight: CGFloat = 3"
      ],
      "context_after": [
        "}",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 124,
      "type": "addition",
      "comment": "Helper flags",
      "firefox_code": [],
      "ecosia_code": [
        "    var isPrivate = false",
        "    var isHome: Bool {",
        "        guard let url = currentURL else { return true }",
        "        return InternalURL(url)?.isAboutHomeURL == true"
      ],
      "context_before": [
        "    var inOverlayMode = false",
        ""
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 136,
      "type": "addition",
      "comment": "Update LocationView properties",
      "firefox_code": [],
      "ecosia_code": [
        "        locationView.layer.masksToBounds = true",
        "        locationView.clipsToBounds = true",
        "        return locationView",
        "    }()"
      ],
      "context_before": [
        "        locationView.translatesAutoresizingMaskIntoConstraints = false",
        "        locationView.delegate = self"
      ],
      "context_after": [
        "",
        "    lazy var locationContainer: UIView = {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 184,
      "type": "removal",
      "comment": "Update QR Code image",
      "firefox_code": [
        "        let qrCodeImage = UIImage.templateImageNamed(StandardImageIdentifiers.Large.qrCode)",
        "        button.setImage(qrCodeImage, for: .normal)"
      ],
      "ecosia_code": [],
      "context_before": [
        "    fileprivate lazy var showQRScannerButton: InsetButton = {",
        "        let button = InsetButton()"
      ],
      "context_after": [
        "        let qrCodeImage = UIImage.templateImageNamed(\"menu-ScanQRCode\")",
        "        button.setImage(qrCodeImage, for: .normal)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 224,
      "type": "removal",
      "comment": "Change `addNewTabButton` to configurable CircleButton",
      "firefox_code": [
        "    var addNewTabButton = ToolbarButton()"
      ],
      "ecosia_code": [],
      "context_before": [
        "    var appMenuButton = ToolbarButton()",
        "    var bookmarksButton = ToolbarButton()"
      ],
      "context_after": [
        "    var circleButton = CircleButton(config: .search)",
        "    var forwardButton = ToolbarButton()"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 252,
      "type": "removal",
      "comment": "Change setter to update URL accordingly",
      "firefox_code": [
        "            locationView.url = newURL"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "        set(newURL) {"
      ],
      "context_after": [
        "            var updatedUrl = newURL",
        "            // Ecosia: Ecosify if needed"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 261,
      "type": "addition",
      "comment": "Update constraints if needed",
      "firefox_code": [],
      "ecosia_code": [
        "            if !inOverlayMode {",
        "                setNeedsUpdateConstraints()"
      ],
      "context_before": [
        "            }",
        "            locationView.url = updatedUrl"
      ],
      "context_after": [
        "            }",
        "        }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 271,
      "type": "removal",
      "comment": "Remove private mode badge",
      "firefox_code": [
        "    fileprivate lazy var privateModeBadge = BadgeWithBackdrop(",
        "        imageName: StandardImageIdentifiers.Medium.privateModeCircleFillPurple,",
        "        isPrivateBadge: true",
        "    )"
      ],
      "ecosia_code": [],
      "context_before": [
        "    let windowUUID: WindowUUID",
        ""
      ],
      "context_after": [
        "",
        "    fileprivate let warningMenuBadge = BadgeWithBackdrop("
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 305,
      "type": "addition",
      "comment": "Do not update if private mode enabled",
      "firefox_code": [],
      "ecosia_code": [
        "        guard isPrivate == false else { return }"
      ],
      "context_before": [
        "        )",
        ""
      ],
      "context_after": [
        "",
        "        self.searchIconImageView.image = profile.searchEnginesManager.defaultEngine?.image"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 325,
      "type": "removal",
      "comment": "Change `addNewTabButton` to configurable CircleButton",
      "firefox_code": [
        "            addNewTabButton,"
      ],
      "ecosia_code": [],
      "context_before": [
        "            bookmarksButton,",
        "            appMenuButton,"
      ],
      "context_after": [
        "            circleButton,",
        "            forwardButton,"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 338,
      "type": "addition",
      "comment": "ProgressBar sits at the back of the LocationView",
      "firefox_code": [],
      "ecosia_code": [
        "        locationView.addSubview(progressBar)",
        "        locationView.sendSubviewToBack(progressBar)"
      ],
      "context_before": [
        "        }",
        ""
      ],
      "context_after": [
        "",
        "        profile.searchEnginesManager.delegate = self"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 344,
      "type": "removal",
      "comment": "Remove private mode badge",
      "firefox_code": [
        "        privateModeBadge.add(toParent: self)"
      ],
      "ecosia_code": [],
      "context_before": [
        "        profile.searchEnginesManager.delegate = self",
        ""
      ],
      "context_after": [
        "        warningMenuBadge.add(toParent: self)",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 362,
      "type": "addition",
      "comment": "ProgressBar fills the entire URL Bar",
      "firefox_code": [],
      "ecosia_code": [
        "        progressBar.snp.makeConstraints { make in",
        "            make.edges.equalTo(locationView)"
      ],
      "context_before": [
        "        }",
        ""
      ],
      "context_after": [
        "        }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 390,
      "type": "removal",
      "comment": "Update search icon constraints",
      "firefox_code": [
        "            let heightMin = URLBarViewUX.LocationHeight + (URLBarViewUX.TextFieldBorderWidthSelected * 2)",
        "            make.height.greaterThanOrEqualTo(heightMin)",
        "            make.centerY.equalTo(self)",
        "            make.leading.equalTo(self.cancelButton.snp.trailing).offset(URLBarViewUX.LocationLeftPadding)",
        "            make.width.equalTo(URLBarViewUX.SearchIconImageWidth)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "        searchIconImageView.snp.remakeConstraints { make in"
      ],
      "context_after": [
        "            make.centerY.equalTo(self)",
        "            make.leading.equalTo(self.locationContainer.snp.leading).offset(12)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 404,
      "type": "substitution",
      "comment": "Update center Y constraint",
      "firefox_code": [
        "make.centerY.equalTo(self)"
      ],
      "ecosia_code": [
        "            make.centerY.equalTo(self.locationContainer)",
        "            make.size.equalTo(URLBarViewUX.ButtonHeight)"
      ],
      "context_before": [
        "        multiStateButton.snp.makeConstraints { make in",
        "            make.leading.equalTo(self.forwardButton.snp.trailing)"
      ],
      "context_after": [
        "        }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 440,
      "type": "removal",
      "comment": "Remove private mode badge",
      "firefox_code": [
        "        privateModeBadge.layout(onButton: tabsButton)"
      ],
      "ecosia_code": [],
      "context_before": [
        "        }",
        ""
      ],
      "context_after": [
        "        warningMenuBadge.layout(onButton: appMenuButton)",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 460,
      "type": "removal",
      "comment": "custom progress bar",
      "firefox_code": [
        "        progressBar.snp.remakeConstraints { make in",
        "            if isBottomSearchBar {",
        "                make.bottom.equalTo(snp.top).inset(URLBarViewUX.ProgressBarHeight / 2)",
        "            } else {",
        "                make.top.equalTo(snp.bottom).inset(URLBarViewUX.ProgressBarHeight / 2)",
        "            }",
        "            make.height.equalTo(URLBarViewUX.ProgressBarHeight)",
        "            make.left.right.equalTo(self)",
        "        }"
      ],
      "ecosia_code": [],
      "context_before": [
        "        }",
        ""
      ],
      "context_after": [
        "",
        "        /* Ecosia: Update Overlay / Standard constraints"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 473,
      "type": "removal",
      "comment": "Update Overlay / Standard constraints",
      "firefox_code": [
        "        if inOverlayMode {",
        "            // Ecosia: Customise alpha",
        "            // searchIconImageView.alpha = 1",
        "            // In overlay mode, we always show the location view full width",
        "            self.locationContainer.layer.borderWidth = URLBarViewUX.TextFieldBorderWidthSelected",
        "            self.locationContainer.snp.remakeConstraints { make in",
        "                let heightMin = URLBarViewUX.LocationHeight + (URLBarViewUX.TextFieldBorderWidthSelected * 2)",
        "                make.height.greaterThanOrEqualTo(heightMin)",
        "                make.trailing.equalTo(self.showQRScannerButton.snp.leading)",
        "                make.leading.equalTo(self.cancelButton.snp.trailing)",
        "                make.centerY.equalTo(self)",
        "            }",
        "            self.locationView.snp.remakeConstraints { make in",
        "                make.top.bottom.trailing.equalTo(self.locationContainer).inset(",
        "                    UIEdgeInsets(",
        "                        equalInset: URLBarViewUX.TextFieldBorderWidthSelected",
        "                    )",
        "                )",
        "                make.leading.equalTo(self.searchIconImageView.snp.trailing)",
        "            }",
        "            self.locationTextField?.snp.remakeConstraints { make in",
        "                make.edges.equalTo(self.locationView).inset(",
        "                    UIEdgeInsets(",
        "                        top: 0,",
        "                        left: URLBarViewUX.LocationLeftPadding,",
        "                        bottom: 0,",
        "                        right: URLBarViewUX.LocationLeftPadding",
        "                    )",
        "                )",
        "            }",
        "        } else {",
        "            // Ecosia: Customise alpha",
        "            // searchIconImageView.alpha = 0",
        "            self.locationContainer.snp.remakeConstraints { make in",
        "                if self.toolbarIsShowing {",
        "                    // If we are showing a toolbar, show the text field next to the forward button",
        "                    make.leading.equalTo(self.multiStateButton.snp.trailing).offset(URLBarViewUX.Padding)",
        "                    if self.topTabsIsShowing {",
        "                        make.trailing.equalTo(self.bookmarksButton.snp.leading).offset(-URLBarViewUX.Padding)",
        "                    } else {",
        "                        make.trailing.equalTo(self.circleButton.snp.leading).offset(-URLBarViewUX.Padding)",
        "                    }",
        "                } else {",
        "                    // Otherwise, left align the location view",
        "                    make.leading.trailing.equalTo(self).inset(",
        "                        UIEdgeInsets(",
        "                            top: 0,",
        "                            left: URLBarViewUX.LocationLeftPadding-1,",
        "                            bottom: 0,",
        "                            right: URLBarViewUX.LocationLeftPadding-1",
        "                        )",
        "                    )",
        "                }",
        "                make.height.greaterThanOrEqualTo(URLBarViewUX.LocationHeight+2)",
        "                make.centerY.equalTo(self)",
        "            }",
        "            self.locationContainer.layer.borderWidth = URLBarViewUX.TextFieldBorderWidth",
        "            self.locationView.snp.remakeConstraints { make in",
        "                make.edges.equalTo(self.locationContainer).inset(",
        "                    UIEdgeInsets(",
        "                        equalInset: URLBarViewUX.TextFieldBorderWidth",
        "                    )",
        "                )",
        "            }",
        "        }"
      ],
      "ecosia_code": [],
      "context_before": [
        "         */",
        ""
      ],
      "context_after": [
        "        if inOverlayMode {",
        "            // In overlay mode, we always show the location view full width"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 600,
      "type": "addition",
      "comment": "Update search engine image after constraints update",
      "firefox_code": [],
      "ecosia_code": [
        "        updateSearchEngineImage()"
      ],
      "context_before": [
        "        }",
        ""
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 656,
      "type": "substitution",
      "comment": "Do not show loading state when user has selected the url bar and is potentially typing",
      "firefox_code": [
        "progressBar.isHidden = false"
      ],
      "ecosia_code": [
        "        progressBar.isHidden = inOverlayMode",
        "        progressBar.setProgress(progress, animated: !isTransitioning)"
      ],
      "context_before": [
        "    func updateProgressBar(_ progress: Float) {",
        "        progressBar.alpha = 1"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 769,
      "type": "substitution",
      "comment": "always hide multi state button",
      "firefox_code": [
        "multiStateButton.alpha = inOverlayMode ? 0 : 1"
      ],
      "ecosia_code": [
        "        multiStateButton.alpha = 0"
      ],
      "context_before": [
        "        forwardButton.alpha = inOverlayMode ? 0 : 1",
        "        backButton.alpha = inOverlayMode ? 0 : 1"
      ],
      "context_after": [
        "",
        "        let borderColor = inOverlayMode ? locationActiveBorderColor : locationBorderColor"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 805,
      "type": "removal",
      "comment": "Remove private mode badge",
      "firefox_code": [
        "        [privateModeBadge, warningMenuBadge].forEach {"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "        // badge isHidden is tied to private mode on/off, use alpha to hide in this case"
      ],
      "context_after": [
        "        [warningMenuBadge].forEach {",
        "            $0.badge.alpha = (!toolbarIsShowing || inOverlayMode) ? 0 : 1"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 856,
      "type": "removal",
      "comment": "Remove private mode badge",
      "firefox_code": [
        "        if UIDevice.current.userInterfaceIdiom != .pad {",
        "            privateModeBadge.show(visible)",
        "        }"
      ],
      "ecosia_code": [],
      "context_before": [
        "extension URLBarView: TabToolbarProtocol {",
        "    func privateModeBadge(visible: Bool) {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 905,
      "type": "removal",
      "comment": "Change `addNewTabButton` to configurable CircleButton",
      "firefox_code": [
        "                        addNewTabButton,"
      ],
      "ecosia_code": [],
      "context_before": [
        "                        bookmarksButton,",
        "                        appMenuButton,"
      ],
      "context_after": [
        "                        circleButton,",
        "                        progressBar"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 1060,
      "type": "removal",
      "comment": "update background",
      "firefox_code": [
        "        backgroundColor = theme.colors.layer1"
      ],
      "ecosia_code": [],
      "context_before": [
        "        cancelTintColor = theme.colors.textPrimary",
        "        showQRButtonTintColor = theme.colors.textPrimary"
      ],
      "context_after": [
        "        backgroundColor = theme.colors.ecosia.backgroundPrimary",
        "        line.backgroundColor = theme.colors.borderPrimary"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 1066,
      "type": "removal",
      "comment": "Remove color for non-active location border state",
      "firefox_code": [
        "        locationBorderColor = theme.colors.borderPrimary"
      ],
      "ecosia_code": [],
      "context_before": [
        "        line.backgroundColor = theme.colors.borderPrimary",
        ""
      ],
      "context_after": [
        "        /* Ecosia: Take into account overlay mode for `locationView` background",
        "        locationView.backgroundColor = theme.colors.layer3"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 1076,
      "type": "removal",
      "comment": "Remove private mode badge",
      "firefox_code": [
        "        privateModeBadge.badge.tintBackground(color: theme.colors.layer1)"
      ],
      "ecosia_code": [],
      "context_before": [
        "        locationContainer.backgroundColor = locationView.backgroundColor",
        ""
      ],
      "context_after": [
        "",
        "        // Ecosia: Update Search Image Color"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 1084,
      "type": "addition",
      "comment": "Update UI Elements with helper",
      "firefox_code": [],
      "ecosia_code": [
        "        updateUIElementsWithTheme(theme)"
      ],
      "context_before": [
        "",
        "        warningMenuBadge.badge.tintBackground(color: theme.colors.layer1)"
      ],
      "context_after": [
        "        // Ecosia: Update Search Engine Image",
        "        updateSearchEngineImage()"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 1086,
      "type": "addition",
      "comment": "Update Search Engine Image",
      "firefox_code": [],
      "ecosia_code": [
        "        updateSearchEngineImage()"
      ],
      "context_before": [
        "        // Ecosia: Update UI Elements with helper",
        "        updateUIElementsWithTheme(theme)"
      ],
      "context_after": [
        "    }",
        "}"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 1095,
      "type": "addition",
      "comment": "Save `isPrivate` state",
      "firefox_code": [],
      "ecosia_code": [
        "        self.isPrivate = isPrivate"
      ],
      "context_before": [
        "    func applyUIMode(isPrivate: Bool, theme: Theme) {",
        ""
      ],
      "context_after": [
        "",
        "        /* Ecosia: Remove private mode badge"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 1098,
      "type": "removal",
      "comment": "Remove private mode badge",
      "firefox_code": [
        "        if UIDevice.current.userInterfaceIdiom != .pad {",
        "            privateModeBadge.show(isPrivate)"
      ],
      "ecosia_code": [],
      "context_before": [
        "        self.isPrivate = isPrivate",
        ""
      ],
      "context_after": [
        "",
        "        /* Ecosia: Update UI Elements with helper"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 1118,
      "type": "addition",
      "comment": "Apply Theme via helper",
      "firefox_code": [],
      "ecosia_code": [
        "extension URLBarView {"
      ],
      "context_before": [
        "}",
        ""
      ],
      "context_after": [
        "",
        "    func updateUIElementsWithTheme(_ theme: Theme) {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 1132,
      "type": "addition",
      "comment": "Update Search Engine Image",
      "firefox_code": [],
      "ecosia_code": [
        "extension URLBarView {"
      ],
      "context_before": [
        "}",
        ""
      ],
      "context_after": [
        "",
        "    func updateSearchEngineImage() {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 1141,
      "type": "addition",
      "comment": "Add Accesibility ID",
      "firefox_code": [],
      "ecosia_code": [
        "                searchIconImageView.accessibilityIdentifier = \"urlbar_logo_image\""
      ],
      "context_before": [
        "            } else {",
        "                searchIconImageView.image = .init(named: \"iconLogo\", in: .ecosia, with: nil)"
      ],
      "context_after": [
        "            }",
        "        } else {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Toolbar+URLBar/URLBarView.swift",
      "line": 1146,
      "type": "addition",
      "comment": "Add Accesibility ID",
      "firefox_code": [],
      "ecosia_code": [
        "            searchIconImageView.accessibilityIdentifier = \"urlbar_search_image\""
      ],
      "context_before": [
        "        } else {",
        "            searchIconImageView.image = .templateImageNamed(\"searchUrl\")"
      ],
      "context_after": [
        "        }",
        "        searchIconImageView.isHidden = !isHome && !inOverlayMode"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/TrackingProtection/TrackingProtectionHelpers/TrackingProtectionToggleView.swift",
      "line": 29,
      "type": "removal",
      "comment": "Use themed Switch",
      "firefox_code": [
        "    private let toggleSwitch: UISwitch = .build { toggleSwitch in"
      ],
      "ecosia_code": [],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "    private let toggleSwitch: EcosiaThemedSwitch = .build { toggleSwitch in",
        "        toggleSwitch.isEnabled = true"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/TrackingProtection/TrackingProtectionHelpers/TrackingProtectionToggleView.swift",
      "line": 138,
      "type": "removal",
      "comment": "Use applyTheme from EcosiaThemedSwitch",
      "firefox_code": [
        "        toggleSwitch.tintColor = theme.colors.actionPrimary",
        "        toggleSwitch.onTintColor = theme.colors.actionPrimary"
      ],
      "ecosia_code": [],
      "context_before": [
        "    func applyTheme(theme: Theme) {",
        "        self.backgroundColor = theme.colors.layer2"
      ],
      "context_after": [
        "        toggleSwitch.applyTheme(theme: theme)",
        "        toggleStatusLabel.textColor = theme.colors.textSecondary"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/TrackingProtection/TrackingProtectionViewController.swift",
      "line": 61,
      "type": "removal",
      "comment": "Remove Firefox branded header view",
      "firefox_code": [
        "    // MARK: Connection Details View",
        "    private var connectionDetailsHeaderView: TrackingProtectionConnectionDetailsView = .build()"
      ],
      "ecosia_code": [],
      "context_before": [
        "    private var headerContainer: HeaderView = .build()",
        ""
      ],
      "context_after": [
        "",
        "    // MARK: Blocked Trackers View"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/TrackingProtection/TrackingProtectionViewController.swift",
      "line": 74,
      "type": "addition",
      "comment": "Remove Firefox branded header view (had to move corner radius to this view)",
      "firefox_code": [],
      "ecosia_code": [
        "        stack.layer.cornerRadius = TPMenuUX.UX.viewCornerRadius",
        "        stack.layer.maskedCorners = [.layerMinXMinYCorner, .layerMaxXMinYCorner]",
        "        stack.layer.masksToBounds = true"
      ],
      "context_before": [
        "        stack.axis = .vertical",
        ""
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/TrackingProtection/TrackingProtectionViewController.swift",
      "line": 288,
      "type": "removal",
      "comment": "Remove Firefox branded header view",
      "firefox_code": [
        "        baseView.addSubviews(connectionDetailsHeaderView)",
        "        let connectionHeaderConstraints = [",
        "            connectionDetailsHeaderView.leadingAnchor.constraint(",
        "                equalTo: view.leadingAnchor,",
        "                constant: TPMenuUX.UX.horizontalMargin",
        "            ),",
        "            connectionDetailsHeaderView.trailingAnchor.constraint(",
        "                equalTo: view.trailingAnchor,",
        "                constant: -TPMenuUX.UX.horizontalMargin",
        "            ),",
        "            connectionDetailsHeaderView.topAnchor.constraint(",
        "                equalTo: baseView.topAnchor,",
        "                constant: TPMenuUX.UX.connectionDetailsHeaderMargins),",
        "        ]",
        "        constraints.append(contentsOf: connectionHeaderConstraints)"
      ],
      "ecosia_code": [],
      "context_before": [
        "    // MARK: Connection Status Header Setup",
        "    private func setupConnectionHeaderView() {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/TrackingProtection/TrackingProtectionViewController.swift",
      "line": 324,
      "type": "removal",
      "comment": "Remove Firefox branded header view",
      "firefox_code": [
        "            trackersConnectionContainer.topAnchor.constraint(equalTo: connectionDetailsHeaderView.bottomAnchor),"
      ],
      "ecosia_code": [],
      "context_before": [
        "                constant: -TPMenuUX.UX.horizontalMargin",
        "            ),"
      ],
      "context_after": [
        "            trackersConnectionContainer.topAnchor.constraint(equalTo: baseView.topAnchor),",
        "            connectionHorizontalLine.topAnchor.constraint(equalTo: trackersConnectionContainer.bottomAnchor),"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/TrackingProtection/TrackingProtectionViewController.swift",
      "line": 427,
      "type": "removal",
      "comment": "Remove Firefox branded header view",
      "firefox_code": [
        "        connectionDetailsHeaderView.setupDetails(title: model.connectionDetailsTitle,",
        "                                                 status: model.connectionDetailsHeader,",
        "                                                 image: model.connectionDetailsImage)"
      ],
      "ecosia_code": [],
      "context_before": [
        "                                     icon: headerIcon)",
        ""
      ],
      "context_after": [
        "",
        "        updateBlockedTrackersCount()"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/TrackingProtection/TrackingProtectionViewController.swift",
      "line": 479,
      "type": "removal",
      "comment": "Remove Firefox branded header view",
      "firefox_code": [
        "        connectionDetailsHeaderView.setupAccessibilityIdentifiers(foxImageA11yId: model.foxImageA11yId)"
      ],
      "ecosia_code": [],
      "context_before": [
        "    // MARK: Accessibility",
        "    private func setupAccessibilityIdentifiers() {"
      ],
      "context_after": [
        "        trackersView.setupAccessibilityIdentifiers(",
        "            arrowImageA11yId: model.arrowImageA11yId,"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/TrackingProtection/TrackingProtectionViewController.swift",
      "line": 502,
      "type": "removal",
      "comment": "Remove Firefox branded header view",
      "firefox_code": [
        "        connectionDetailsHeaderView.adjustLayout()"
      ],
      "ecosia_code": [],
      "context_before": [
        "        trackersView.adjustLayout()",
        "        connectionStatusView.adjustLayout()"
      ],
      "context_after": [
        "        toggleView.adjustLayout()",
        "        configureProtectionSettingsView()"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/TrackingProtection/TrackingProtectionViewController.swift",
      "line": 617,
      "type": "removal",
      "comment": "Remove Firefox branded header view",
      "firefox_code": [
        "        connectionDetailsHeaderView.setupDetails(color: model.getConnectionDetailsBackgroundColor(theme: currentTheme()),",
        "                                                 title: model.connectionDetailsTitle,",
        "                                                 status: model.connectionDetailsHeader,",
        "                                                 image: model.connectionDetailsImage)"
      ],
      "ecosia_code": [],
      "context_before": [
        "        }",
        "        toggleView.setToggleSwitchVisibility(with: !isContentBlockingConfigEnabled)"
      ],
      "context_after": [
        "        adjustLayout()",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/TrackingProtection/TrackingProtectionViewController.swift",
      "line": 634,
      "type": "removal",
      "comment": "Remove Firefox branded header view",
      "firefox_code": [
        "        connectionDetailsHeaderView.backgroundColor = theme.colors.layer2"
      ],
      "ecosia_code": [],
      "context_before": [
        "        view.backgroundColor = theme.colors.layer1",
        "        headerContainer.applyTheme(theme: theme)"
      ],
      "context_after": [
        "        trackersView.applyTheme(theme: theme)",
        "        connectionStatusView.applyTheme(theme: theme)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Widgets/AutocompleteTextField.swift",
      "line": 279,
      "type": "substitution",
      "comment": "Update color",
      "firefox_code": [
        "let color = isPrivateMode ? theme.colors.layerAccentPrivateNonOpaque : theme.colors.layerAccentNonOpaque"
      ],
      "ecosia_code": [
        "            let color = UIColor(red: 0, green: 0.495, blue: 0.66, alpha: 1).withAlphaComponent(0.25)",
        "            autocompleteText.addAttribute(NSAttributedString.Key.backgroundColor,",
        "                                          value: color,",
        "                                          range: NSRange(location: 0, length: suggestionText.count))",
        "            autocompleteTextLabel = createAutocompleteLabelWith(autocompleteText)"
      ],
      "context_before": [
        "",
        "        if let theme {"
      ],
      "context_after": [
        "        }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Widgets/AutocompleteTextField.swift",
      "line": 399,
      "type": "removal",
      "comment": "Update color",
      "firefox_code": [
        "            let color = isPrivateMode ? theme.colors.layerAccentPrivateNonOpaque : theme.colors.layerAccentNonOpaque"
      ],
      "ecosia_code": [],
      "context_before": [
        "                string: self.autocompleteTextLabel?.attributedText?.string ?? \"\"",
        "            )"
      ],
      "context_after": [
        "            let color = UIColor(red: 0, green: 0.495, blue: 0.66, alpha: 1).withAlphaComponent(0.25)",
        "            autocompleteText.addAttribute(NSAttributedString.Key.backgroundColor,"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Widgets/AutocompleteTextField.swift",
      "line": 419,
      "type": "removal",
      "comment": "update color",
      "firefox_code": [
        "        backgroundColor = theme.colors.layer3",
        "        textColor = theme.colors.textPrimary",
        "        tintColor = theme.colors.actionPrimary"
      ],
      "ecosia_code": [],
      "context_before": [
        "                                                   attributes: attributes)",
        ""
      ],
      "context_after": [
        "        textColor = theme.colors.textSecondary",
        "        backgroundColor = .clear"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Widgets/AutocompleteTextField.swift",
      "line": 429,
      "type": "removal",
      "comment": "update background and color",
      "firefox_code": [
        "            autocompleteTextLabel?.backgroundColor = theme.colors.layer3",
        "            autocompleteTextLabel?.textColor = theme.colors.textPrimary"
      ],
      "ecosia_code": [],
      "context_before": [
        "        // Only refresh if an autocomplete label is presented to the user",
        "        if autocompleteTextLabel?.attributedText != nil {"
      ],
      "context_after": [
        "            autocompleteTextLabel?.backgroundColor = UIColor(red: 0, green: 0.495, blue: 0.66, alpha: 0.25)",
        "            autocompleteTextLabel?.textColor = theme.colors.textSecondary"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Widgets/OneLineTableViewCell.swift",
      "line": 54,
      "type": "addition",
      "comment": "Add separator color",
      "firefox_code": [],
      "ecosia_code": [
        "        separatorLine.backgroundColor = UIColor.Photon.Grey40"
      ],
      "context_before": [
        "        // separator hidden by default",
        "        separatorLine.isHidden = true"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Widgets/OneLineTableViewCell.swift",
      "line": 143,
      "type": "removal",
      "comment": "Update properties",
      "firefox_code": [
        "        separatorInset = defaultSeparatorInset",
        "        titleLabel.text = nil"
      ],
      "ecosia_code": [],
      "context_before": [
        "        super.prepareForReuse()",
        "        selectionStyle = .default"
      ],
      "context_after": [
        "        accessoryView = nil",
        "        accessoryType = .none"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Widgets/OneLineTableViewCell.swift",
      "line": 173,
      "type": "removal",
      "comment": "Update custom theming",
      "firefox_code": [
        "        backgroundColor = theme.colors.layer5"
      ],
      "ecosia_code": [],
      "context_before": [
        "    func applyTheme(theme: Theme) {",
        "        selectedView.backgroundColor = theme.colors.layer5Hover"
      ],
      "context_after": [
        "        backgroundColor = theme.colors.ecosia.backgroundElevation1",
        "        titleLabel.textColor = theme.colors.textPrimary"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Widgets/OneLineTableViewCell.swift",
      "line": 182,
      "type": "addition",
      "comment": "update tint color",
      "firefox_code": [],
      "ecosia_code": [
        "        tintColor = theme.colors.ecosia.buttonBackgroundPrimary"
      ],
      "context_before": [
        "        leftImageView.tintColor = theme.colors.textPrimary",
        ""
      ],
      "context_after": [
        "    }",
        "}"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Widgets/PhotonActionSheet/PhotonActionSheetProtocol.swift",
      "line": 26,
      "type": "addition",
      "comment": "Ecosia: custom UI/UX for main menu",
      "firefox_code": [],
      "ecosia_code": [
        "        guard !viewModel.isMainMenu else {"
      ],
      "context_before": [
        "        guard let uuid = view.currentWindowUUID else { return }",
        ""
      ],
      "context_after": [
        "",
        "            // main menu should only be opened from the browser"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Widgets/PhotonActionSheet/PhotonActionSheetProtocol.swift",
      "line": 50,
      "type": "substitution",
      "comment": "Update permitted arrow dimensions",
      "firefox_code": [
        "popoverVC.permittedArrowDirections = [.up]"
      ],
      "ecosia_code": [
        "                popoverVC.permittedArrowDirections = viewModel.getPossibleArrowDirections(trait: trait)"
      ],
      "context_before": [
        "                    popoverVC.popoverLayoutMargins = margins",
        "                }"
      ],
      "context_after": [
        "            }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Widgets/PhotonActionSheet/SingleActionViewModel.swift",
      "line": 43,
      "type": "addition",
      "comment": "Add `isNew` bool",
      "firefox_code": [],
      "ecosia_code": [
        "    var isNew: Bool // Used to display the \"New\" badge",
        "    private(set) var bold = false",
        "    private(set) var tabCount: String?",
        "    private(set) var tapHandler: ((SingleActionViewModel) -> Void)?",
        "    private(set) var badgeIconName: String?"
      ],
      "context_before": [
        "",
        "    var isEnabled: Bool // Used by toggles like night mode to switch tint color"
      ],
      "context_after": [
        "",
        "    // Flip the cells for the main menu (hamburger menu) since content needs to appear at the bottom"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Widgets/PhotonActionSheet/SingleActionViewModel.swift",
      "line": 77,
      "type": "addition",
      "comment": "Add `isNew` bool",
      "firefox_code": [],
      "ecosia_code": [
        "         tapHandler: ((SingleActionViewModel) -> Void)? = nil) {",
        "        self.title = title",
        "        self.iconString = iconString",
        "        self.iconURL = iconURL",
        "        self.iconType = iconType",
        "        self.iconAlignment = iconAlignment",
        "        self.allowIconScaling = allowIconScaling",
        "        self.needsIconActionableTint = needsIconActionableTint",
        "        self.isEnabled = isEnabled",
        "        self.tapHandler = tapHandler",
        "        self.text = text",
        "        self.bold = bold ?? false",
        "        self.tabCount = tabCount",
        "        self.isNew = isNew // Ecosia: Add `isNew` bool",
        "        self.badgeIconName = badgeIconNamed"
      ],
      "context_before": [
        "         bold: Bool? = false,",
        "         tabCount: String? = nil,"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Widgets/PhotonActionSheet/SingleActionViewModel.swift",
      "line": 91,
      "type": "addition",
      "comment": "Add `isNew` bool",
      "firefox_code": [],
      "ecosia_code": [
        "        self.badgeIconName = badgeIconNamed"
      ],
      "context_before": [
        "        self.bold = bold ?? false",
        "        self.tabCount = tabCount"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Widgets/SiteTableViewController.swift",
      "line": 30,
      "type": "addition",
      "comment": "Branding",
      "firefox_code": [],
      "ecosia_code": [
        "    let style: UITableView.Style"
      ],
      "context_before": [
        "    var currentWindowUUID: UUID? { windowUUID }",
        ""
      ],
      "context_after": [
        "",
        "    var data = Cursor<Site>(status: .success, msg: \"No data set\")"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Widgets/SiteTableViewController.swift",
      "line": 34,
      "type": "removal",
      "comment": "Update TableView init to make it grouped",
      "firefox_code": [
        "    lazy var tableView: UITableView = .build { [weak self] table in",
        "        guard let self = self else { return }"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    var data = Cursor<Site>(status: .success, msg: \"No data set\")"
      ],
      "context_after": [
        "    lazy var tableView: UITableView = {",
        "        let table = UITableView(frame: .zero, style: self.style)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Widgets/SiteTableViewController.swift",
      "line": 74,
      "type": "addition",
      "comment": "Update TableView init to make it grouped",
      "firefox_code": [],
      "ecosia_code": [
        "        return table",
        "    }()"
      ],
      "context_before": [
        "        table.tableFooterView = UIView()",
        "        table.sectionHeaderTopPadding = 0"
      ],
      "context_after": [
        "",
        "    override private init(nibName: String?, bundle: Bundle?) {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Widgets/SiteTableViewController.swift",
      "line": 86,
      "type": "substitution",
      "comment": "Update init adding `style`",
      "firefox_code": [
        "themeManager: ThemeManager = AppContainer.shared.resolve()"
      ],
      "ecosia_code": [
        "         themeManager: ThemeManager = AppContainer.shared.resolve(),",
        "         style: UITableView.Style = .plain) {",
        "        self.profile = profile",
        "        self.windowUUID = windowUUID",
        "        self.notificationCenter = notificationCenter",
        "        self.themeManager = themeManager",
        "        self.windowManager = windowManager"
      ],
      "context_before": [
        "         notificationCenter: NotificationProtocol = NotificationCenter.default,",
        "         windowManager: WindowManager = AppContainer.shared.resolve(),"
      ],
      "context_after": [
        "        // Ecosia: Update init adding `style`",
        "        self.style = style"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Widgets/SiteTableViewController.swift",
      "line": 95,
      "type": "addition",
      "comment": "Update init adding `style`",
      "firefox_code": [],
      "ecosia_code": [
        "        self.style = style",
        "        super.init(nibName: nil, bundle: nil)",
        "        listenForThemeChange(view)",
        "        applyTheme()"
      ],
      "context_before": [
        "        self.themeManager = themeManager",
        "        self.windowManager = windowManager"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Widgets/SiteTableViewController.swift",
      "line": 180,
      "type": "removal",
      "comment": "Update header text label color",
      "firefox_code": [
        "            header.textLabel?.textColor = themeManager.getCurrentTheme(for: windowUUID).colors.textPrimary",
        "            header.contentView.backgroundColor = themeManager.getCurrentTheme(for: windowUUID).colors.layer1"
      ],
      "ecosia_code": [],
      "context_before": [
        "    func tableView(_ tableView: UITableView, willDisplayHeaderView view: UIView, forSection section: Int) {",
        "        if let header = view as? UITableViewHeaderFooterView {"
      ],
      "context_after": [
        "            header.textLabel?.textColor = themeManager.getCurrentTheme(for: windowUUID).colors.ecosia.textSecondary",
        "            header.contentView.backgroundColor = .clear"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Widgets/SiteTableViewHeader.swift",
      "line": 102,
      "type": "removal",
      "comment": "Change theme",
      "firefox_code": [
        "        titleLabel.textColor = theme.colors.textPrimary",
        "        backgroundView?.backgroundColor = theme.colors.layer1",
        "        collapsibleImageView.image = collapsibleState?.image?.tinted(withColor: theme.colors.iconAccent)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func applyTheme(theme: Theme) {"
      ],
      "context_after": [
        "        titleLabel.textColor = theme.colors.ecosia.textSecondary",
        "        backgroundView?.backgroundColor = .clear"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Widgets/TabsButton.swift",
      "line": 30,
      "type": "removal",
      "comment": "Update so theme is not nil on `createTabsButton`",
      "firefox_code": [
        "     (required so colors are present for the animated cloned button)",
        "    private var theme: Theme?"
      ],
      "ecosia_code": [],
      "context_before": [
        "    private var selectedTintColor: UIColor!",
        "    private var unselectedTintColor: UIColor!"
      ],
      "context_after": [
        "    private var theme: Theme? {",
        "        guard traitCollection.userInterfaceIdiom != .pad else {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Widgets/ThemedDefaultNavigationController.swift",
      "line": 51,
      "type": "removal",
      "comment": "Update bar tint",
      "firefox_code": [
        "        navigationBar.tintColor = theme.colors.textPrimary"
      ],
      "ecosia_code": [],
      "context_before": [
        "        navigationBar.scrollEdgeAppearance = standardAppearance",
        "        navigationBar.compactScrollEdgeAppearance = standardAppearance"
      ],
      "context_after": [
        "        navigationBar.tintColor = theme.colors.actionPrimary",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Widgets/ToggleButton.swift",
      "line": 8,
      "type": "removal",
      "comment": "Update background color",
      "firefox_code": [
        "    static let BackgroundColor = UIColor.Photon.Purple60"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "private struct UX {"
      ],
      "context_after": [
        "    // TODO: Do we also need to handle `white` on Dark Theme?",
        "    static let BackgroundColor = UIColor.Photon.Grey60"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Widgets/ToggleButton.swift",
      "line": 21,
      "type": "addition",
      "comment": "Add Insets to modify button margins",
      "firefox_code": [],
      "ecosia_code": [
        "    static let Insets = UIEdgeInsets(top: 6, left: 8, bottom: 6, right: 8)"
      ],
      "context_before": [
        "",
        "    static let BackgroundSize = CGSize(width: 32, height: 32)"
      ],
      "context_after": [
        "}",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Widgets/ToggleButton.swift",
      "line": 32,
      "type": "removal",
      "comment": "Restore animation like in vanilla v104",
      "firefox_code": [
        "    fileprivate func updateMaskPathForSelectedState(_ selected: Bool) {",
        "        let path = CGMutablePath()",
        "        if selected {",
        "            var rect = CGRect(size: UX.BackgroundSize)",
        "            rect.center = maskShapeLayer.position",
        "            path.addEllipse(in: rect)",
        "        } else {",
        "            path.addEllipse(in: CGRect(origin: maskShapeLayer.position, size: .zero))",
        "        }",
        "        self.maskShapeLayer.path = path",
        "    }",
        "    fileprivate func animateSelection(_ selected: Bool) {",
        "        var endFrame = CGRect(size: UX.BackgroundSize)",
        "        endFrame.center = maskShapeLayer.position",
        "        if selected {",
        "            let animation = CAKeyframeAnimation(keyPath: \"path\")",
        "            let startPath = CGMutablePath()",
        "            startPath.addEllipse(in: CGRect(origin: maskShapeLayer.position, size: .zero))",
        "            let largerPath = CGMutablePath()",
        "            let largerBounds = endFrame.insetBy(dx: -UX.ExpandDelta, dy: -UX.ExpandDelta)",
        "            largerPath.addEllipse(in: largerBounds)",
        "            let endPath = CGMutablePath()",
        "            endPath.addEllipse(in: endFrame)",
        "            animation.timingFunction = CAMediaTimingFunction(name: CAMediaTimingFunctionName.easeOut)",
        "            animation.values = [",
        "                startPath,",
        "                largerPath,",
        "                endPath",
        "            ]",
        "            animation.duration = UX.ShowDuration",
        "            self.maskShapeLayer.path = endPath",
        "            self.maskShapeLayer.add(animation, forKey: \"grow\")",
        "        } else {",
        "            let animation = CABasicAnimation(keyPath: \"path\")",
        "            animation.duration = UX.HideDuration",
        "            animation.fillMode = CAMediaTimingFillMode.forwards",
        "            let fromPath = CGMutablePath()",
        "            fromPath.addEllipse(in: endFrame)",
        "            animation.fromValue = fromPath",
        "            animation.timingFunction = CAMediaTimingFunction(name: CAMediaTimingFunctionName.easeInEaseOut)",
        "            let toPath = CGMutablePath()",
        "            toPath.addEllipse(in: CGRect(origin: self.maskShapeLayer.bounds.center, size: .zero))",
        "            self.maskShapeLayer.path = toPath",
        "            self.maskShapeLayer.add(animation, forKey: \"shrink\")",
        "        }",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "        }",
        "    }"
      ],
      "context_after": [
        "",
        "    fileprivate func updateMaskPathForSelectedState(_ selected: Bool) {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Widgets/ToggleButton.swift",
      "line": 162,
      "type": "substitution",
      "comment": "Make `backgroundLayer` accessible externally",
      "firefox_code": [
        "Remove `fileprivate`"
      ],
      "ecosia_code": [
        "    lazy var backgroundLayer: CALayer = {",
        "        let backgroundLayer = CALayer()",
        "        backgroundLayer.backgroundColor = UX.BackgroundColor.cgColor",
        "        backgroundLayer.mask = self.maskShapeLayer",
        "        return backgroundLayer",
        "    }()"
      ],
      "context_before": [
        "    }()",
        ""
      ],
      "context_after": [
        "",
        "    override init(frame: CGRect) {"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Widgets/ToggleButton.swift",
      "line": 174,
      "type": "addition",
      "comment": "Add `contentEdgeInsets`",
      "firefox_code": [],
      "ecosia_code": [
        "        contentEdgeInsets = UX.Insets",
        "        insertSubview(backgroundView, belowSubview: imageView!)"
      ],
      "context_before": [
        "        super.init(frame: frame)",
        "        contentMode = .redraw"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Widgets/TwoLineImageOverlayCell.swift",
      "line": 105,
      "type": "substitution",
      "comment": "Remove overlay image",
      "firefox_code": [
        "containerView.addSubview(leftOverlayImageView)"
      ],
      "ecosia_code": [],
      "context_before": [
        "        containerView.addSubview(leftImageView)",
        "        containerView.addSubview(stackView)"
      ],
      "context_after": [
        "",
        "        contentView.addSubview(containerView)"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Widgets/TwoLineImageOverlayCell.swift",
      "line": 126,
      "type": "removal",
      "comment": "Remove overlay image",
      "firefox_code": [
        "            leftOverlayImageView.trailingAnchor.constraint(equalTo: leftImageView.trailingAnchor,",
        "                                                           constant: 8),",
        "            leftOverlayImageView.bottomAnchor.constraint(equalTo: leftImageView.bottomAnchor,",
        "                                                         constant: 8),",
        "            leftOverlayImageView.heightAnchor.constraint(equalToConstant: 22),",
        "            leftOverlayImageView.widthAnchor.constraint(equalToConstant: 22),"
      ],
      "ecosia_code": [],
      "context_before": [
        "                                                    constant: -16),",
        ""
      ],
      "context_after": [
        "            stackView.topAnchor.constraint(equalTo: containerView.topAnchor,",
        "                                           constant: 8),"
      ]
    },
    {
      "file": "firefox-ios/Client/Frontend/Widgets/TwoLineImageOverlayCell.swift",
      "line": 152,
      "type": "removal",
      "comment": "Update image view properties",
      "firefox_code": [
        "        accessoryView?.tintColor = theme.colors.iconSecondary"
      ],
      "ecosia_code": [],
      "context_before": [
        "        leftImageView.layer.borderColor = theme.colors.borderPrimary.cgColor",
        ""
      ],
      "context_after": [
        "        leftImageView.tintColor = theme.colors.textPrimary",
        "        accessoryView?.tintColor = theme.colors.actionSecondary"
      ]
    },
    {
      "file": "firefox-ios/Client/Nimbus/NimbusSearchBarLayer.swift",
      "line": 10,
      "type": "removal",
      "comment": "Search Bar stays on top by default",
      "firefox_code": [
        "        let isAtBottom = nimbus.features.search.value().awesomeBar.position.isBottom",
        "        return isAtBottom ? .bottom : .top"
      ],
      "ecosia_code": [],
      "context_before": [
        "    // MARK: - Public methods",
        "    public func getDefaultPosition(from nimbus: FxNimbus = FxNimbus.shared) -> SearchBarPosition {"
      ],
      "context_after": [
        "        .top",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/TabManagement/Legacy/LegacyTabManager.swift",
      "line": 88,
      "type": "removal",
      "comment": "filter out invisible tabs",
      "firefox_code": [
        "         return tabs.filter { !$0.isPrivate }"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    var normalTabs: [Tab] {"
      ],
      "context_after": [
        "        return tabs.filter { !$0.isPrivate && !$0.isInvisible }",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/TabManagement/Legacy/LegacyTabManager.swift",
      "line": 107,
      "type": "removal",
      "comment": "filter out invisible tabs",
      "firefox_code": [
        "        return tabs.filter { $0.isPrivate }"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    var privateTabs: [Tab] {"
      ],
      "context_after": [
        "        return tabs.filter { $0.isPrivate && !$0.isInvisible }",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/TabManagement/Legacy/LegacyTabManager.swift",
      "line": 196,
      "type": "addition",
      "comment": "Cookie and settings observing",
      "firefox_code": [],
      "ecosia_code": [
        "        configuration.websiteDataStore.httpCookieStore.add(self)",
        "        searchSettingsObserver = NotificationCenter.default",
        "            .publisher(for: .searchSettingsChanged)",
        "            .sink { [privateConfiguration, configuration] _ in",
        "                Cookie.makeSearchSettingsObserverCookies(isPrivate: false).forEach { cookie in",
        "                    configuration.websiteDataStore.httpCookieStore.setCookie(cookie)"
      ],
      "context_before": [
        "                                               name: .BlockPopup,",
        "                                               object: nil)"
      ],
      "context_after": [
        "                }",
        "                Cookie.makeSearchSettingsObserverCookies(isPrivate: true).forEach { cookie in"
      ]
    },
    {
      "file": "firefox-ios/Client/TabManagement/Legacy/LegacyTabManager.swift",
      "line": 269,
      "type": "addition",
      "comment": "inject all required cookies when config is created to make sure they are present",
      "firefox_code": [],
      "ecosia_code": [
        "        let cookies = Cookie.makeRequiredCookies(isPrivate: isPrivate)",
        "        cookies.forEach { cookie in",
        "            configuration.websiteDataStore.httpCookieStore.setCookie(cookie)"
      ],
      "context_before": [
        "        configuration.setURLSchemeHandler(InternalSchemeHandler(), forURLScheme: InternalURL.scheme)",
        ""
      ],
      "context_after": [
        "        }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/TabManagement/Legacy/LegacyTabManager.swift",
      "line": 321,
      "type": "removal",
      "comment": "[MOB-3352] Change default behaviour to false and migrate old key value",
      "firefox_code": [
        "        // FXIOS-9519: By default if no bool value is set we close the private tabs and mark it true",
        "        return profile.prefs.boolForKey(PrefsKeys.Settings.closePrivateTabs) ?? true"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func shouldClearPrivateTabs() -> Bool {"
      ],
      "context_after": [
        "        var currentValue = profile.prefs.boolForKey(PrefsKeys.Settings.closePrivateTabs)",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/TabManagement/Legacy/LegacyTabManager.swift",
      "line": 327,
      "type": "addition",
      "comment": "Only necessary for migration to version 11.x.x - remove after enough users migrated",
      "firefox_code": [],
      "ecosia_code": [
        "        let oldKey = \"settings.closePrivateTabs\"",
        "        let oldClosePrivateTabsValue = profile.prefs.boolForKey(oldKey)",
        "        if let oldValue = oldClosePrivateTabsValue, currentValue == nil {",
        "            currentValue = oldValue",
        "            profile.prefs.setBool(oldValue, forKey: PrefsKeys.Settings.closePrivateTabs)",
        "            profile.prefs.removeObjectForKey(oldKey)"
      ],
      "context_before": [
        "        var currentValue = profile.prefs.boolForKey(PrefsKeys.Settings.closePrivateTabs)",
        ""
      ],
      "context_after": [
        "        }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/TabManagement/Legacy/LegacyTabManager.swift",
      "line": 829,
      "type": "removal",
      "comment": "Update Toast to look like v104",
      "firefox_code": [
        "        let viewModel = ButtonToastViewModel(",
        "            labelText: String.localizedStringWithFormat(",
        "                .TabsTray.CloseTabsToast.Title,",
        "                recentlyClosedTabs.count),",
        "            buttonText: .TabsTray.CloseTabsToast.Action)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "        // Toast"
      ],
      "context_after": [
        "        let viewModel = ButtonToastViewModel(",
        "            labelText: String.localizedStringWithFormat("
      ]
    },
    {
      "file": "firefox-ios/Client/TabManagement/Legacy/LegacyTabManager.swift",
      "line": 1066,
      "type": "removal",
      "comment": "Use homepage url constant",
      "firefox_code": [
        "         let homeUrl = URL(string: \"internal://local/about/home\")"
      ],
      "ecosia_code": [],
      "context_before": [
        "        let page = NewTabAccessors.getHomePage(profilePreferences)",
        "        let customUrl = HomeButtonHomePageAccessors.getHomePage(profilePreferences)"
      ],
      "context_after": [
        "        let homeUrl = URL(string: URL.homepageUrlString)",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/TabManagement/Legacy/LegacyTabManager.swift",
      "line": 1135,
      "type": "addition",
      "comment": "Cookie observer",
      "firefox_code": [],
      "ecosia_code": [
        "extension LegacyTabManager: WKHTTPCookieStoreObserver {",
        "    func cookiesDidChange(in cookieStore: WKHTTPCookieStore) {",
        "        cookieStore.getAllCookies { cookies in",
        "            DispatchQueue.main.async {",
        "                Cookie.received(cookies, in: cookieStore)"
      ],
      "context_before": [
        "}",
        ""
      ],
      "context_after": [
        "            }",
        "        }"
      ]
    },
    {
      "file": "firefox-ios/Client/TabManagement/Tab.swift",
      "line": 610,
      "type": "removal",
      "comment": "This code is never executed in the original Firefox implementation, not even in Debug configurations (Debug, EcosiaBetaDebug, EcosiaDebug)",
      "firefox_code": [
        "        guard let appDelegate = UIApplication.shared.delegate as? AppDelegate else { return }",
        "        func checkTabCount(failures: Int) {",
        "            // Need delay for pool to drain.",
        "            DispatchQueue.main.asyncAfter(deadline: .now() + 0.1) {",
        "                if appDelegate.tabManager.remoteTabs.count == debugTabCount {",
        "                    return",
        "                }",
        "                // If this assert has false positives, remove it and just log an error.",
        "                assert(failures < 3, \"Tab init/deinit imbalance, possible memory leak.\")",
        "                checkTabCount(failures: failures + 1)",
        "            }",
        "        }",
        "        checkTabCount(failures: 0)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "#if DEBUG"
      ],
      "context_after": [
        "#endif",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Client/TabManagement/Tab.swift",
      "line": 684,
      "type": "substitution",
      "comment": "updating the request with auth parameters and language header if needed",
      "firefox_code": [
        "return webView.load(request)"
      ],
      "ecosia_code": [
        "            var ecosiaUpdatedRequest = request"
      ],
      "context_before": [
        "                return webView.loadFileURL(url, allowingReadAccessTo: url)",
        "            }"
      ],
      "context_after": [
        "            // Inject auth parameters if needed",
        "            ecosiaUpdatedRequest = ecosiaUpdatedRequest.withCloudFlareAuthParameters()"
      ]
    },
    {
      "file": "firefox-ios/Client/TabManagement/TabManagerImplementation.swift",
      "line": 27,
      "type": "removal",
      "comment": "filter out invisible tabs",
      "firefox_code": [
        "        let activeTabs = tabs.filter { $0.isPrivate == false && !inactiveTabs.contains($0) }"
      ],
      "ecosia_code": [],
      "context_before": [
        "    override var normalActiveTabs: [Tab] {",
        "        let inactiveTabs = getInactiveTabs()"
      ],
      "context_after": [
        "        let activeTabs = tabs.filter { $0.isPrivate == false && !$0.isInvisible && !inactiveTabs.contains($0) }",
        "        return activeTabs"
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/AdsTelemetryHelper.swift",
      "line": 8,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "import Glean"
      ],
      "ecosia_code": [],
      "context_before": [
        "import Shared",
        "import WebKit"
      ],
      "context_after": [
        "",
        "public enum BasicSearchProvider: String {"
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/AdsTelemetryHelper.swift",
      "line": 146,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        GleanMetrics.BrowserSearch.withAds[\"provider-\\(providerName)\"].add()"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    public static func trackAdsFoundOnPage(providerName: String) {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/AdsTelemetryHelper.swift",
      "line": 152,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        GleanMetrics.BrowserSearch.adClicks[\"provider-\\(providerName)\"].add()"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    public static func trackAdsClickedOnPage(providerName: String) {"
      ],
      "context_after": [
        "    }",
        "}"
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/AppStartupTelemetry.swift",
      "line": 6,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "import Glean"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "import Foundation"
      ],
      "context_after": [
        "import Storage",
        "import Common"
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/GleanWrapper.swift",
      "line": 6,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "import Glean"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "import Foundation"
      ],
      "context_after": [
        "",
        "protocol GleanWrapper {"
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/GleanWrapper.swift",
      "line": 21,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        Glean.shared.handleCustomUrl(url: url)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func handleDeeplinkUrl(url: URL) {"
      ],
      "context_after": [
        "    }",
        "    func setUpload(isEnabled: Bool) {"
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/GleanWrapper.swift",
      "line": 26,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        Glean.shared.setUploadEnabled(isEnabled)"
      ],
      "ecosia_code": [],
      "context_before": [
        "    }",
        "    func setUpload(isEnabled: Bool) {"
      ],
      "context_after": [
        "    }",
        "    func submitPing() {"
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/GleanWrapper.swift",
      "line": 31,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        GleanMetrics.Pings.shared.firstSession.submit()"
      ],
      "ecosia_code": [],
      "context_before": [
        "    }",
        "    func submitPing() {"
      ],
      "context_after": [
        "    }",
        "}"
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/HomepageTelemetry.swift",
      "line": 6,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "import Glean"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "import Foundation"
      ],
      "context_after": [
        "",
        "struct HomepageTelemetry {"
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/HomepageTelemetry.swift",
      "line": 12,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        let isPrivateModeExtra = GleanMetrics.Homepage.PrivateModeToggleExtra(isPrivateMode: enteringPrivateMode)",
        "        GleanMetrics.Homepage.privateModeToggle.record(isPrivateModeExtra)"
      ],
      "ecosia_code": [],
      "context_before": [
        "struct HomepageTelemetry {",
        "    func sendHomepageTappedTelemetry(enteringPrivateMode: Bool) {"
      ],
      "context_after": [
        "    }",
        "}"
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/PrivateBrowsingTelemetry.swift",
      "line": 6,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "import Glean"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "import Foundation"
      ],
      "context_after": [
        "",
        "struct PrivateBrowsingTelemetry {"
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/PrivateBrowsingTelemetry.swift",
      "line": 12,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        let didConfirmExtra = GleanMetrics.PrivateBrowsing.DataClearanceIconTappedExtra(didConfirm: didConfirm)",
        "        GleanMetrics.PrivateBrowsing.dataClearanceIconTapped.record(didConfirmExtra)"
      ],
      "ecosia_code": [],
      "context_before": [
        "struct PrivateBrowsingTelemetry {",
        "    func sendDataClearanceTappedTelemetry(didConfirm: Bool) {"
      ],
      "context_after": [
        "    }",
        "}"
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/SearchTelemetry.swift",
      "line": 7,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "import Glean"
      ],
      "ecosia_code": [],
      "context_before": [
        "import Foundation",
        "import WebKit"
      ],
      "context_after": [
        "import Storage",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/SearchTelemetry.swift",
      "line": 175,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        GleanMetrics.Search.inContent[\"\\(provider).in-content.sap.\\(code)\"].add()"
      ],
      "ecosia_code": [],
      "context_before": [
        "    // sap: directly from search access point",
        "    func trackSAP() {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/SearchTelemetry.swift",
      "line": 182,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        GleanMetrics.Search.inContent[\"\\(provider).in-content.sap-follow-on.\\(code)\"].add()"
      ],
      "ecosia_code": [],
      "context_before": [
        "    // sap-follow-on: user continues to search from an existing sap search",
        "    func trackSAPFollowOn() {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/SearchTelemetry.swift",
      "line": 189,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        GleanMetrics.Search.inContent[\"\\(provider).organic.none\"].add()"
      ],
      "ecosia_code": [],
      "context_before": [
        "    // organic: search that didn't come from a SAP",
        "    func trackOrganic() {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/SearchTelemetry.swift",
      "line": 198,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        GleanMetrics.Search.googleTopsitePressed[\"\\(SearchEngine.google).\\(code)\"].add()"
      ],
      "ecosia_code": [],
      "context_before": [
        "    // Note: This tracks google top site tile tap which opens a google search page",
        "    func trackGoogleTopSiteTap() {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/SearchTelemetry.swift",
      "line": 207,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        GleanMetrics.Search.inContent[\"\\(SearchEngine.google).in-content.google-topsite-follow-on.\\(code)\"].add()"
      ],
      "ecosia_code": [],
      "context_before": [
        "    // Flow: User taps google top site tile -> google page opens -> user types item to search in the page",
        "    func trackGoogleTopSiteFollowOn() {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/SponsoredTileTelemetry.swift",
      "line": 6,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "import Glean"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "import Foundation"
      ],
      "context_after": [
        "",
        "// Telemetry for the Sponsored tiles located in the Top sites on the Firefox home page"
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/SponsoredTileTelemetry.swift",
      "line": 17,
      "type": "removal",
      "comment": "remove Glean dependency",
      "firefox_code": [
        "        let extra = GleanMetrics.TopSites.ContileImpressionExtra(",
        "            position: Int32(position),",
        "            source: SponsoredTileTelemetry.source",
        "        )",
        "        GleanMetrics.TopSites.contileImpression.record(extra)",
        "        GleanMetrics.TopSites.contileTileId.set(Int64(tile.tileId))",
        "        GleanMetrics.TopSites.contileAdvertiser.set(tile.title)",
        "        GleanMetrics.TopSites.contileReportingUrl.set(tile.impressionURL)",
        "        GleanMetrics.Pings.shared.topsitesImpression.submit()"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    static func sendImpressionTelemetry(tile: SponsoredTile, position: Int) {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/SponsoredTileTelemetry.swift",
      "line": 32,
      "type": "removal",
      "comment": "remove Glean dependency",
      "firefox_code": [
        "        let extra = GleanMetrics.TopSites.ContileClickExtra(",
        "            position: Int32(position),",
        "            source: SponsoredTileTelemetry.source",
        "        )",
        "        GleanMetrics.TopSites.contileClick.record(extra)",
        "        GleanMetrics.TopSites.contileTileId.set(Int64(tile.tileId))",
        "        GleanMetrics.TopSites.contileAdvertiser.set(tile.title)",
        "        GleanMetrics.TopSites.contileReportingUrl.set(tile.clickURL)",
        "        GleanMetrics.Pings.shared.topsitesImpression.submit()"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    static func sendClickTelemetry(tile: SponsoredTile, position: Int) {"
      ],
      "context_after": [
        "    }",
        "}"
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/TabsTelemetry.swift",
      "line": 6,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "import Glean"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "import Foundation"
      ],
      "context_after": [
        "",
        "final class TabsTelemetry {"
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/TabsTelemetry.swift",
      "line": 11,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "    /// Measure with a time distribution https://mozilla.github.io/glean/book/reference/metrics/timing_distribution.html",
        "    /// how long it takes to switch to a new tab",
        "    private var tabSwitchTimerId: GleanTimerId?"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "final class TabsTelemetry {"
      ],
      "context_after": [
        "",
        "    func startTabSwitchMeasurement() {"
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/TabsTelemetry.swift",
      "line": 18,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        tabSwitchTimerId = GleanMetrics.Tabs.tabSwitch.start()"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func startTabSwitchMeasurement() {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/TabsTelemetry.swift",
      "line": 24,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        guard let timerId = tabSwitchTimerId else { return }",
        "        GleanMetrics.Tabs.tabSwitch.stopAndAccumulate(timerId)",
        "        tabSwitchTimerId = nil"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func stopTabSwitchMeasurement() {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/TelemetryContextualIdentifier.swift",
      "line": 6,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "import Glean"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "import Foundation"
      ],
      "context_after": [
        "",
        "// Contextual identifier used for the sponsored tiles in top sites and the suggestions in the search view"
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/TelemetryContextualIdentifier.swift",
      "line": 28,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "            GleanMetrics.TopSites.contextId.set(clientUUID)"
      ],
      "ecosia_code": [],
      "context_before": [
        "        // Use existing client UUID, if doesn't exists create a new one",
        "        if let stringContextId = contextId, let clientUUID = UUID(uuidString: stringContextId) {"
      ],
      "context_after": [
        "        } else {",
        "            let newUUID = UUID()"
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/TelemetryContextualIdentifier.swift",
      "line": 33,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "            GleanMetrics.TopSites.contextId.set(newUUID)"
      ],
      "ecosia_code": [],
      "context_before": [
        "        } else {",
        "            let newUUID = UUID()"
      ],
      "context_after": [
        "            contextId = newUUID.uuidString",
        "        }"
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/TelemetryWrapper.swift",
      "line": 8,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "import Glean"
      ],
      "ecosia_code": [],
      "context_before": [
        "// swiftlint:disable line_length",
        "import Common"
      ],
      "context_after": [
        "import Shared",
        "import Account"
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/TelemetryWrapper.swift",
      "line": 50,
      "type": "removal",
      "comment": "remove Glean dependency",
      "firefox_code": [
        "    let glean = Glean.shared"
      ],
      "ecosia_code": [],
      "context_before": [
        "    static let shared = TelemetryWrapper()",
        ""
      ],
      "context_after": [
        "",
        "    // Boolean flag to temporarily remember if we crashed during the"
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/TelemetryWrapper.swift",
      "line": 100,
      "type": "removal",
      "comment": "remove Glean dependency",
      "firefox_code": [
        "        // Record default search engine setting to avoid sending a `null` value.",
        "        // If there's no default search engine, (there's not, at this point), we will",
        "        // send \"unavailable\" in order not to send `null`, but still differentiate",
        "        // the event in the startup sequence.",
        "        let defaultEngine = profile.searchEnginesManager.defaultEngine",
        "        GleanMetrics.Search.defaultEngine.set(defaultEngine?.engineID ?? \"unavailable\")",
        "        // Get the legacy telemetry ID and record it in Glean for the deletion-request ping",
        "        if let uuidString = UserDefaults.standard.string(forKey: \"telemetry-key-prefix-clientId\"), let uuid = UUID(uuidString: uuidString) {",
        "            GleanMetrics.LegacyIds.clientId.set(uuid)",
        "        }",
        "        glean.registerPings(GleanMetrics.Pings.shared)",
        "        // Initialize Glean telemetry",
        "        let gleanConfig = Configuration(",
        "            channel: AppConstants.buildChannel.rawValue,",
        "            logLevel: .off,",
        "            pingSchedule: [\"baseline\": [\"dau-reporting\"]]",
        "        )",
        "        glean.initialize(uploadEnabled: sendUsageData,",
        "                         configuration: gleanConfig,",
        "                         buildInfo: GleanMetrics.GleanBuild.info)",
        "        // Set the metric configuration from Nimbus.",
        "        glean.applyServerKnobsConfig(FxNimbus.shared.features.gleanServerKnobs.value().toJSONString())",
        "        // Save the profile so we can record settings from it when the notification below fires.",
        "        self.profile = profile",
        "        TelemetryContextualIdentifier.setupContextId()",
        "        // Register an observer to record settings and other metrics that are more appropriate to",
        "        // record on going to background rather than during initialization.",
        "        NotificationCenter.default.addObserver(",
        "            self,",
        "            selector: #selector(recordEnteredBackgroundPreferenceMetrics(notification:)),",
        "            name: UIApplication.didEnterBackgroundNotification,",
        "            object: nil",
        "        )",
        "        NotificationCenter.default.addObserver(",
        "            self,",
        "            selector: #selector(recordFinishedLaunchingPreferenceMetrics(notification:)),",
        "            name: UIApplication.didFinishLaunchingNotification,",
        "            object: nil",
        "        )"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func initGlean(_ profile: Profile, sendUsageData: Bool) {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/TelemetryWrapper.swift",
      "line": 153,
      "type": "removal",
      "comment": "remove Glean dependency",
      "firefox_code": [
        "        guard let profile = self.profile else { return }",
        "        // Pocket stories visible",
        "        if let pocketStoriesVisible = profile.prefs.boolForKey(PrefsKeys.UserFeatureFlagPrefs.ASPocketStories) {",
        "            GleanMetrics.FirefoxHomePage.pocketStoriesVisible.set(pocketStoriesVisible)",
        "        } else {",
        "            GleanMetrics.FirefoxHomePage.pocketStoriesVisible.set(true)",
        "        }"
      ],
      "ecosia_code": [],
      "context_before": [
        "    @objc",
        "    func recordFinishedLaunchingPreferenceMetrics(notification: NSNotification) {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/TelemetryWrapper.swift",
      "line": 168,
      "type": "removal",
      "comment": "remove Glean dependency",
      "firefox_code": [
        "        guard let profile = self.profile else {",
        "            assertionFailure(\"Error unwrapping profile\")",
        "            return",
        "        }",
        "        // Record default search engine setting",
        "        let defaultEngine = profile.searchEnginesManager.defaultEngine",
        "        GleanMetrics.Search.defaultEngine.set(defaultEngine?.engineID ?? \"custom\")",
        "        // Record the open tab count",
        "        let windowManager: WindowManager = AppContainer.shared.resolve()",
        "        let tabCount = windowManager.allWindowTabManagers().map({ $0.count }).reduce(0, +)",
        "        GleanMetrics.Tabs.cumulativeCount.add(Int32(tabCount))",
        "        // Record other preference settings.",
        "        // If the setting exists at the key location, use that value. Otherwise record the default",
        "        // value for that preference to ensure it makes it into the metrics ping.",
        "        let prefs = profile.prefs",
        "        // FxA Account Login status",
        "        GleanMetrics.Preferences.fxaLoggedIn.set(profile.hasSyncableAccount())",
        "        // Record New Tab setting",
        "        if let newTabChoice = prefs.stringForKey(NewTabAccessors.HomePrefKey) {",
        "            GleanMetrics.Preferences.newTabExperience.set(newTabChoice)",
        "        } else {",
        "            GleanMetrics.Preferences.newTabExperience.set(NewTabAccessors.Default.rawValue)",
        "        }",
        "        // Record `Home` setting, where Firefox Home is \"Home\", a custom URL is \"other\" and blank is \"Blank\".",
        "        let homePageSetting = NewTabAccessors.getHomePage(prefs)",
        "        switch homePageSetting {",
        "        case .topSites:",
        "            let firefoxHome = \"Home\"",
        "            GleanMetrics.Preferences.homePageSetting.set(firefoxHome)",
        "        case .homePage:",
        "            let customUrl = \"other\"",
        "            GleanMetrics.Preferences.homePageSetting.set(customUrl)",
        "        default:",
        "            GleanMetrics.Preferences.homePageSetting.set(homePageSetting.rawValue)",
        "        }",
        "        // Notifications",
        "        GleanMetrics.Preferences.tipsAndFeaturesNotifs.set(UserDefaults.standard.bool(forKey: PrefsKeys.Notifications.TipsAndFeaturesNotifications))",
        "        GleanMetrics.Preferences.syncNotifs.set(UserDefaults.standard.bool(forKey: PrefsKeys.Notifications.SyncNotifications))",
        "        // Save logins",
        "        if let saveLogins = prefs.boolForKey(PrefsKeys.LoginsSaveEnabled) {",
        "            GleanMetrics.Preferences.saveLogins.set(saveLogins)",
        "        } else {",
        "            GleanMetrics.Preferences.saveLogins.set(true)",
        "        }",
        "        // Show clipboard bar",
        "        if let showClipboardBar = prefs.boolForKey(\"showClipboardBar\") {",
        "            GleanMetrics.Preferences.showClipboardBar.set(showClipboardBar)",
        "        } else {",
        "            GleanMetrics.Preferences.showClipboardBar.set(false)",
        "        }",
        "        // Close private tabs",
        "        if let closePrivateTabs = prefs.boolForKey(PrefsKeys.Settings.closePrivateTabs) {",
        "            GleanMetrics.Preferences.closePrivateTabs.set(closePrivateTabs)",
        "        } else {",
        "            GleanMetrics.Preferences.closePrivateTabs.set(false)",
        "        }",
        "        // Tracking protection - enabled",
        "        if let tpEnabled = prefs.boolForKey(ContentBlockingConfig.Prefs.EnabledKey) {",
        "            GleanMetrics.TrackingProtection.enabled.set(tpEnabled)",
        "        } else {",
        "            GleanMetrics.TrackingProtection.enabled.set(true)",
        "        }",
        "        // Tracking protection - strength",
        "        if let tpStrength = prefs.stringForKey(ContentBlockingConfig.Prefs.StrengthKey) {",
        "            GleanMetrics.TrackingProtection.strength.set(tpStrength)",
        "        } else {",
        "            GleanMetrics.TrackingProtection.strength.set(\"basic\")",
        "        }",
        "        // Installed Mozilla applications",
        "        GleanMetrics.InstalledMozillaProducts.focus.set(UIApplication.shared.canOpenURL(URL(string: \"firefox-focus://\")!))",
        "        GleanMetrics.InstalledMozillaProducts.klar.set(UIApplication.shared.canOpenURL(URL(string: \"firefox-klar://\")!))",
        "        // Device Authentication",
        "        GleanMetrics.Device.authentication.set(AppAuthenticator().canAuthenticateDeviceOwner)",
        "        // Wallpapers",
        "        let currentWallpaper = WallpaperManager().currentWallpaper",
        "        if case .other = currentWallpaper.type {",
        "            // Need to lowercase the name for labeled counter. Ref:",
        "            // https://mozilla.github.io/glean/book/reference/metrics/index.html#label-format)",
        "            GleanMetrics.WallpaperAnalytics.themedWallpaper[currentWallpaper.id.lowercased()].add()",
        "        }",
        "        // Homepage section preferences",
        "        let isJumpBackInEnabled = featureFlags.isFeatureEnabled(.jumpBackIn, checking: .buildAndUser)",
        "        GleanMetrics.Preferences.jumpBackIn.set(isJumpBackInEnabled)",
        "        let isRecentlyVisitedEnabled = featureFlags.isFeatureEnabled(.historyHighlights, checking: .buildAndUser)",
        "        GleanMetrics.Preferences.recentlyVisited.set(isRecentlyVisitedEnabled)",
        "        let isBookmarksEnabled = prefs.boolForKey(PrefsKeys.UserFeatureFlagPrefs.BookmarksSection) ?? true",
        "        GleanMetrics.Preferences.recentlySaved.set(isBookmarksEnabled)",
        "        let isFeatureEnabled = prefs.boolForKey(PrefsKeys.UserFeatureFlagPrefs.ASPocketStories) ?? true",
        "        let isPocketEnabled = isFeatureEnabled && PocketProvider.islocaleSupported(Locale.current.identifier)",
        "        GleanMetrics.Preferences.pocket.set(isPocketEnabled)",
        "        let startAtHomeOption = prefs.stringForKey(PrefsKeys.UserFeatureFlagPrefs.StartAtHome) ?? StartAtHomeSetting.afterFourHours.rawValue",
        "        GleanMetrics.Preferences.openingScreen.set(startAtHomeOption)"
      ],
      "ecosia_code": [],
      "context_before": [
        "    @objc",
        "    func recordEnteredBackgroundPreferenceMetrics(notification: NSNotification) {"
      ],
      "context_after": [
        "    }",
        "}"
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/TelemetryWrapper.swift",
      "line": 814,
      "type": "removal",
      "comment": "remove Glean dependency",
      "firefox_code": [
        "        switch (category, method, object, value, extras) {",
        "        // MARK: Bookmarks",
        "        case (.action, .view, .bookmarksPanel, let from?, _):",
        "            GleanMetrics.Bookmarks.viewList[from.rawValue].add()",
        "        case (.action, .add, .bookmark, let from?, _):",
        "            GleanMetrics.Bookmarks.add[from.rawValue].add()",
        "        case (.action, .delete, .bookmark, let from?, _):",
        "            GleanMetrics.Bookmarks.delete[from.rawValue].add()",
        "        case (.action, .open, .bookmark, let from?, _):",
        "            GleanMetrics.Bookmarks.open[from.rawValue].add()",
        "        case (.action, .change, .bookmark, let from?, _):",
        "            GleanMetrics.Bookmarks.edit[from.rawValue].add()",
        "        case(.information, .view, .mobileBookmarks, .doesHaveMobileBookmarks, _):",
        "            GleanMetrics.Bookmarks.hasMobileBookmarks.set(true)",
        "        case(.information, .view, .mobileBookmarks, .doesNotHaveMobileBookmarks, _):",
        "            GleanMetrics.Bookmarks.hasMobileBookmarks.set(false)",
        "        case(.information, .view, .mobileBookmarks, .mobileBookmarksCount, let extras):",
        "            if let quantity = extras?[EventExtraKey.mobileBookmarksQuantity.rawValue] as? Int64 {",
        "                GleanMetrics.Bookmarks.mobileBookmarksCount.set(quantity)",
        "            }",
        "        case(.action, .tap, .bookmark, .bookmarkAddFolder, _):",
        "            GleanMetrics.Bookmarks.folderAdd.record()",
        "        // MARK: Reader Mode",
        "        case (.action, .tap, .readerModeOpenButton, _, _):",
        "            GleanMetrics.ReaderMode.open.add()",
        "        case (.action, .tap, .readerModeCloseButton, _, _):",
        "            GleanMetrics.ReaderMode.close.add()",
        "        // MARK: Reading List",
        "        case (.action, .add, .readingListItem, let from?, _):",
        "            GleanMetrics.ReadingList.add[from.rawValue].add()",
        "        case (.action, .delete, .readingListItem, let from?, _):",
        "            GleanMetrics.ReadingList.delete[from.rawValue].add()",
        "        case (.action, .open, .readingListItem, _, _):",
        "            GleanMetrics.ReadingList.open.add()",
        "        // MARK: History",
        "        case(.information, .view, .historyPanelOpened, _, _):",
        "            GleanMetrics.History.opened.record()",
        "        case(.action, .swipe, .historySingleItemRemoved, _, _):",
        "            GleanMetrics.History.removed.record()",
        "        case(.action, .tap, .historyRemovedToday, _, _):",
        "            GleanMetrics.History.removedToday.record()",
        "        case(.action, .tap, .historyRemovedTodayAndYesterday, _, _):",
        "            GleanMetrics.History.removedTodayAndYesterday.record()",
        "        case(.action, .tap, .historyRemovedAll, _, _):",
        "            GleanMetrics.History.removedAll.record()",
        "        // MARK: Top Site",
        "        case (.action, .tap, .topSiteTile, _, let extras):",
        "            if let homePageOrigin = extras?[EventExtraKey.fxHomepageOrigin.rawValue] as? String {",
        "                GleanMetrics.TopSites.pressedTileOrigin[homePageOrigin].add()",
        "            }",
        "            if let position = extras?[EventExtraKey.topSitePosition.rawValue] as? String, let tileType = extras?[EventExtraKey.topSiteTileType.rawValue] as? String {",
        "                GleanMetrics.TopSites.tilePressed.record(GleanMetrics.TopSites.TilePressedExtra(position: position, tileType: tileType))",
        "            } else {",
        "                recordUninstrumentedMetrics(category: category, method: method, object: object, value: value, extras: extras)",
        "            }",
        "        case (.action, .view, .topSiteContextualMenu, _, let extras):",
        "            if let type = extras?[EventExtraKey.contextualMenuType.rawValue] as? String {",
        "                GleanMetrics.TopSites.contextualMenu.record(GleanMetrics.TopSites.ContextualMenuExtra(type: type))",
        "            } else {",
        "                recordUninstrumentedMetrics(category: category, method: method, object: object, value: value, extras: extras)",
        "            }",
        "        case (.action, .tap, .newPrivateTab, .topSite, _):",
        "            GleanMetrics.TopSites.openInPrivateTab.record()",
        "        // MARK: Preferences",
        "        case (.action, .change, .setting, _, let extras):",
        "            if let preference = extras?[EventExtraKey.preference.rawValue] as? String,",
        "                let to = ((extras?[EventExtraKey.preferenceChanged.rawValue]) ?? \"undefined\") as? String {",
        "                GleanMetrics.Preferences.changed.record(GleanMetrics.Preferences.ChangedExtra(changedTo: to,",
        "                                                                                              preference: preference))",
        "            } else if let preference = extras?[EventExtraKey.preference.rawValue] as? String,",
        "                        let to = ((extras?[EventExtraKey.preferenceChanged.rawValue]) ?? \"undefined\") as? Bool {",
        "                GleanMetrics.Preferences.changed.record(GleanMetrics.Preferences.ChangedExtra(changedTo: to.description,",
        "                                                                                              preference: preference))",
        "            } else {",
        "                recordUninstrumentedMetrics(category: category, method: method, object: object, value: value, extras: extras)",
        "            }",
        "        case (.action, .tap, .privateBrowsingButton, _, let extras):",
        "            if let isPrivate = extras?[EventExtraKey.isPrivate.rawValue] as? String {",
        "                let isPrivateExtra = GleanMetrics.Preferences.PrivateBrowsingButtonTappedExtra(isPrivate: isPrivate)",
        "                GleanMetrics.Preferences.privateBrowsingButtonTapped.record(isPrivateExtra)",
        "            } else {",
        "                recordUninstrumentedMetrics(",
        "                    category: category,",
        "                    method: method,",
        "                    object: object,",
        "                    value: value,",
        "                    extras: extras)",
        "            }",
        "        // MARK: - QR Codes",
        "        case (.action, .scan, .qrCodeText, _, _),",
        "             (.action, .scan, .qrCodeURL, _, _):",
        "            GleanMetrics.QrCode.scanned.add()",
        "        // MARK: Tabs",
        "        case (.action, .add, .tab, let privateOrNormal?, _):",
        "            GleanMetrics.Tabs.open[privateOrNormal.rawValue].add()",
        "        case (.action, .close, .tab, let privateOrNormal?, _):",
        "            GleanMetrics.Tabs.close[privateOrNormal.rawValue].add()",
        "        case (.action, .closeAll, .tab, let privateOrNormal?, _):",
        "            GleanMetrics.Tabs.closeAll[privateOrNormal.rawValue].add()",
        "        case (.action, .tap, .addNewTabButton, _, _):",
        "            GleanMetrics.Tabs.newTabPressed.add()",
        "        case (.action, .tap, .tab, _, _):",
        "            GleanMetrics.Tabs.clickTab.record()",
        "        case (.action, .open, .tabTray, _, _):",
        "            GleanMetrics.Tabs.openTabTray.record()",
        "        case (.action, .close, .tabTray, _, _):",
        "            GleanMetrics.Tabs.closeTabTray.record()",
        "        case (.action, .press, .tabToolbar, .tabView, _):",
        "            GleanMetrics.Tabs.pressTabToolbar.record()",
        "        case (.action, .press, .tab, _, _):",
        "            GleanMetrics.Tabs.pressTopTab.record()",
        "        case(.action, .pull, .reload, _, _):",
        "            GleanMetrics.Tabs.pullToRefresh.add()",
        "        case(.action, .navigate, .tab, _, _):",
        "            GleanMetrics.Tabs.normalAndPrivateUriCount.add()",
        "        case(.action, .tap, .navigateTabHistoryBack, _, _), (.action, .press, .navigateTabHistoryBack, _, _):",
        "            GleanMetrics.Tabs.navigateTabHistoryBack.add()",
        "        case(.action, .tap, .navigateTabHistoryForward, _, _), (.action, .press, .navigateTabHistoryForward, _, _):",
        "            GleanMetrics.Tabs.navigateTabHistoryForward.add()",
        "        case(.action, .swipe, .navigateTabHistoryBackSwipe, _, _):",
        "            GleanMetrics.Tabs.navigateTabBackSwipe.add()",
        "        case(.action, .tap, .reloadFromUrlBar, _, _):",
        "            GleanMetrics.Tabs.reloadFromUrlBar.add()",
        "        case(.action, .tap, .restoreTabsAlert, _, let extras):",
        "            if let isEnabled = extras?[EventExtraKey.isRestoreTabsStarted.rawValue] as? Bool {",
        "                let isEnabledExtra = GleanMetrics.Tabs.RestoreTabsAlertExtra(isEnabled: isEnabled)",
        "                GleanMetrics.Tabs.restoreTabsAlert.record(isEnabledExtra)",
        "            } else {",
        "                recordUninstrumentedMetrics(",
        "                    category: category,",
        "                    method: method,",
        "                    object: object,",
        "                    value: value,",
        "                    extras: extras)",
        "            }",
        "        case(.information, .background, .iPadWindowCount, _, let extras):",
        "            if let quantity = extras?[EventExtraKey.windowCount.rawValue] as? Int64 {",
        "                GleanMetrics.Windows.ipadWindowCount.set(quantity)",
        "            } else {",
        "                recordUninstrumentedMetrics(category: category, method: method, object: object, value: value, extras: extras)",
        "            }",
        "        case(.information, .background, .tabNormalQuantity, _, let extras):",
        "            if let quantity = extras?[EventExtraKey.tabsQuantity.rawValue] as? Int64 {",
        "                GleanMetrics.Tabs.normalTabsQuantity.set(quantity)",
        "            } else {",
        "                recordUninstrumentedMetrics(category: category, method: method, object: object, value: value, extras: extras)",
        "            }",
        "        case(.information, .background, .tabPrivateQuantity, _, let extras):",
        "            if let quantity = extras?[EventExtraKey.tabsQuantity.rawValue] as? Int64 {",
        "                GleanMetrics.Tabs.privateTabsQuantity.set(quantity)",
        "            } else {",
        "                recordUninstrumentedMetrics(category: category, method: method, object: object, value: value, extras: extras)",
        "            }",
        "        case(.information, .background, .tabInactiveQuantity, _, let extras):",
        "            if let quantity = extras?[EventExtraKey.tabsQuantity.rawValue] as? Int64 {",
        "                GleanMetrics.Tabs.inactiveTabsCount.set(quantity)",
        "            } else {",
        "                recordUninstrumentedMetrics(category: category, method: method, object: object, value: value, extras: extras)",
        "            }",
        "        // MARK: Address",
        "        case(.information, .foreground, .addressAutofillSettings, _, let extras):",
        "            if let quantity = extras?[TelemetryWrapper.EventExtraKey.AddressTelemetry.count.rawValue] as? Int64 {",
        "                GleanMetrics.Addresses.savedAll.set(quantity)",
        "            } else {",
        "                recordUninstrumentedMetrics(category: category, method: method, object: object, value: value, extras: extras)",
        "            }",
        "        case(.action, .tap, .addressAutofillSettings, _, _):",
        "            GleanMetrics.Addresses.settingsAutofill.record()",
        "        case(.action, .view, .addressAutofillPromptShown, _, _):",
        "            GleanMetrics.Addresses.autofillPromptShown.record()",
        "        case(.action, .tap, .addressAutofillPromptExpanded, _, _):",
        "            GleanMetrics.Addresses.autofillPromptExpanded.record()",
        "        case(.action, .close, .addressAutofillPromptDismissed, _, _):",
        "            GleanMetrics.Addresses.autofillPromptDismissed.record()",
        "        case(.action, .change, .addressFormFilledModified, _, _):",
        "            GleanMetrics.Addresses.modified.record()",
        "        case(.action, .detect, .addressFormFilled, _, _):",
        "            GleanMetrics.Addresses.autofilled.record()",
        "        case(.action, .detect, .addressForm, _, _):",
        "            GleanMetrics.Addresses.formDetected.record()",
        "        // MARK: Credit Card",
        "        case(.action, .tap, .creditCardAutofillSettings, _, _):",
        "            GleanMetrics.CreditCard.autofillSettingsTapped.record()",
        "        case(.action, .tap, .creditCardFormDetected, _, _):",
        "            GleanMetrics.CreditCard.formDetected.record()",
        "        case(.action, .tap, .creditCardAutofilled, _, _):",
        "            GleanMetrics.CreditCard.autofilled.record()",
        "        case(.action, .tap, .creditCardAutofillFailed, _, _):",
        "            GleanMetrics.CreditCard.autofillFailed.record()",
        "        case(.action, .tap, .creditCardSavePromptCreate, _, _):",
        "            GleanMetrics.CreditCard.savePromptCreate.record()",
        "        case(.information, .settings, .creditCardAutofillEnabled, _, let extras):",
        "            if let isEnabled = extras?[EventExtraKey.isCreditCardAutofillEnabled.rawValue]",
        "                as? Bool {",
        "                GleanMetrics.CreditCard.autofillEnabled.set(isEnabled)",
        "            } else {",
        "                recordUninstrumentedMetrics(",
        "                    category: category,",
        "                    method: method,",
        "                    object: object,",
        "                    value: value,",
        "                    extras: extras)",
        "            }",
        "        case(.information, .settings, .creditCardSyncEnabled, _, let extras):",
        "            if let isEnabled = extras?[EventExtraKey.isCreditCardSyncEnabled.rawValue]",
        "                as? Bool {",
        "                GleanMetrics.CreditCard.syncEnabled.set(isEnabled)",
        "            } else {",
        "                recordUninstrumentedMetrics(",
        "                    category: category,",
        "                    method: method,",
        "                    object: object,",
        "                    value: value,",
        "                    extras: extras)",
        "            }",
        "        case(.action, .tap, .creditCardAutofillToggle, _, let extras):",
        "            if let isEnabled = extras?[EventExtraKey.isCreditCardAutofillToggleEnabled.rawValue]",
        "                as? Bool {",
        "                let isEnabledExtra = GleanMetrics.CreditCard.AutofillToggleExtra(isEnabled: isEnabled)",
        "                GleanMetrics.CreditCard.autofillToggle.record(isEnabledExtra)",
        "            } else {",
        "                recordUninstrumentedMetrics(",
        "                    category: category,",
        "                    method: method,",
        "                    object: object,",
        "                    value: value,",
        "                    extras: extras)",
        "            }",
        "        case(.action, .tap, .creditCardSyncToggle, _, let extras):",
        "            if let isEnabled = extras?[EventExtraKey.isCreditCardSyncToggleEnabled.rawValue]",
        "                as? Bool {",
        "                let isEnabledExtra = GleanMetrics.CreditCard.SyncToggleExtra(isEnabled: isEnabled)",
        "                GleanMetrics.CreditCard.syncToggle.record(isEnabledExtra)",
        "            } else {",
        "                recordUninstrumentedMetrics(",
        "                    category: category,",
        "                    method: method,",
        "                    object: object,",
        "                    value: value,",
        "                    extras: extras)",
        "            }",
        "        case(.action, .view, .creditCardAutofillPromptShown, _, _):",
        "            GleanMetrics.CreditCard.autofillPromptShown.record()",
        "        case(.action, .tap, .creditCardAutofillPromptExpanded, _, _):",
        "            GleanMetrics.CreditCard.autofillPromptExpanded.record()",
        "        case(.action, .close, .creditCardAutofillPromptDismissed, _, _):",
        "            GleanMetrics.CreditCard.autofillPromptDismissed.record()",
        "        case(.action, .view, .creditCardSavePromptShown, _, _):",
        "            GleanMetrics.CreditCard.savePromptShown.record()",
        "        case(.action, .tap, .creditCardSavePromptUpdate, _, _):",
        "            GleanMetrics.CreditCard.savePromptUpdate.record()",
        "        case(.action, .tap, .creditCardManagementAddTapped, _, _):",
        "            GleanMetrics.CreditCard.managementAddTapped.record()",
        "        case(.action, .tap, .creditCardManagementCardTapped, _, _):",
        "            GleanMetrics.CreditCard.managementCardTapped.record()",
        "        case(.action, .add, .creditCardSaved, _, _):",
        "            GleanMetrics.CreditCard.saved.add()",
        "        case(.information, .foreground, .creditCardSavedAll, _, let extras):",
        "            if let quantity = extras?[EventExtraKey.creditCardsQuantity.rawValue] as? Int64 {",
        "                GleanMetrics.CreditCard.savedAll.set(quantity)",
        "            } else {",
        "                recordUninstrumentedMetrics(category: category, method: method, object: object, value: value, extras: extras)",
        "            }",
        "        case(.action, .delete, .creditCardDeleted, _, _):",
        "            GleanMetrics.CreditCard.deleted.add()",
        "        case(.action, .change, .creditCardModified, _, _):",
        "            GleanMetrics.CreditCard.modified.add()",
        "        // MARK: Settings Menu",
        "        case (.action, .open, .settingsMenuSetAsDefaultBrowser, _, _):",
        "            GleanMetrics.SettingsMenu.setAsDefaultBrowserPressed.add()",
        "        case(.action, .open, .settingsMenuPasswords, _, _):",
        "            GleanMetrics.SettingsMenu.passwords.record()",
        "        case(.action, .tap, .settingsMenuShowTour, _, _):",
        "            GleanMetrics.SettingsMenu.showTourPressed.record()",
        "        // MARK: Logins and Passwords",
        "        case(.action, .view, .loginsAutofillPromptShown, _, _):",
        "            GleanMetrics.Logins.autofillPromptShown.record()",
        "        case(.action, .tap, .loginsAutofillPromptExpanded, _, _):",
        "            GleanMetrics.Logins.autofillPromptExpanded.record()",
        "        case(.action, .close, .loginsAutofillPromptDismissed, _, _):",
        "            GleanMetrics.Logins.autofillPromptDismissed.record()",
        "        case(.action, .tap, .loginsAutofilled, _, _):",
        "            GleanMetrics.Logins.autofilled.record()",
        "        case(.action, .tap, .loginsAutofillFailed, _, _):",
        "            GleanMetrics.Logins.autofillFailed.record()",
        "        case(.action, .tap, .loginsManagementAddTapped, _, _):",
        "            GleanMetrics.Logins.managementAddTapped.record()",
        "        case(.action, .tap, .loginsManagementLoginsTapped, _, _):",
        "            GleanMetrics.Logins.managementLoginsTapped.record()",
        "        case(.action, .add, .loginsSaved, _, _):",
        "            GleanMetrics.Logins.saved.add()",
        "        case(.information, .foreground, .loginsSavedAll, _, let extras):",
        "            if let quantity = extras?[EventExtraKey.loginsQuantity.rawValue] as? Int64 {",
        "                GleanMetrics.Logins.savedAll.set(quantity)",
        "            } else {",
        "                recordUninstrumentedMetrics(category: category, method: method, object: object, value: value, extras: extras)",
        "            }",
        "        case(.action, .delete, .loginsDeleted, _, _):",
        "            GleanMetrics.Logins.deleted.add()",
        "        case(.action, .change, .loginsModified, _, _):",
        "            GleanMetrics.Logins.modified.add()",
        "        case(.action, .tap, .loginsSyncEnabled, _, let extras):",
        "            if let isEnabled = extras?[EventExtraKey.isLoginSyncEnabled.rawValue] as? Bool {",
        "                let isEnabledExtra = GleanMetrics.Logins.SyncEnabledExtra(isEnabled: isEnabled)",
        "                GleanMetrics.Logins.syncEnabled.record(isEnabledExtra)",
        "            } else {",
        "                recordUninstrumentedMetrics(",
        "                    category: category,",
        "                    method: method,",
        "                    object: object,",
        "                    value: value,",
        "                    extras: extras)",
        "            }",
        "        // MARK: - Search Engine",
        "        case(.information, .change, .defaultSearchEngine, _, let extras):",
        "            if let searchEngineID = extras?[EventExtraKey.recordSearchEngineID.rawValue] as? String? ?? \"custom\" {",
        "                GleanMetrics.Search.defaultEngine.set(searchEngineID)",
        "            } else {",
        "                recordUninstrumentedMetrics(",
        "                    category: category,",
        "                    method: method,",
        "                    object: object,",
        "                    value: value,",
        "                    extras: extras)",
        "            }",
        "        // MARK: Start Search Button",
        "        case (.action, .tap, .startSearchButton, _, _):",
        "            GleanMetrics.Search.startSearchPressed.add()",
        "        case(.action, .tap, .recordSearch, _, let extras):",
        "            if let searchLocation = extras?[EventExtraKey.recordSearchLocation.rawValue]",
        "                as? SearchLocation,",
        "               let searchEngineID = extras?[EventExtraKey.recordSearchEngineID.rawValue] as? String? ?? \"custom\" {",
        "                GleanMetrics.Search.counts[\"\\(searchEngineID).\\(searchLocation.rawValue)\"].add()",
        "            } else {",
        "                recordUninstrumentedMetrics(",
        "                    category: category,",
        "                    method: method,",
        "                    object: object,",
        "                    value: value,",
        "                    extras: extras)",
        "            }",
        "        // MARK: Awesomebar Search Results",
        "        case(.information, .view, .urlbarImpression, _, let extras):",
        "            if let groups = extras?[EventExtraKey.UrlbarTelemetry.groups.rawValue] as? String,",
        "               let interaction = extras?[EventExtraKey.UrlbarTelemetry.interaction.rawValue] as? String,",
        "               let nChars = extras?[EventExtraKey.UrlbarTelemetry.nChars.rawValue] as? Int32,",
        "               let nResults = extras?[EventExtraKey.UrlbarTelemetry.nResults.rawValue] as? Int32,",
        "               let nWords = extras?[EventExtraKey.UrlbarTelemetry.nWords.rawValue] as? Int32,",
        "               let reason = extras?[EventExtraKey.UrlbarTelemetry.reason.rawValue] as? String,",
        "               let results = extras?[EventExtraKey.UrlbarTelemetry.results.rawValue] as? String,",
        "               let sap = extras?[EventExtraKey.UrlbarTelemetry.sap.rawValue] as? String,",
        "               let searchMode = extras?[EventExtraKey.UrlbarTelemetry.searchMode.rawValue] as? String {",
        "                let extraDetails = GleanMetrics.Urlbar.ImpressionExtra(groups: groups,",
        "                                                                       interaction: interaction,",
        "                                                                       nChars: nChars,",
        "                                                                       nResults: nResults,",
        "                                                                       nWords: nWords,",
        "                                                                       reason: reason,",
        "                                                                       results: results,",
        "                                                                       sap: sap,",
        "                                                                       searchMode: searchMode)",
        "                GleanMetrics.Urlbar.impression.record(extraDetails)",
        "            } else {",
        "                recordUninstrumentedMetrics(",
        "                    category: category,",
        "                    method: method,",
        "                    object: object,",
        "                    value: value,",
        "                    extras: extras)",
        "            }",
        "        case(.action, .tap, .urlbarEngagement, _, let extras):",
        "            if let groups = extras?[EventExtraKey.UrlbarTelemetry.groups.rawValue] as? String,",
        "               let interaction = extras?[EventExtraKey.UrlbarTelemetry.interaction.rawValue] as? String,",
        "               let nChars = extras?[EventExtraKey.UrlbarTelemetry.nChars.rawValue] as? Int32,",
        "               let nResults = extras?[EventExtraKey.UrlbarTelemetry.nResults.rawValue] as? Int32,",
        "               let nWords = extras?[EventExtraKey.UrlbarTelemetry.nWords.rawValue] as? Int32,",
        "               let results = extras?[EventExtraKey.UrlbarTelemetry.results.rawValue] as? String,",
        "               let sap = extras?[EventExtraKey.UrlbarTelemetry.sap.rawValue] as? String,",
        "               let searchMode = extras?[EventExtraKey.UrlbarTelemetry.searchMode.rawValue] as? String,",
        "               let engagementType = extras?[EventExtraKey.UrlbarTelemetry.engagementType.rawValue] as? String,",
        "               let provider = extras?[EventExtraKey.UrlbarTelemetry.provider.rawValue] as? String,",
        "               let selectedResult = extras?[EventExtraKey.UrlbarTelemetry.selectedResult.rawValue] as? String,",
        "               let selectedResultSubtype = extras?[EventExtraKey.UrlbarTelemetry.selectedResultSubtype.rawValue] as? String {",
        "                let extraDetails = GleanMetrics.Urlbar.EngagementExtra(engagementType: engagementType,",
        "                                                                       groups: groups,",
        "                                                                       interaction: interaction,",
        "                                                                       nChars: nChars,",
        "                                                                       nResults: nResults,",
        "                                                                       nWords: nWords,",
        "                                                                       provider: provider,",
        "                                                                       results: results,",
        "                                                                       sap: sap,",
        "                                                                       searchMode: searchMode,",
        "                                                                       selectedResult: selectedResult,",
        "                                                                       selectedResultSubtype: selectedResultSubtype)",
        "                GleanMetrics.Urlbar.engagement.record(extraDetails)",
        "            } else {",
        "                recordUninstrumentedMetrics(",
        "                    category: category,",
        "                    method: method,",
        "                    object: object,",
        "                    value: value,",
        "                    extras: extras)",
        "            }",
        "        case(.action, .close, .urlbarAbandonment, _, let extras):",
        "            if let groups = extras?[EventExtraKey.UrlbarTelemetry.groups.rawValue] as? String,",
        "               let interaction = extras?[EventExtraKey.UrlbarTelemetry.interaction.rawValue] as? String,",
        "               let nChars = extras?[EventExtraKey.UrlbarTelemetry.nChars.rawValue] as? Int32,",
        "               let nResults = extras?[EventExtraKey.UrlbarTelemetry.nResults.rawValue] as? Int32,",
        "               let nWords = extras?[EventExtraKey.UrlbarTelemetry.nWords.rawValue] as? Int32,",
        "               let results = extras?[EventExtraKey.UrlbarTelemetry.results.rawValue] as? String,",
        "               let sap = extras?[EventExtraKey.UrlbarTelemetry.sap.rawValue] as? String,",
        "               let searchMode = extras?[EventExtraKey.UrlbarTelemetry.searchMode.rawValue] as? String {",
        "                let extraDetails = GleanMetrics.Urlbar.AbandonmentExtra(groups: groups,",
        "                                                                        interaction: interaction,",
        "                                                                        nChars: nChars,",
        "                                                                        nResults: nResults,",
        "                                                                        nWords: nWords,",
        "                                                                        results: results,",
        "                                                                        sap: sap,",
        "                                                                        searchMode: searchMode)",
        "                GleanMetrics.Urlbar.abandonment.record(extraDetails)",
        "            } else {",
        "                recordUninstrumentedMetrics(",
        "                    category: category,",
        "                    method: method,",
        "                    object: object,",
        "                    value: value,",
        "                    extras: extras)",
        "            }",
        "        // MARK: Default Browser",
        "        case (.action, .tap, .dismissDefaultBrowserCard, _, _):",
        "            GleanMetrics.DefaultBrowserCard.dismissPressed.add()",
        "        case (.action, .tap, .goToSettingsDefaultBrowserCard, _, _):",
        "            GleanMetrics.DefaultBrowserCard.goToSettingsPressed.add()",
        "        case (.action, .open, .asDefaultBrowser, _, _):",
        "            GleanMetrics.App.openedAsDefaultBrowser.add()",
        "        case(.action, .view, .notificationPermission, _, let extras):",
        "            if let status = extras?[EventExtraKey.notificationPermissionStatus.rawValue] as? String,",
        "               let alertSetting = extras?[EventExtraKey.notificationPermissionAlertSetting.rawValue] as? String {",
        "                let permissionExtra = GleanMetrics.App.NotificationPermissionExtra(alertSetting: alertSetting,",
        "                                                                                   status: status)",
        "                GleanMetrics.App.notificationPermission.record(permissionExtra)",
        "            } else {",
        "                recordUninstrumentedMetrics(",
        "                    category: category,",
        "                    method: method,",
        "                    object: object,",
        "                    value: value,",
        "                    extras: extras)",
        "            }",
        "        case (.action, .open, .defaultBrowser, _, let extras):",
        "            if let isDefaultBrowser = extras?[EventExtraKey.isDefaultBrowser.rawValue] as? Bool {",
        "                GleanMetrics.App.defaultBrowser.set(isDefaultBrowser)",
        "            }",
        "        case (.action, .open, .choiceScreenAcquisition, _, let extras):",
        "            if let choiceScreen = extras?[EventExtraKey.didComeFromBrowserChoiceScreen.rawValue] as? Bool {",
        "                GleanMetrics.App.choiceScreenAcquisition.set(choiceScreen)",
        "            }",
        "        case(.action, .tap, .engagementNotification, _, _):",
        "            GleanMetrics.Onboarding.engagementNotificationTapped.record()",
        "        case(.action, .cancel, .engagementNotification, _, _):",
        "            GleanMetrics.Onboarding.engagementNotificationCancel.record()",
        "        case (.action, .tap, .dismissDefaultBrowserOnboarding, _, _):",
        "            GleanMetrics.DefaultBrowserOnboarding.dismissPressed.add()",
        "        case (.action, .tap, .goToSettingsDefaultBrowserOnboarding, _, _):",
        "            GleanMetrics.DefaultBrowserOnboarding.goToSettingsPressed.add()",
        "        case (.information, .view, .homeTabBannerEvergreen, _, _):",
        "            GleanMetrics.DefaultBrowserCard.evergreenImpression.record()",
        "        // MARK: Downloads",
        "        case(.action, .tap, .downloadNowButton, _, _):",
        "            GleanMetrics.Downloads.downloadNowButtonTapped.record()",
        "        case(.action, .tap, .download, .downloadsPanel, _):",
        "            GleanMetrics.Downloads.downloadsPanelRowTapped.record()",
        "        case(.action, .view, .downloadsPanel, .downloadCompleteToast, _):",
        "            GleanMetrics.Downloads.viewDownloadCompleteToast.record()",
        "        // MARK: Key Commands",
        "        case(.action, .press, .keyCommand, _, let extras):",
        "            if let action = extras?[EventExtraKey.action.rawValue] as? String {",
        "                let actionExtra = GleanMetrics.KeyCommands.PressKeyCommandActionExtra(action: action)",
        "                GleanMetrics.KeyCommands.pressKeyCommandAction.record(actionExtra)",
        "            } else {",
        "                recordUninstrumentedMetrics(category: category, method: method, object: object, value: value, extras: extras)",
        "            }",
        "        // MARK: Shopping Experience (Fakespot)",
        "        case (.action, .view, .shoppingBottomSheet, .surfaceAdsClicked, _):",
        "            GleanMetrics.Shopping.surfaceAdsClicked.record()",
        "        case (.action, .tap, .shoppingButton, _, _):",
        "            GleanMetrics.Shopping.addressBarIconClicked.record()",
        "        case (.action, .view, .shoppingBottomSheet, .shoppingAdsExposure, _):",
        "            GleanMetrics.Shopping.adsExposure.record()",
        "        case (.action, .view, .shoppingBottomSheet, .shoppingAdsImpression, _):",
        "            GleanMetrics.Shopping.surfaceAdsImpression.record()",
        "        case (.action, .view, .shoppingBottomSheet, .shoppingNoAdsAvailable, _):",
        "            GleanMetrics.Shopping.surfaceNoAdsAvailable.record()",
        "        case (.action, .view, .shoppingButton, _, _):",
        "            GleanMetrics.Shopping.addressBarIconDisplayed.record()",
        "        case (.action, .close, .shoppingBottomSheet, _, let extras):",
        "            if let action = extras?[EventExtraKey.action.rawValue] as? String {",
        "                let actionExtra = GleanMetrics.Shopping.SurfaceClosedExtra(action: action)",
        "                GleanMetrics.Shopping.surfaceClosed.record(actionExtra)",
        "            } else {",
        "                recordUninstrumentedMetrics(",
        "                    category: category,",
        "                    method: method,",
        "                    object: object,",
        "                    value: value,",
        "                    extras: extras)",
        "            }",
        "        case (.action, .tap, .shoppingRecentReviews, _, _):",
        "            GleanMetrics.Shopping.surfaceShowMoreRecentReviewsClicked.record()",
        "        case (.action, .view, .shoppingBottomSheet, _, let extras):",
        "            if let size = extras?[EventExtraKey.size.rawValue] as? String {",
        "                let sizeExtra = GleanMetrics.Shopping.SurfaceDisplayedExtra(size: size)",
        "                GleanMetrics.Shopping.surfaceDisplayed.record(sizeExtra)",
        "            } else {",
        "                recordUninstrumentedMetrics(",
        "                    category: category,",
        "                    method: method,",
        "                    object: object,",
        "                    value: value,",
        "                    extras: extras)",
        "            }",
        "        case (.action, .view, .shoppingSettingsChevronButton, _, _):",
        "            GleanMetrics.Shopping.surfaceSettingsExpandClicked.record()",
        "        case (.action, .view, .shoppingOnboarding, _, _):",
        "            GleanMetrics.Shopping.surfaceOnboardingDisplayed.record()",
        "        case (.action, .tap, .shoppingOptIn, _, _):",
        "            GleanMetrics.Shopping.surfaceOptInAccepted.record()",
        "        case (.action, .tap, .shoppingNotNowButton, _, _):",
        "            GleanMetrics.Shopping.surfaceNotNowClicked.record()",
        "        case (.action, .tap, .shoppingTermsOfUseButton, _, _):",
        "            GleanMetrics.Shopping.surfaceShowTermsClicked.record()",
        "        case (.action, .tap, .shoppingPrivacyPolicyButton, _, _):",
        "            GleanMetrics.Shopping.surfaceShowPrivacyPolicyClicked.record()",
        "        case (.action, .tap, .shoppingLearnMoreButton, _, _):",
        "            GleanMetrics.Shopping.surfaceLearnMoreClicked.record()",
        "        case (.action, .tap, .shoppingLearnMoreReviewQualityButton, _, _):",
        "            GleanMetrics.Shopping.surfaceShowQualityExplainerClicked.record()",
        "        case (.action, .navigate, .shoppingButton, .shoppingCFRsDisplayed, _):",
        "            GleanMetrics.Shopping.addressBarFeatureCalloutDisplayed.record()",
        "        case (.information, .view, .shoppingProductPageVisits, _, _):",
        "            GleanMetrics.Shopping.productPageVisits.add()",
        "        case (.action, .tap, .shoppingPoweredByFakespotLabel, _, _):",
        "            GleanMetrics.Shopping.surfacePoweredByFakespotLinkClicked.record()",
        "        case (.action, .tap, .shoppingNoAnalysisCardViewPrimaryButton, _, _):",
        "            GleanMetrics.Shopping.surfaceAnalyzeReviewsNoneAvailableClicked.record()",
        "        case (.action, .tap, .shoppingNeedsAnalysisCardViewPrimaryButton, _, _):",
        "            GleanMetrics.Shopping.surfaceReanalyzeClicked.record()",
        "        case (.action, .tap, .shoppingProductBackInStockButton, _, _):",
        "            GleanMetrics.Shopping.surfaceReactivatedButtonClicked.record()",
        "        case(.action, .tap, .shoppingAdsSettingToggle, _, let extras):",
        "            if let isEnabled = extras?[EventExtraKey.Shopping.adsSettingToggle.rawValue]",
        "                as? Bool {",
        "                let isEnabledExtra = GleanMetrics.Shopping.SurfaceAdsSettingToggledExtra(isEnabled: isEnabled)",
        "                GleanMetrics.Shopping.surfaceAdsSettingToggled.record(isEnabledExtra)",
        "            } else {",
        "                recordUninstrumentedMetrics(",
        "                    category: category,",
        "                    method: method,",
        "                    object: object,",
        "                    value: value,",
        "                    extras: extras)",
        "            }",
        "        case (.action, .navigate, .shoppingBottomSheet, _, _):",
        "            GleanMetrics.Shopping.surfaceNoReviewReliabilityAvailable.record()",
        "        case (.action, .view, .shoppingSurfaceStaleAnalysisShown, _, _):",
        "            GleanMetrics.Shopping.surfaceStaleAnalysisShown.record()",
        "        case(.information, .settings, .shoppingNimbusDisabled, _, let extras):",
        "            if let isDisabled = extras?[EventExtraKey.Shopping.isNimbusDisabled.rawValue]",
        "                as? Bool {",
        "                GleanMetrics.ShoppingSettings.nimbusDisabledShopping.set(isDisabled)",
        "            } else {",
        "                recordUninstrumentedMetrics(",
        "                    category: category,",
        "                    method: method,",
        "                    object: object,",
        "                    value: value,",
        "                    extras: extras)",
        "            }",
        "        case(.information, .settings, .shoppingComponentOptedOut, _, let extras):",
        "            if let isOptedOut = extras?[EventExtraKey.Shopping.isComponentOptedOut.rawValue]",
        "                as? Bool {",
        "                GleanMetrics.ShoppingSettings.componentOptedOut.set(isOptedOut)",
        "            } else {",
        "                recordUninstrumentedMetrics(",
        "                    category: category,",
        "                    method: method,",
        "                    object: object,",
        "                    value: value,",
        "                    extras: extras)",
        "            }",
        "        case(.information, .settings, .shoppingUserHasOnboarded, _, let extras):",
        "            if let isOnboarded = extras?[EventExtraKey.Shopping.isUserOnboarded.rawValue]",
        "                as? Bool {",
        "                GleanMetrics.ShoppingSettings.userHasOnboarded.set(isOnboarded)",
        "            } else {",
        "                recordUninstrumentedMetrics(",
        "                    category: category,",
        "                    method: method,",
        "                    object: object,",
        "                    value: value,",
        "                    extras: extras)",
        "            }",
        "        case(.information, .settings, .shoppingAdsOptedOut, _, let extras):",
        "            if let fakespotAdsEnabled = extras?[EventExtraKey.Shopping.areAdsDisabled.rawValue]",
        "                as? Bool {",
        "                GleanMetrics.ShoppingSettings.disabledAds.set(fakespotAdsEnabled)",
        "            } else {",
        "                recordUninstrumentedMetrics(",
        "                    category: category,",
        "                    method: method,",
        "                    object: object,",
        "                    value: value,",
        "                    extras: extras)",
        "            }",
        "        // MARK: Onboarding",
        "        case (.action, .view, .onboardingCardView, _, let extras):",
        "            if let type = extras?[ExtraKey.cardType.rawValue] as? String,",
        "               let seqID = extras?[ExtraKey.sequenceID.rawValue] as? String,",
        "               let seqPosition = extras?[ExtraKey.sequencePosition.rawValue] as? String,",
        "               let flowType = extras?[ExtraKey.flowType.rawValue] as? String {",
        "                let cardExtras = GleanMetrics.Onboarding.CardViewExtra(",
        "                    cardType: type,",
        "                    flowType: flowType,",
        "                    sequenceId: seqID,",
        "                    sequencePosition: seqPosition)",
        "                GleanMetrics.Onboarding.cardView.record(cardExtras)",
        "            } else {",
        "                recordUninstrumentedMetrics(category: category, method: method, object: object, value: value, extras: extras)",
        "            }",
        "        case (.action, .tap, .onboardingPrimaryButton, _, let extras):",
        "            if let type = extras?[ExtraKey.cardType.rawValue] as? String,",
        "               let seqID = extras?[ExtraKey.sequenceID.rawValue] as? String,",
        "               let seqPosition = extras?[ExtraKey.sequencePosition.rawValue] as? String,",
        "               let action = extras?[ExtraKey.buttonAction.rawValue] as? String,",
        "               let flowType = extras?[ExtraKey.flowType.rawValue] as? String {",
        "                let cardExtras = GleanMetrics.Onboarding.PrimaryButtonTapExtra(",
        "                    buttonAction: action,",
        "                    cardType: type,",
        "                    flowType: flowType,",
        "                    sequenceId: seqID,",
        "                    sequencePosition: seqPosition)",
        "                GleanMetrics.Onboarding.primaryButtonTap.record(cardExtras)",
        "            } else {",
        "                recordUninstrumentedMetrics(category: category, method: method, object: object, value: value, extras: extras)",
        "            }",
        "        case (.action, .tap, .onboardingSecondaryButton, _, let extras):",
        "            if let type = extras?[ExtraKey.cardType.rawValue] as? String,",
        "               let seqID = extras?[ExtraKey.sequenceID.rawValue] as? String,",
        "               let seqPosition = extras?[ExtraKey.sequencePosition.rawValue] as? String,",
        "               let action = extras?[ExtraKey.buttonAction.rawValue] as? String,",
        "               let flowType = extras?[ExtraKey.flowType.rawValue] as? String {",
        "                let cardExtras = GleanMetrics.Onboarding.SecondaryButtonTapExtra(",
        "                    buttonAction: action,",
        "                    cardType: type,",
        "                    flowType: flowType,",
        "                    sequenceId: seqID,",
        "                    sequencePosition: seqPosition)",
        "                GleanMetrics.Onboarding.secondaryButtonTap.record(cardExtras)",
        "            } else {",
        "                recordUninstrumentedMetrics(category: category, method: method, object: object, value: value, extras: extras)",
        "            }",
        "        case (.action, .tap, .onboardingMultipleChoiceButton, _, let extras):",
        "            if let type = extras?[ExtraKey.cardType.rawValue] as? String,",
        "               let seqID = extras?[ExtraKey.sequenceID.rawValue] as? String,",
        "               let seqPosition = extras?[ExtraKey.sequencePosition.rawValue] as? String,",
        "               let action = extras?[ExtraKey.multipleChoiceButtonAction.rawValue] as? String,",
        "               let flowType = extras?[ExtraKey.flowType.rawValue] as? String {",
        "                let cardExtras = GleanMetrics.Onboarding.MultipleChoiceButtonTapExtra(",
        "                    buttonAction: action,",
        "                    cardType: type,",
        "                    flowType: flowType,",
        "                    sequenceId: seqID,",
        "                    sequencePosition: seqPosition)",
        "                GleanMetrics.Onboarding.multipleChoiceButtonTap.record(cardExtras)",
        "            } else {",
        "                recordUninstrumentedMetrics(category: category, method: method, object: object, value: value, extras: extras)",
        "            }",
        "        case (.action, .tap, .onboardingClose, _, let extras):",
        "            if let type = extras?[ExtraKey.cardType.rawValue] as? String,",
        "               let seqID = extras?[ExtraKey.sequenceID.rawValue] as? String,",
        "               let seqPosition = extras?[ExtraKey.sequencePosition.rawValue] as? String,",
        "               let flowType = extras?[ExtraKey.flowType.rawValue] as? String {",
        "                let cardExtras = GleanMetrics.Onboarding.CloseTapExtra(",
        "                    cardType: type,",
        "                    flowType: flowType,",
        "                    sequenceId: seqID,",
        "                    sequencePosition: seqPosition)",
        "                GleanMetrics.Onboarding.closeTap.record(cardExtras)",
        "            } else {",
        "                recordUninstrumentedMetrics(category: category, method: method, object: object, value: value, extras: extras)",
        "            }",
        "        case (.action, .tap, .onboardingSelectWallpaper, .wallpaperSelected, let extras):",
        "            if let name = extras?[EventExtraKey.wallpaperName.rawValue] as? String,",
        "               let type = extras?[EventExtraKey.wallpaperType.rawValue] as? String {",
        "                let wallpaperExtra = GleanMetrics.Onboarding.WallpaperSelectedExtra(wallpaperName: name, wallpaperType: type)",
        "                GleanMetrics.Onboarding.wallpaperSelected.record(wallpaperExtra)",
        "            } else {",
        "                recordUninstrumentedMetrics(category: category, method: method, object: object, value: value, extras: extras)",
        "            }",
        "        case (.action, .tap, .onboardingWallpaperSelector, .wallpaperSelected, let extras):",
        "            if let name = extras?[EventExtraKey.wallpaperName.rawValue] as? String,",
        "               let type = extras?[EventExtraKey.wallpaperType.rawValue] as? String {",
        "                let wallpaperExtra = GleanMetrics.Onboarding.WallpaperSelectorSelectedExtra(wallpaperName: name, wallpaperType: type)",
        "                GleanMetrics.Onboarding.wallpaperSelectorSelected.record(wallpaperExtra)",
        "            } else {",
        "                recordUninstrumentedMetrics(category: category, method: method, object: object, value: value, extras: extras)",
        "            }",
        "        case (.action, .view, .onboardingWallpaperSelector, _, _):",
        "            GleanMetrics.Onboarding.wallpaperSelectorView.record()",
        "        case (.action, .close, .onboardingWallpaperSelector, _, _):",
        "            GleanMetrics.Onboarding.wallpaperSelectorClose.record()",
        "        case(.prompt, .tap, .notificationPermission, _, let extras):",
        "            if let isPermissionGranted = extras?[EventExtraKey.notificationPermissionIsGranted.rawValue] as? Bool {",
        "                let permissionExtra = GleanMetrics.Onboarding.NotificationPermissionPromptExtra(granted: isPermissionGranted)",
        "                GleanMetrics.Onboarding.notificationPermissionPrompt.record(permissionExtra)",
        "            } else {",
        "                recordUninstrumentedMetrics(",
        "                    category: category,",
        "                    method: method,",
        "                    object: object,",
        "                    value: value,",
        "                    extras: extras)",
        "            }",
        "        // MARK: Widget",
        "        case (.action, .open, .mediumTabsOpenUrl, _, _):",
        "            GleanMetrics.Widget.mTabsOpenUrl.add()",
        "        case (.action, .open, .largeTabsOpenUrl, _, _):",
        "            GleanMetrics.Widget.lTabsOpenUrl.add()",
        "        case (.action, .open, .smallQuickActionSearch, _, _):",
        "            GleanMetrics.Widget.sQuickActionSearch.add()",
        "        case (.action, .open, .mediumQuickActionSearch, _, _):",
        "            GleanMetrics.Widget.mQuickActionSearch.add()",
        "        case (.action, .open, .mediumQuickActionPrivateSearch, _, _):",
        "            GleanMetrics.Widget.mQuickActionPrivateSearch.add()",
        "        case (.action, .open, .mediumQuickActionCopiedLink, _, _):",
        "            GleanMetrics.Widget.mQuickActionCopiedLink.add()",
        "        case (.action, .open, .mediumQuickActionClosePrivate, _, _):",
        "            GleanMetrics.Widget.mQuickActionClosePrivate.add()",
        "        case (.action, .open, .mediumTopSitesWidget, _, _):",
        "            GleanMetrics.Widget.mTopSitesWidget.add()",
        "        // MARK: Pocket",
        "        case (.action, .tap, .pocketStory, _, let extras):",
        "            if let homePageOrigin = extras?[EventExtraKey.fxHomepageOrigin.rawValue] as? String {",
        "                GleanMetrics.Pocket.openStoryOrigin[homePageOrigin].add()",
        "            }",
        "            if let position = extras?[EventExtraKey.pocketTilePosition.rawValue] as? String {",
        "                GleanMetrics.Pocket.openStoryPosition[\"position-\"+position].add()",
        "            } else {",
        "                recordUninstrumentedMetrics(category: category, method: method, object: object, value: value, extras: extras)",
        "            }",
        "        case (.action, .view, .pocketSectionImpression, _, _):",
        "            GleanMetrics.Pocket.sectionImpressions.add()",
        "        case (.action, .tap, .newPrivateTab, .pocketSite, _):",
        "            GleanMetrics.Pocket.openInPrivateTab.record()",
        "        // MARK: Library Panel",
        "        case (.action, .tap, .libraryPanel, let type?, _):",
        "            GleanMetrics.Library.panelPressed[type.rawValue].add()",
        "        // History Panel related",
        "        case (.action, .navigate, .navigateToGroupHistory, _, _):",
        "            GleanMetrics.History.groupList.add()",
        "        case (.action, .tap, .selectedHistoryItem, let type?, _):",
        "            GleanMetrics.History.selectedItem[type.rawValue].add()",
        "        case (.action, .tap, .openedHistoryItem, _, _):",
        "            GleanMetrics.History.openedItem.record()",
        "        case (.action, .tap, .searchHistory, _, _):",
        "            GleanMetrics.History.searchTap.record()",
        "        case (.action, .tap, .deleteHistory, _, _):",
        "            GleanMetrics.History.deleteTap.record()",
        "        // MARK: Sync",
        "        case (.action, .open, .syncTab, _, _):",
        "            GleanMetrics.Sync.openTab.add()",
        "        case (.action, .tap, .syncSignIn, _, _):",
        "            GleanMetrics.Sync.signInSyncPressed.add()",
        "        case (.action, .tap, .syncCreateAccount, _, _):",
        "            GleanMetrics.Sync.createAccountPressed.add()",
        "        case (.firefoxAccount, .view, .fxaRegistrationWebpage, _, _):",
        "            GleanMetrics.Sync.registrationView.record()",
        "        case (.firefoxAccount, .view, .fxaRegistrationCompletedWebpage, _, _):",
        "            GleanMetrics.Sync.registrationCompletedView.record()",
        "        case (.firefoxAccount, .view, .fxaLoginWebpage, _, _):",
        "            GleanMetrics.Sync.loginView.record()",
        "        case (.firefoxAccount, .view, .fxaLoginCompleteWebpage, _, _):",
        "            GleanMetrics.Sync.loginCompletedView.record()",
        "            // record the same event for Nimbus' internal event store",
        "            Experiments.events.recordEvent(BehavioralTargetingEvent.syncLoginCompletion)",
        "        case (.firefoxAccount, .view, .fxaConfirmSignUpCode, _, _):",
        "            GleanMetrics.Sync.registrationCodeView.record()",
        "        case (.firefoxAccount, .view, .fxaConfirmSignInToken, _, _):",
        "            GleanMetrics.Sync.loginTokenView.record()",
        "        case (.firefoxAccount, .tap, .syncSignInUseEmail, _, _):",
        "            GleanMetrics.Sync.useEmail.record()",
        "        case (.firefoxAccount, .tap, .syncSignInScanQRCode, _, _):",
        "            GleanMetrics.Sync.paired.record()",
        "        case (.firefoxAccount, .tap, .syncUserLoggedOut, _, _):",
        "            GleanMetrics.Sync.disconnect.record()",
        "        // MARK: App cycle",
        "        case(.action, .foreground, .app, _, _):",
        "            GleanMetrics.AppCycle.foreground.record()",
        "            GleanMetrics.ServerKnobs.validation.record()",
        "            // record the same event for Nimbus' internal event store",
        "            Experiments.events.recordEvent(BehavioralTargetingEvent.appForeground)",
        "        case(.action, .background, .app, _, _):",
        "            GleanMetrics.AppCycle.background.record()",
        "        // MARK: App icon",
        "        case (.action, .tap, .newPrivateTab, .appIcon, _):",
        "            GleanMetrics.AppIcon.newPrivateTabTapped.record()",
        "        // MARK: Accessibility",
        "        case(.action, .voiceOver, .app, _, let extras):",
        "            if let isRunning = extras?[EventExtraKey.isVoiceOverRunning.rawValue] as? String {",
        "                let isRunningExtra = GleanMetrics.Accessibility.VoiceOverExtra(isRunning: isRunning)",
        "                GleanMetrics.Accessibility.voiceOver.record(isRunningExtra)",
        "            } else {",
        "                recordUninstrumentedMetrics(",
        "                    category: category,",
        "                    method: method,",
        "                    object: object,",
        "                    value: value,",
        "                    extras: extras)",
        "            }",
        "        case(.action, .switchControl, .app, _, let extras):",
        "            if let isRunning = extras?[EventExtraKey.isSwitchControlRunning.rawValue] as? String {",
        "                let isRunningExtra = GleanMetrics.Accessibility.SwitchControlExtra(isRunning: isRunning)",
        "                GleanMetrics.Accessibility.switchControl.record(isRunningExtra)",
        "            } else {",
        "                recordUninstrumentedMetrics(",
        "                    category: category,",
        "                    method: method,",
        "                    object: object,",
        "                    value: value,",
        "                    extras: extras)",
        "            }",
        "        case(.action, .reduceTransparency, .app, _, let extras):",
        "            if let isEnabled = extras?[EventExtraKey.isReduceTransparencyEnabled.rawValue] as? String {",
        "                let isEnabledExtra = GleanMetrics.Accessibility.ReduceTransparencyExtra(isEnabled: isEnabled)",
        "                GleanMetrics.Accessibility.reduceTransparency.record(isEnabledExtra)",
        "            } else {",
        "                recordUninstrumentedMetrics(",
        "                    category: category,",
        "                    method: method,",
        "                    object: object,",
        "                    value: value,",
        "                    extras: extras)",
        "            }",
        "        case(.action, .reduceMotion, .app, _, let extras):",
        "            if let isEnabled = extras?[EventExtraKey.isReduceMotionEnabled.rawValue] as? String {",
        "                let isEnabledExtra = GleanMetrics.Accessibility.ReduceMotionExtra(isEnabled: isEnabled)",
        "                GleanMetrics.Accessibility.reduceMotion.record(isEnabledExtra)",
        "            } else {",
        "                recordUninstrumentedMetrics(",
        "                    category: category,",
        "                    method: method,",
        "                    object: object,",
        "                    value: value,",
        "                    extras: extras)",
        "            }",
        "        case(.action, .invertColors, .app, _, let extras):",
        "            if let isEnabled = extras?[EventExtraKey.isInvertColorsEnabled.rawValue] as? String {",
        "                let isEnabledExtra = GleanMetrics.Accessibility.InvertColorsExtra(isEnabled: isEnabled)",
        "                GleanMetrics.Accessibility.invertColors.record(isEnabledExtra)",
        "            } else {",
        "                recordUninstrumentedMetrics(",
        "                    category: category,",
        "                    method: method,",
        "                    object: object,",
        "                    value: value,",
        "                    extras: extras)",
        "            }",
        "        case(.action, .dynamicTextSize, .app, _, let extras):",
        "            if let isAccessibilitySizeEnabled = extras?[EventExtraKey.isAccessibilitySizeEnabled.rawValue] as? String,",
        "               let preferredSize = extras?[EventExtraKey.preferredContentSizeCategory.rawValue] as? String {",
        "                let dynamicTextExtra = GleanMetrics.Accessibility.DynamicTextExtra(",
        "                    isAccessibilitySizeEnabled: isAccessibilitySizeEnabled,",
        "                    preferredSize: preferredSize)",
        "                GleanMetrics.Accessibility.dynamicText.record(dynamicTextExtra)",
        "            } else {",
        "                recordUninstrumentedMetrics(",
        "                    category: category,",
        "                    method: method,",
        "                    object: object,",
        "                    value: value,",
        "                    extras: extras)",
        "            }",
        "        // MARK: App menu",
        "        case (.action, .tap, .homePageMenu, _, _):",
        "            GleanMetrics.AppMenu.homepageMenu.add()",
        "        case (.action, .tap, .siteMenu, _, _):",
        "            GleanMetrics.AppMenu.siteMenu.add()",
        "        case (.action, .tap, .logins, _, _):",
        "            GleanMetrics.AppMenu.logins.add()",
        "        case (.action, .tap, .signIntoSync, _, _):",
        "            GleanMetrics.AppMenu.signIntoSync.add()",
        "        case (.action, .tap, .home, _, _):",
        "            GleanMetrics.AppMenu.home.add()",
        "        case (.action, .tap, .blockImagesEnabled, _, _):",
        "            GleanMetrics.AppMenu.blockImagesEnabled.add()",
        "        case (.action, .tap, .blockImagesDisabled, _, _):",
        "            GleanMetrics.AppMenu.blockImagesDisabled.add()",
        "        case (.action, .tap, .nightModeEnabled, _, _):",
        "            GleanMetrics.AppMenu.nightModeEnabled.add()",
        "        case (.action, .tap, .nightModeDisabled, _, _):",
        "            GleanMetrics.AppMenu.nightModeDisabled.add()",
        "        case (.action, .open, .whatsNew, _, _):",
        "            GleanMetrics.AppMenu.whatsNew.add()",
        "        case (.action, .tap, .help, _, _):",
        "            GleanMetrics.AppMenu.help.add()",
        "        case (.action, .tap, .customizeHomePage, _, _):",
        "            GleanMetrics.AppMenu.customizeHomepage.add()",
        "        case (.action, .open, .settings, _, _):",
        "            GleanMetrics.AppMenu.settings.add()",
        "        case(.action, .open, .logins, _, _):",
        "            GleanMetrics.AppMenu.passwords.record()",
        "        // MARK: Page Menu",
        "        case (.action, .tap, .sharePageWith, _, _):",
        "            GleanMetrics.PageActionMenu.sharePageWith.add()",
        "        case (.action, .tap, .sendToDevice, _, _):",
        "            GleanMetrics.PageActionMenu.sendToDevice.add()",
        "        case (.action, .tap, .copyAddress, _, _):",
        "            GleanMetrics.PageActionMenu.copyAddress.add()",
        "        case (.action, .tap, .reportSiteIssue, _, _):",
        "            GleanMetrics.PageActionMenu.reportSiteIssue.add()",
        "        case (.action, .tap, .findInPage, _, _):",
        "            GleanMetrics.PageActionMenu.findInPage.add()",
        "        case (.action, .tap, .pinToTopSites, _, _):",
        "            GleanMetrics.PageActionMenu.pinToTopSites.add()",
        "        case (.action, .tap, .removePinnedSite, _, _):",
        "            GleanMetrics.PageActionMenu.removePinnedSite.add()",
        "        case (.action, .tap, .requestDesktopSite, _, _):",
        "            GleanMetrics.PageActionMenu.requestDesktopSite.add()",
        "        case (.action, .tap, .requestMobileSite, _, _):",
        "            GleanMetrics.PageActionMenu.requestMobileSite.add()",
        "        case (.action, .tap, .viewDownloadsPanel, _, _):",
        "            GleanMetrics.PageActionMenu.viewDownloadsPanel.add()",
        "        case (.action, .tap, .viewHistoryPanel, _, _):",
        "            GleanMetrics.PageActionMenu.viewHistoryPanel.add()",
        "        case (.action, .tap, .createNewTab, _, _):",
        "            GleanMetrics.PageActionMenu.createNewTab.add()",
        "        // MARK: Tracking Protection",
        "        case (.action, .tap, .trackingProtectionMenu, _, let extras):",
        "            if let action = extras?[EventExtraKey.etpSetting.rawValue] as? String {",
        "                let actionExtra = GleanMetrics.TrackingProtection.EtpSettingChangedExtra(etpSetting: action)",
        "                GleanMetrics.TrackingProtection.etpSettingChanged.record(actionExtra)",
        "            } else if let action = extras?[EventExtraKey.etpEnabled.rawValue] as? Bool {",
        "                let actionExtra = GleanMetrics.TrackingProtection.EtpSettingChangedExtra(etpEnabled: action)",
        "                GleanMetrics.TrackingProtection.etpSettingChanged.record(actionExtra)",
        "            } else {",
        "                recordUninstrumentedMetrics(category: category, method: method, object: object, value: value, extras: extras)",
        "            }",
        "        // MARK: Tabs Tray",
        "        case (.action, .tap, .privateBrowsingIcon, .tabTray, let extras):",
        "            if let action = extras?[EventExtraKey.action.rawValue] as? String {",
        "                let actionExtra = GleanMetrics.TabsTray.PrivateBrowsingIconTappedExtra(action: action)",
        "                GleanMetrics.TabsTray.privateBrowsingIconTapped.record(actionExtra)",
        "            } else {",
        "                recordUninstrumentedMetrics(category: category, method: method, object: object, value: value, extras: extras)",
        "            }",
        "        case (.action, .tap, .newPrivateTab, .tabTray, _):",
        "            GleanMetrics.TabsTray.newPrivateTabTapped.record()",
        "        // MARK: Inactive Tab Tray",
        "        case (.action, .tap, .inactiveTabTray, .openInactiveTab, _):",
        "            GleanMetrics.InactiveTabsTray.openInactiveTab.add()",
        "        case (.action, .tap, .inactiveTabTray, .inactiveTabExpand, _):",
        "            let expandedExtras = GleanMetrics.InactiveTabsTray.ToggleInactiveTabTrayExtra(toggleType: EventExtraKey.inactiveTabsExpanded.rawValue)",
        "            GleanMetrics.InactiveTabsTray.toggleInactiveTabTray.record(expandedExtras)",
        "        case (.action, .tap, .inactiveTabTray, .inactiveTabCollapse, _):",
        "            let collapsedExtras = GleanMetrics.InactiveTabsTray.ToggleInactiveTabTrayExtra(toggleType: EventExtraKey.inactiveTabsCollapsed.rawValue)",
        "            GleanMetrics.InactiveTabsTray.toggleInactiveTabTray.record(collapsedExtras)",
        "        case (.action, .tap, .inactiveTabTray, .inactiveTabSwipeClose, _):",
        "            GleanMetrics.InactiveTabsTray.inactiveTabSwipeClose.add()",
        "        case (.action, .tap, .inactiveTabTray, .inactiveTabCloseAllButton, _):",
        "            GleanMetrics.InactiveTabsTray.inactiveTabsCloseAllBtn.add()",
        "        case (.action, .tap, .inactiveTabTray, .inactiveTabShown, _):",
        "            GleanMetrics.InactiveTabsTray.inactiveTabShown.add()",
        "        // MARK: Tab Groups",
        "        case (.action, .view, .tabTray, .tabGroupWithExtras, let extras):",
        "           let groupedTabExtras = GleanMetrics.Tabs.GroupedTabExtra(",
        "            averageTabsInAllGroups: extras?[\"\\(EventExtraKey.averageTabsInAllGroups)\"] as? Int32,",
        "            groupsTwoTabsOnly: extras?[\"\\(EventExtraKey.groupsWithTwoTabsOnly)\"] as? Int32,",
        "            groupsWithMoreThanTwoTab: extras?[\"\\(EventExtraKey.groupsWithTwoMoreTab)\"] as? Int32,",
        "            totalNumOfGroups: extras?[\"\\(EventExtraKey.totalNumberOfGroups)\"] as? Int32,",
        "            totalTabsInAllGroups: extras?[\"\\(EventExtraKey.totalTabsInAllGroups)\"] as? Int32)",
        "            GleanMetrics.Tabs.groupedTab.record(groupedTabExtras)",
        "        case (.action, .tap, .groupedTab, .closeGroupedTab, _):",
        "            GleanMetrics.Tabs.groupedTabClosed.add()",
        "        case (.action, .tap, .groupedTabPerformSearch, _, _):",
        "            GleanMetrics.Tabs.groupedTabSearch.add()",
        "        // MARK: Firefox Homepage",
        "        case (.action, .view, .firefoxHomepage, .fxHomepageOrigin, let extras):",
        "            if let homePageOrigin = extras?[EventExtraKey.fxHomepageOrigin.rawValue] as? String {",
        "                GleanMetrics.FirefoxHomePage.firefoxHomepageOrigin[homePageOrigin].add()",
        "            }",
        "        case (.action, .open, .firefoxHomepage, .openHomeFromAwesomebar, _):",
        "            GleanMetrics.FirefoxHomePage.openFromAwesomebar.add()",
        "        case (.action, .open, .firefoxHomepage, .openHomeFromPhotonMenuButton, _):",
        "            GleanMetrics.FirefoxHomePage.openFromMenuHomeButton.add()",
        "        case (.action, .view, .firefoxHomepage, .bookmarkItemView, let extras):",
        "            if let bookmarksCount = extras?[EventObject.bookmarkImpressions.rawValue] as? String {",
        "                GleanMetrics.FirefoxHomePage.recentlySavedBookmarkView.record(GleanMetrics.FirefoxHomePage.RecentlySavedBookmarkViewExtra(bookmarkCount: bookmarksCount))",
        "            }",
        "        case (.action, .tap, .firefoxHomepage, .bookmarkSectionShowAll, let extras):",
        "            GleanMetrics.FirefoxHomePage.recentlySavedShowAll.add()",
        "            if let homePageOrigin = extras?[EventExtraKey.fxHomepageOrigin.rawValue] as? String {",
        "                GleanMetrics.FirefoxHomePage.recentlySavedShowAllOrigin[homePageOrigin].add()",
        "            }",
        "        case (.action, .tap, .firefoxHomepage, .bookmarkItemAction, let extras):",
        "            GleanMetrics.FirefoxHomePage.recentlySavedBookmarkItem.add()",
        "            if let homePageOrigin = extras?[EventExtraKey.fxHomepageOrigin.rawValue] as? String {",
        "                GleanMetrics.FirefoxHomePage.recentlySavedBookmarkOrigin[homePageOrigin].add()",
        "            }",
        "        case (.action, .tap, .firefoxHomepage, .jumpBackInSectionShowAll, let extras):",
        "            GleanMetrics.FirefoxHomePage.jumpBackInShowAll.add()",
        "            if let homePageOrigin = extras?[EventExtraKey.fxHomepageOrigin.rawValue] as? String {",
        "                GleanMetrics.FirefoxHomePage.jumpBackInShowAllOrigin[homePageOrigin].add()",
        "            }",
        "        case (.action, .view, .jumpBackInTileImpressions, _, _):",
        "            GleanMetrics.FirefoxHomePage.jumpBackInTileView.add()",
        "        case (.action, .tap, .firefoxHomepage, .jumpBackInSectionTabOpened, let extras):",
        "            GleanMetrics.FirefoxHomePage.jumpBackInTabOpened.add()",
        "            if let homePageOrigin = extras?[EventExtraKey.fxHomepageOrigin.rawValue] as? String {",
        "                GleanMetrics.FirefoxHomePage.jumpBackInTabOpenedOrigin[homePageOrigin].add()",
        "            }",
        "        case (.action, .tap, .firefoxHomepage, .jumpBackInSectionGroupOpened, let extras):",
        "            GleanMetrics.FirefoxHomePage.jumpBackInGroupOpened.add()",
        "            if let homePageOrigin = extras?[EventExtraKey.fxHomepageOrigin.rawValue] as? String {",
        "                GleanMetrics.FirefoxHomePage.jumpBackInGroupOpenOrigin[homePageOrigin].add()",
        "            }",
        "        case (.action, .tap, .firefoxHomepage, .jumpBackInSectionSyncedTabShowAll, let extras):",
        "            GleanMetrics.FirefoxHomePage.syncedTabShowAll.add()",
        "            if let homePageOrigin = extras?[EventExtraKey.fxHomepageOrigin.rawValue] as? String {",
        "                GleanMetrics.FirefoxHomePage.syncedTabShowAllOrigin[homePageOrigin].add()",
        "            }",
        "        case (.action, .tap, .firefoxHomepage, .jumpBackInSectionSyncedTabOpened, let extras):",
        "            GleanMetrics.FirefoxHomePage.syncedTabOpened.add()",
        "            if let homePageOrigin = extras?[EventExtraKey.fxHomepageOrigin.rawValue] as? String {",
        "                GleanMetrics.FirefoxHomePage.syncedTabOpenedOrigin[homePageOrigin].add()",
        "            }",
        "        case (.action, .view, .syncedTabTileImpressions, _, _):",
        "            GleanMetrics.FirefoxHomePage.syncedTabTileView.add()",
        "        case (.action, .tap, .firefoxHomepage, .customizeHomepageButton, _):",
        "            GleanMetrics.FirefoxHomePage.customizeHomepageButton.add()",
        "        // MARK: - History Highlights",
        "        case (.action, .tap, .firefoxHomepage, .historyHighlightsShowAll, _):",
        "            GleanMetrics.FirefoxHomePage.historyHighlightsShowAll.add()",
        "        case (.action, .tap, .firefoxHomepage, .historyHighlightsItemOpened, _):",
        "            GleanMetrics.FirefoxHomePage.historyHighlightsItemOpened.record()",
        "        case (.action, .tap, .firefoxHomepage, .historyHighlightsGroupOpen, _):",
        "            GleanMetrics.FirefoxHomePage.historyHighlightsGroupOpen.record()",
        "        case (.action, .view, .historyImpressions, _, _):",
        "            GleanMetrics.FirefoxHomePage.historyImpressions.record()",
        "        case (.action, .view, .historyHighlightContextualMenu, _, let extras):",
        "            if let type = extras?[EventExtraKey.contextualMenuType.rawValue] as? String {",
        "                let contextExtra = GleanMetrics.FirefoxHomePage.HistoryHighlightsContextExtra(type: type)",
        "                GleanMetrics.FirefoxHomePage.historyHighlightsContext.record(contextExtra)",
        "            } else {",
        "                recordUninstrumentedMetrics(category: category, method: method, object: object, value: value, extras: extras)",
        "            }",
        "        // MARK: - Wallpaper related",
        "        case (.action, .tap, .wallpaperSettings, .wallpaperSelected, let extras):",
        "            if let name = extras?[EventExtraKey.wallpaperName.rawValue] as? String,",
        "               let type = extras?[EventExtraKey.wallpaperType.rawValue] as? String {",
        "                GleanMetrics.WallpaperAnalytics.wallpaperSelected.record(",
        "                    GleanMetrics.WallpaperAnalytics.WallpaperSelectedExtra(",
        "                        wallpaperName: name,",
        "                        wallpaperType: type",
        "                    )",
        "                )",
        "            } else {",
        "                recordUninstrumentedMetrics(category: category, method: method, object: object, value: value, extras: extras)",
        "            }",
        "        // MARK: - Contextual Hints",
        "        case (.action, .tap, .contextualHint, .dismissCFRFromButton, let extras):",
        "            if let hintType = extras?[EventExtraKey.cfrType.rawValue] as? String {",
        "                GleanMetrics.CfrAnalytics.dismissCfrFromButton.record(",
        "                    GleanMetrics.CfrAnalytics.DismissCfrFromButtonExtra(hintType: hintType))",
        "            } else {",
        "                recordUninstrumentedMetrics(category: category, method: method, object: object, value: value, extras: extras)",
        "            }",
        "        case (.action, .tap, .contextualHint, .dismissCFRFromOutsideTap, let extras):",
        "            if let hintType = extras?[EventExtraKey.cfrType.rawValue] as? String {",
        "                GleanMetrics.CfrAnalytics.dismissCfrFromOutsideTap.record(",
        "                    GleanMetrics.CfrAnalytics.DismissCfrFromOutsideTapExtra(hintType: hintType))",
        "            } else {",
        "                recordUninstrumentedMetrics(category: category, method: method, object: object, value: value, extras: extras)",
        "            }",
        "        case (.action, .tap, .contextualHint, .pressCFRActionButton, let extras):",
        "            if let hintType = extras?[EventExtraKey.cfrType.rawValue] as? String {",
        "                GleanMetrics.CfrAnalytics.pressCfrActionButton.record(",
        "                    GleanMetrics.CfrAnalytics.PressCfrActionButtonExtra(hintType: hintType))",
        "            } else {",
        "                recordUninstrumentedMetrics(category: category, method: method, object: object, value: value, extras: extras)",
        "            }",
        "        // MARK: - Sponsored Shortcuts",
        "        case (.information, .view, .sponsoredShortcuts, _, let extras):",
        "            if let enabled = extras?[EventExtraKey.preference.rawValue] as? Bool {",
        "                GleanMetrics.TopSites.sponsoredShortcuts.set(enabled)",
        "            } else {",
        "                recordUninstrumentedMetrics(",
        "                    category: category,",
        "                    method: method,",
        "                    object: object,",
        "                    value: value,",
        "                    extras: extras)",
        "            }",
        "        // MARK: - Awesomebar",
        "        case (.information, .view, .awesomebarLocation, _, let extras):",
        "            if let location = extras?[EventExtraKey.preference.rawValue] as? String {",
        "                let locationExtra = GleanMetrics.Awesomebar.LocationExtra(location: location)",
        "                GleanMetrics.Awesomebar.location.record(locationExtra)",
        "            } else {",
        "                recordUninstrumentedMetrics(",
        "                    category: category,",
        "                    method: method,",
        "                    object: object,",
        "                    value: value,",
        "                    extras: extras)",
        "            }",
        "        case (.action, .tap, .awesomebarLocation, .awesomebarShareTap, _):",
        "            GleanMetrics.Awesomebar.shareButtonTapped.record()",
        "        case (.action, .drag, .locationBar, _, _):",
        "            GleanMetrics.Awesomebar.dragLocationBar.record()",
        "        // MARK: - GleanPlumb Messaging",
        "        case (.information, .view, .messaging, .messageImpression, let extras):",
        "            guard let messageSurface = extras?[EventExtraKey.messageSurface.rawValue] as? String,",
        "                  let messageId = extras?[EventExtraKey.messageKey.rawValue] as? String",
        "            else { return }",
        "            GleanMetrics.Messaging.shown.record(",
        "                GleanMetrics.Messaging.ShownExtra(",
        "                    messageKey: messageId,",
        "                    messageSurface: messageSurface",
        "                )",
        "            )",
        "        case(.action, .tap, .messaging, .messageDismissed, let extras):",
        "            guard let messageSurface = extras?[EventExtraKey.messageSurface.rawValue] as? String,",
        "                  let messageId = extras?[EventExtraKey.messageKey.rawValue] as? String",
        "            else { return }",
        "            GleanMetrics.Messaging.dismissed.record(",
        "                GleanMetrics.Messaging.DismissedExtra(",
        "                    messageKey: messageId,",
        "                    messageSurface: messageSurface",
        "                )",
        "            )",
        "        case(.action, .tap, .messaging, .messageInteracted, let extras):",
        "            guard let messageSurface = extras?[EventExtraKey.messageSurface.rawValue] as? String,",
        "                  let messageId = extras?[EventExtraKey.messageKey.rawValue] as? String",
        "            else { return }",
        "            if let actionUUID = extras?[EventExtraKey.actionUUID.rawValue] as? String {",
        "                GleanMetrics.Messaging.clicked.record(",
        "                    GleanMetrics.Messaging.ClickedExtra(",
        "                        actionUuid: actionUUID,",
        "                        messageKey: messageId,",
        "                        messageSurface: messageSurface",
        "                    )",
        "                )",
        "            } else {",
        "                GleanMetrics.Messaging.clicked.record(",
        "                    GleanMetrics.Messaging.ClickedExtra(",
        "                        messageKey: messageId,",
        "                        messageSurface: messageSurface",
        "                    )",
        "                )",
        "            }",
        "        case(.information, .view, .messaging, .messageExpired, let extras):",
        "            guard let messageSurface = extras?[EventExtraKey.messageSurface.rawValue] as? String,",
        "                  let messageId = extras?[EventExtraKey.messageKey.rawValue] as? String",
        "            else { return }",
        "            GleanMetrics.Messaging.expired.record(",
        "                GleanMetrics.Messaging.ExpiredExtra(",
        "                    messageKey: messageId,",
        "                    messageSurface: messageSurface",
        "                )",
        "            )",
        "        case(.information, .application, .messaging, .messageMalformed, let extras):",
        "            guard let messageSurface = extras?[EventExtraKey.messageSurface.rawValue] as? String,",
        "                  let messageId = extras?[EventExtraKey.messageKey.rawValue] as? String",
        "            else { return }",
        "            GleanMetrics.Messaging.malformed.record(",
        "                GleanMetrics.Messaging.MalformedExtra(",
        "                    messageKey: messageId,",
        "                    messageSurface: messageSurface",
        "                )",
        "            )",
        "        // MARK: - Share sheet actions",
        "        case (.action, .tap, .shareSheet, .shareSendToDevice, _):",
        "            GleanMetrics.ShareSheet.sendDeviceTapped.record()",
        "        case (.action, .tap, .shareSheet, .shareCopyLink, _):",
        "            GleanMetrics.ShareSheet.copyLinkTapped.record()",
        "        case (.action, .tap, .shareSheet, .sharePocketIcon, _):",
        "            GleanMetrics.ShareSheet.pocketActionTapped.record()",
        "        case (.action, .tap, .shareSheet, .shareSaveToPocket, _):",
        "            GleanMetrics.ShareSheet.saveToPocketTapped.record()",
        "        // MARK: - App Errors",
        "        case(.information, .error, .app, .largeFileWrite, let extras):",
        "            if let quantity = extras?[EventExtraKey.size.rawValue] as? Int32 {",
        "                let properties = GleanMetrics.AppErrors.LargeFileWriteExtra(size: quantity)",
        "                GleanMetrics.AppErrors.largeFileWrite.record(properties)",
        "            } else {",
        "                recordUninstrumentedMetrics(category: category, method: method, object: object, value: value, extras: extras)",
        "            }",
        "        case(.information, .error, .app, .crashedLastLaunch, _):",
        "            GleanMetrics.AppErrors.crashedLastLaunch.record()",
        "        case(.information, .error, .app, .tabLossDetected, _):",
        "            GleanMetrics.AppErrors.tabLossDetected.record()",
        "        case(.information, .error, .app, .cpuException, let extras):",
        "            if let quantity = extras?[EventExtraKey.size.rawValue] as? Int32 {",
        "                let properties = GleanMetrics.AppErrors.CpuExceptionExtra(size: quantity)",
        "                GleanMetrics.AppErrors.cpuException.record(properties)",
        "            } else {",
        "                recordUninstrumentedMetrics(category: category, method: method, object: object, value: value, extras: extras)",
        "            }",
        "        case(.information, .error, .app, .hangException, let extras):",
        "            if let quantity = extras?[EventExtraKey.size.rawValue] as? Int32 {",
        "                let properties = GleanMetrics.AppErrors.HangExceptionExtra(size: quantity)",
        "                GleanMetrics.AppErrors.hangException.record(properties)",
        "            } else {",
        "                recordUninstrumentedMetrics(category: category, method: method, object: object, value: value, extras: extras)",
        "            }",
        "        // MARK: Webview",
        "        case(.information, .error, .webview, .webviewFail, _):",
        "            GleanMetrics.Webview.didFail.record()",
        "        case(.information, .error, .webview, .webviewFailProvisional, _):",
        "            GleanMetrics.Webview.didFailProvisional.record()",
        "        case(.information, .error, .webview, .webviewShowErrorPage, let extras):",
        "            if let errorCode = extras?[EventExtraKey.errorCode.rawValue] as? String {",
        "                let errorCodeExtra = GleanMetrics.Webview.ShowErrorPageExtra(errorCode: errorCode)",
        "                GleanMetrics.Webview.showErrorPage.record(errorCodeExtra)",
        "            } else {",
        "                recordUninstrumentedMetrics(category: category, method: method, object: object, value: value, extras: extras)",
        "            }",
        "        // MARK: - FX Suggest",
        "        case(.action, .tap, .fxSuggest, _, let extras):",
        "            guard let contextIdString = TelemetryContextualIdentifier.contextId,",
        "                  let contextId = UUID(uuidString: contextIdString),",
        "                  let telemetryInfo = extras?[EventValue.fxSuggestionTelemetryInfo.rawValue] as? RustFirefoxSuggestionTelemetryInfo,",
        "                  let position = extras?[EventValue.fxSuggestionPosition.rawValue] as? Int else {",
        "                return recordUninstrumentedMetrics(category: category, method: method, object: object, value: value, extras: extras)",
        "            }",
        "            // Record an event for this tap in the `events` ping.",
        "            // These events include the `client_id`.",
        "            let searchResultTapExtra = switch telemetryInfo {",
        "            case .amp: GleanMetrics.Awesomebar.SearchResultTapExtra(type: \"amp-suggestion\")",
        "            case .wikipedia: GleanMetrics.Awesomebar.SearchResultTapExtra(type: \"wikipedia-suggestion\")",
        "            }",
        "            GleanMetrics.Awesomebar.searchResultTap.record(searchResultTapExtra)",
        "            // Submit a separate `fx-suggest` ping for this tap.",
        "            // These pings do not include the `client_id`.",
        "            GleanMetrics.FxSuggest.contextId.set(contextId)",
        "            GleanMetrics.FxSuggest.pingType.set(\"fxsuggest-click\")",
        "            GleanMetrics.FxSuggest.isClicked.set(true)",
        "            GleanMetrics.FxSuggest.position.set(Int64(position))",
        "            switch telemetryInfo {",
        "            case let .amp(blockId, advertiser, iabCategory, _, clickReportingURL):",
        "                GleanMetrics.FxSuggest.blockId.set(blockId)",
        "                GleanMetrics.FxSuggest.advertiser.set(advertiser)",
        "                GleanMetrics.FxSuggest.iabCategory.set(iabCategory)",
        "                if let clickReportingURL {",
        "                    GleanMetrics.FxSuggest.reportingUrl.set(url: clickReportingURL)",
        "                }",
        "            case .wikipedia:",
        "                GleanMetrics.FxSuggest.advertiser.set(\"wikipedia\")",
        "            }",
        "            GleanMetrics.Pings.shared.fxSuggest.submit()",
        "        case(.action, .view, .fxSuggest, _, let extras):",
        "            guard let contextIdString = TelemetryContextualIdentifier.contextId,",
        "                  let contextId = UUID(uuidString: contextIdString),",
        "                  let telemetryInfo = extras?[EventValue.fxSuggestionTelemetryInfo.rawValue] as? RustFirefoxSuggestionTelemetryInfo,",
        "                  let position = extras?[EventValue.fxSuggestionPosition.rawValue] as? Int,",
        "                  let didTap = extras?[EventValue.fxSuggestionDidTap.rawValue] as? Bool,",
        "                  let didAbandonSearchSession = extras?[EventValue.fxSuggestionDidAbandonSearchSession.rawValue] as? Bool else {",
        "                return recordUninstrumentedMetrics(category: category, method: method, object: object, value: value, extras: extras)",
        "            }",
        "            // Record an event for this impression in the `events` ping.",
        "            // These events include the `client_id`, and we record them for",
        "            // engaged and abandoned search sessions.",
        "            let searchResultImpressionExtra = switch telemetryInfo {",
        "            case .amp: GleanMetrics.Awesomebar.SearchResultImpressionExtra(type: \"amp-suggestion\")",
        "            case .wikipedia: GleanMetrics.Awesomebar.SearchResultImpressionExtra(type: \"wikipedia-suggestion\")",
        "            }",
        "            GleanMetrics.Awesomebar.searchResultImpression.record(searchResultImpressionExtra)",
        "            // Submit a separate `fx-suggest` ping for this impression.",
        "            // These pings do not include the `client_id`, and we only submit",
        "            // them for engaged search sessions.",
        "            if didAbandonSearchSession { break }",
        "            GleanMetrics.FxSuggest.contextId.set(contextId)",
        "            GleanMetrics.FxSuggest.pingType.set(\"fxsuggest-impression\")",
        "            GleanMetrics.FxSuggest.isClicked.set(didTap)",
        "            GleanMetrics.FxSuggest.position.set(Int64(position))",
        "            switch telemetryInfo {",
        "            case let .amp(blockId, advertiser, iabCategory, impressionReportingURL, _):",
        "                GleanMetrics.FxSuggest.blockId.set(blockId)",
        "                GleanMetrics.FxSuggest.advertiser.set(advertiser)",
        "                GleanMetrics.FxSuggest.iabCategory.set(iabCategory)",
        "                if let impressionReportingURL {",
        "                    GleanMetrics.FxSuggest.reportingUrl.set(url: impressionReportingURL)",
        "                }",
        "            case .wikipedia:",
        "                GleanMetrics.FxSuggest.advertiser.set(\"wikipedia\")",
        "            }",
        "            GleanMetrics.Pings.shared.fxSuggest.submit()",
        "        // MARK: - Uninstrumented",
        "        default:",
        "            recordUninstrumentedMetrics(category: category, method: method, object: object, value: value, extras: extras)",
        "        }"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    static func gleanRecordEvent(category: EventCategory, method: EventMethod, object: EventObject, value: EventValue? = nil, extras: [String: Any]? = nil) {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/WebviewTelemetry.swift",
      "line": 6,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "import Glean"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "import Foundation"
      ],
      "context_after": [
        "",
        "/// Measure with a time distribution https://mozilla.github.io/glean/book/reference/metrics/timing_distribution.html"
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/WebviewTelemetry.swift",
      "line": 13,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "    private var loadTimerId: GleanTimerId?"
      ],
      "ecosia_code": [],
      "context_before": [
        "/// how long it takes to load a webpage",
        "final class WebViewLoadMeasurementTelemetry {"
      ],
      "context_after": [
        "",
        "    func start() {"
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/WebviewTelemetry.swift",
      "line": 18,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        loadTimerId = GleanMetrics.Webview.pageLoad.start()"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func start() {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/WebviewTelemetry.swift",
      "line": 24,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        guard let timerId = loadTimerId else { return }",
        "        GleanMetrics.Webview.pageLoad.stopAndAccumulate(timerId)",
        "        loadTimerId = nil"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func stop() {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Client/Telemetry/WebviewTelemetry.swift",
      "line": 32,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        if let loadTimerId {",
        "            GleanMetrics.Webview.pageLoad.cancel(loadTimerId)",
        "        }"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    func cancel() {"
      ],
      "context_after": [
        "    }",
        "}"
      ]
    },
    {
      "file": "firefox-ios/Extensions/ShareTo/SendToDevice.swift",
      "line": 15,
      "type": "removal",
      "comment": "Swap Theme Manager with Ecosia's",
      "firefox_code": [
        "    private let themeManager = DefaultThemeManager(sharedContainerIdentifier: AppInfo.sharedContainerIdentifier)"
      ],
      "ecosia_code": [],
      "context_before": [
        "    weak var delegate: ShareControllerDelegate?",
        ""
      ],
      "context_after": [
        "    private let themeManager = EcosiaThemeManager(sharedContainerIdentifier: AppInfo.sharedContainerIdentifier)",
        ""
      ]
    },
    {
      "file": "firefox-ios/Extensions/ShareTo/ShareViewController.swift",
      "line": 82,
      "type": "removal",
      "comment": "Swap Theme Manager with Ecosia's",
      "firefox_code": [
        "    private let themeManager: ThemeManager = DefaultThemeManager(sharedContainerIdentifier: AppInfo.sharedContainerIdentifier)"
      ],
      "ecosia_code": [],
      "context_before": [
        "    private var pageInfoRowTitleLabel: UILabel?",
        "    private var pageInfoRowUrlLabel: UILabel?"
      ],
      "context_after": [
        "    private let themeManager = EcosiaThemeManager(sharedContainerIdentifier: AppInfo.sharedContainerIdentifier)",
        ""
      ]
    },
    {
      "file": "firefox-ios/Extensions/ShareTo/ShareViewController.swift",
      "line": 154,
      "type": "removal",
      "comment": "Update image iname",
      "firefox_code": [
        "                imageName: StandardImageIdentifiers.Large.logoFirefox,"
      ],
      "ecosia_code": [],
      "context_before": [
        "                addTo: stackView,",
        "                label: .ShareOpenInFirefox,"
      ],
      "context_after": [
        "                imageName: \"atlas\",",
        "                action: #selector(actionOpenInFirefoxNow),"
      ]
    },
    {
      "file": "firefox-ios/Extensions/ShareTo/ShareViewController.swift",
      "line": 164,
      "type": "removal",
      "comment": "Update image iname",
      "firefox_code": [
        "                 imageName: StandardImageIdentifiers.Large.tabTray,"
      ],
      "ecosia_code": [],
      "context_before": [
        "                addTo: stackView,",
        "                label: .ShareLoadInBackground,"
      ],
      "context_after": [
        "                imageName: \"load\",",
        "                action: #selector(actionLoadInBackground),"
      ]
    },
    {
      "file": "firefox-ios/Extensions/ShareTo/ShareViewController.swift",
      "line": 174,
      "type": "removal",
      "comment": "Update image iname",
      "firefox_code": [
        "                imageName: StandardImageIdentifiers.Large.bookmark,"
      ],
      "ecosia_code": [],
      "context_before": [
        "                addTo: stackView,",
        "                label: .ShareBookmarkThisPage,"
      ],
      "context_after": [
        "                imageName: \"bookmarkAdd\",",
        "                action: #selector(actionBookmarkThisPage),"
      ]
    },
    {
      "file": "firefox-ios/Extensions/ShareTo/ShareViewController.swift",
      "line": 188,
      "type": "removal",
      "comment": "Remove Send To Device option as not offered",
      "firefox_code": [
        "            makeSeparator(addTo: stackView)",
        "            makeActionRow(",
        "                addTo: stackView,",
        "                label: .ShareSendToDevice,",
        "                imageName: StandardImageIdentifiers.Large.deviceDesktopSend,",
        "                action: #selector(actionSendToDevice),",
        "                hasNavigation: true",
        "            )"
      ],
      "ecosia_code": [],
      "context_before": [
        "                hasNavigation: false",
        "            )"
      ],
      "context_after": [
        "        } else {",
        "            pageInfoRowUrlLabel?.removeFromSuperview()"
      ]
    },
    {
      "file": "firefox-ios/Extensions/ShareTo/ShareViewController.swift",
      "line": 320,
      "type": "removal",
      "comment": "Update UIImage gather",
      "firefox_code": [
        "        let icon = UIImageView(image: UIImage(named: imageName)?.withRenderingMode(.alwaysTemplate))"
      ],
      "ecosia_code": [],
      "context_before": [
        "        actionRowHeights.append(heightConstraint)",
        ""
      ],
      "context_after": [
        "        var icon = UIImageView(image: UIImage(named: imageName)?.withRenderingMode(.alwaysTemplate))",
        "        if let image = UIImage(named: imageName, in: .ecosia, with: nil)?.withRenderingMode(.alwaysTemplate) {"
      ]
    },
    {
      "file": "firefox-ios/Extensions/ShareTo/ShareViewController.swift",
      "line": 419,
      "type": "addition",
      "comment": "Assign specific Tint Color",
      "firefox_code": [],
      "ecosia_code": [
        "        navigationController?.navigationBar.tintColor = theme.colors.actionPrimary",
        "        /* Ecosia: Update Title View with Ecosia logo",
        "        navigationItem.titleView = UIImageView(image: UIImage(named: \"Icon-Small\"))",
        "        */",
        "        navigationItem.titleView = UIImageView(image: .init(named: \"iconLogo\", in: .ecosia, with: nil))",
        "        navigationItem.titleView?.contentMode = .scaleAspectFit",
        "        navigationItem.leftBarButtonItem = UIBarButtonItem(",
        "            title: .SendToCancelButton,",
        "            style: .plain,",
        "            target: self,",
        "            action: #selector(finish)",
        "        )"
      ],
      "context_before": [
        "        navigationController?.navigationBar.scrollEdgeAppearance = appearance",
        "        navigationController?.navigationBar.isTranslucent = false"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Extensions/ShareTo/ShareViewController.swift",
      "line": 421,
      "type": "removal",
      "comment": "Update Title View with Ecosia logo",
      "firefox_code": [
        "        navigationItem.titleView = UIImageView(image: UIImage(named: \"Icon-Small\"))"
      ],
      "ecosia_code": [],
      "context_before": [
        "        // Ecosia: Assign specific Tint Color",
        "        navigationController?.navigationBar.tintColor = theme.colors.actionPrimary"
      ],
      "context_after": [
        "        navigationItem.titleView = UIImageView(image: .init(named: \"iconLogo\", in: .ecosia, with: nil))",
        "        navigationItem.titleView?.contentMode = .scaleAspectFit"
      ]
    },
    {
      "file": "firefox-ios/Project.swift",
      "line": 124,
      "type": "addition",
      "comment": "Exclude original Firefox files that are replaced by Ecosia versions",
      "firefox_code": [],
      "ecosia_code": [
        "                    \"Client/Frontend/Home/HomepageSectionType.swift\",",
        "                    \"Client/Frontend/Home/TopSites/Cell/TopSiteItemCell.swift\",",
        "                    \"Client/Ecosia/UI/NTP/DefaultBrowser.swift\","
      ],
      "context_before": [
        "                    \"Client/Frontend/Login/LoginViewController.swift\",",
        "                    \"Client/Frontend/Strings.swift\","
      ],
      "context_after": [
        "                    // Ecosia: Exclude Ecosia override files that are not currently used",
        "                    \"Client/Frontend/Widgets/EcosiaTabTrayButtonExtensions.swift\","
      ]
    },
    {
      "file": "firefox-ios/Project.swift",
      "line": 128,
      "type": "addition",
      "comment": "Exclude Ecosia override files that are not currently used",
      "firefox_code": [],
      "ecosia_code": [
        "                    \"Client/Frontend/Widgets/EcosiaTabTrayButtonExtensions.swift\","
      ],
      "context_before": [
        "                    \"Client/Frontend/Home/TopSites/Cell/TopSiteItemCell.swift\",",
        "                    \"Client/Ecosia/UI/NTP/DefaultBrowser.swift\","
      ],
      "context_after": [
        "                    // Ecosia: Exclude outdated color definitions (use Ecosia framework version)",
        "                    \"Client/Ecosia/UI/Theme/EcosiaColor.swift\","
      ]
    },
    {
      "file": "firefox-ios/Project.swift",
      "line": 130,
      "type": "addition",
      "comment": "Exclude outdated color definitions (use Ecosia framework version)",
      "firefox_code": [],
      "ecosia_code": [
        "                    \"Client/Ecosia/UI/Theme/EcosiaColor.swift\","
      ],
      "context_before": [
        "                    // Ecosia: Exclude Ecosia override files that are not currently used",
        "                    \"Client/Frontend/Widgets/EcosiaTabTrayButtonExtensions.swift\","
      ],
      "context_after": [
        "                    // Exclude new Redux tab management files not yet integrated",
        "                    \"Client/Frontend/Browser/Tabs/Action/TabManagerAction.swift\","
      ]
    },
    {
      "file": "firefox-ios/Project.swift",
      "line": 603,
      "type": "substitution",
      "comment": "Wrapper framework to re-export MozillaAppServices and avoid direct linking",
      "firefox_code": [
        "from multiple targets (which would embed MozillaRustComponents multiple times)"
      ],
      "ecosia_code": [
        "        .target(",
        "            name: \"RustMozillaAppServices\",",
        "            destinations: .iOS,",
        "            product: .framework,",
        "            bundleId: \"org.mozilla.ios.RustMozillaAppServices\",",
        "            infoPlist: .file(path: \"RustMozillaAppServices-Info.plist\"),",
        "            sources: [\"Tuist/RustMozillaAppServices.swift\"],",
        "            dependencies: ["
      ],
      "context_before": [
        "",
        "        // MARK: - RustMozillaAppServices Framework"
      ],
      "context_after": [
        "                // Link Binary With Libraries",
        "                .package(product: \"MozillaAppServices\"),"
      ]
    },
    {
      "file": "firefox-ios/Providers/TopSitesProvider.swift",
      "line": 129,
      "type": "removal",
      "comment": "Merge default sites including path to keep blog.ecosia.org + blog.ecosia.org/financial-results */",
      "firefox_code": [
        "        let unionOnURLAndPath = { (site: Site) -> String in",
        "            return URL(string: site.url)?.normalizedHostAndPath ?? \"\"",
        "        }",
        "        // Fetch the default sites",
        "        let defaultSites = defaultTopSites(prefs)",
        "        // Create PinnedSite objects. Used by the view layer to tell topsites apart",
        "        let pinnedSites: [Site] = pinnedSites.map({ PinnedSite(site: $0, faviconResource: nil) })",
        "        // Merge default topsites with a user's topsites.",
        "        let mergedSites = pinnedSites.union(sites, f: unionOnURL)",
        "        /* Ecosia: Get different `allSites`",
        "        // Filter out duplicates in merged sites, but do not remove duplicates within pinned sites",
        "        let duplicateFreeList = pinnedSites.union(mergedSites, f: unionOnURL).filter { $0 as? PinnedSite == nil }",
        "        let allSites = pinnedSites + duplicateFreeList"
      ],
      "ecosia_code": [],
      "context_before": [
        "        }",
        ""
      ],
      "context_after": [
        "        let allSites = mergedSites.union(defaultSites, f: unionOnURLAndPath)",
        ""
      ]
    },
    {
      "file": "firefox-ios/Shared/AppConstants.swift",
      "line": 9,
      "type": "substitution",
      "comment": "Update shortName",
      "firefox_code": [
        "case shortName = \"Firefox\""
      ],
      "ecosia_code": [
        "    case shortName = \"Ecosia\""
      ],
      "context_before": [
        "",
        "public enum AppName: String, CustomStringConvertible {"
      ],
      "context_after": [
        "",
        "    public var description: String {"
      ]
    },
    {
      "file": "firefox-ios/Shared/AppInfo.swift",
      "line": 25,
      "type": "removal",
      "comment": "Update group identifier",
      "firefox_code": [
        "        var bundleIdentifier = baseBundleIdentifier",
        "        if bundleIdentifier == \"org.mozilla.ios.FennecEnterprise\" {",
        "            // Bug 1373726 - Base bundle identifier incorrectly generated for Nightly builds",
        "            // This can be removed when we are able to fix the app group in the developer portal",
        "            bundleIdentifier = \"org.mozilla.ios.Fennec.enterprise\"",
        "        }",
        "        return prefix + \".\" + bundleIdentifier"
      ],
      "ecosia_code": [],
      "context_before": [
        "    /// Return the keychain access group.",
        "    public static func keychainAccessGroupWithPrefix(_ prefix: String) -> String {"
      ],
      "context_after": [
        "        ecosiaKeychainAccessGroupWithPrefix(prefix)",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Shared/AppInfo.swift",
      "line": 57,
      "type": "substitution",
      "comment": "update App Store ID",
      "firefox_code": [
        "public static var appStoreId = \"id989804926\""
      ],
      "ecosia_code": [
        "    public static var appStoreId = \"id670881887\""
      ],
      "context_before": [
        "",
        "    // The App Store page identifier for the Firefox iOS application"
      ],
      "context_after": [
        "",
        "    /// Return the shared container identifier (also known as the app group) to be used with for example background"
      ]
    },
    {
      "file": "firefox-ios/Shared/AppInfo.swift",
      "line": 64,
      "type": "removal",
      "comment": "Update group identifier",
      "firefox_code": [
        "        var bundleIdentifier = baseBundleIdentifier",
        "        if bundleIdentifier == \"org.mozilla.ios.FennecEnterprise\" {",
        "            // Bug 1373726 - Base bundle identifier incorrectly generated for Nightly builds",
        "            // This can be removed when we are able to fix the app group in the developer portal",
        "            bundleIdentifier = \"org.mozilla.ios.Fennec.enterprise\"",
        "        }",
        "        return \"group.\" + bundleIdentifier"
      ],
      "ecosia_code": [],
      "context_before": [
        "    /// http requests. It is the base bundle identifier with a \"group.\" prefix.",
        "    public static var sharedContainerIdentifier: String {"
      ],
      "context_after": [
        "        ecosiaSharedContainerIdentifier",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Shared/AppInfo.swift",
      "line": 77,
      "type": "addition",
      "comment": "Add file specific info here to avoid issues with dependencies",
      "firefox_code": [],
      "ecosia_code": [
        "extension AppInfo {"
      ],
      "context_before": [
        "}",
        ""
      ],
      "context_after": [
        "    /// Return the shared container identifier (also known as the app group) to be used with for example background",
        "    /// http requests. It is the base bundle identifier with a \"group.\" prefix."
      ]
    },
    {
      "file": "firefox-ios/Shared/Extensions/URLExtensions.swift",
      "line": 199,
      "type": "removal",
      "comment": "Create homepage url constant",
      "firefox_code": [
        "    public var isFxHomeUrl: Bool {",
        "        return absoluteString.hasPrefix(\"internal://local/about/home\")",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "    public static let homepageUrlString = \"internal://local/about/home\"",
        "    public var isFxHomeUrl: Bool {"
      ]
    },
    {
      "file": "firefox-ios/Shared/UserAgent.swift",
      "line": 14,
      "type": "addition",
      "comment": "Add Ecosia UserAgent info",
      "firefox_code": [],
      "ecosia_code": [
        "    public static let uaBitVersion = \"Version/\\(UIDevice.current.systemVersion)\"",
        "    public static var uaBitEcosia: String {",
        "        let ecosiaAppVersion = AppInfo.applicationBundle.object(forInfoDictionaryKey: \"CFBundleShortVersionString\") as! String",
        "        return \"(Ecosia ios@\\(ecosiaAppVersion).\\(AppInfo.buildNumber))\""
      ],
      "context_before": [
        "    public static let uaBitMobile = \"Mobile/15E148\"",
        "    public static let uaBitFx = \"FxiOS/\\(AppInfo.appVersion)\""
      ],
      "context_after": [
        "    }",
        "    public static let ecosiaDesktopUA = \"\\(UserAgent.desktopUserAgent()) \\(UserAgent.uaBitEcosia)\""
      ]
    },
    {
      "file": "firefox-ios/Shared/UserAgent.swift",
      "line": 42,
      "type": "substitution",
      "comment": "update UA prefix",
      "firefox_code": [
        "return clientUserAgent(prefix: \"Firefox-iOS-Sync\")"
      ],
      "ecosia_code": [
        "        return clientUserAgent(prefix: \"Ecosia-iOS-Sync\")"
      ],
      "context_before": [
        "",
        "    public static var syncUserAgent: String {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Shared/UserAgent.swift",
      "line": 48,
      "type": "substitution",
      "comment": "update UA prefix",
      "firefox_code": [
        "return clientUserAgent(prefix: \"Firefox-iOS-Token\")"
      ],
      "ecosia_code": [
        "        return clientUserAgent(prefix: \"Ecosia-iOS-Token\")"
      ],
      "context_before": [
        "",
        "    public static var tokenServerClientUserAgent: String {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Shared/UserAgent.swift",
      "line": 54,
      "type": "substitution",
      "comment": "update UA prefix",
      "firefox_code": [
        "return clientUserAgent(prefix: \"Firefox-iOS-FxA\")"
      ],
      "ecosia_code": [
        "        return clientUserAgent(prefix: \"Ecosia-iOS-EcosiaA\")"
      ],
      "context_before": [
        "",
        "    public static var fxaUserAgent: String {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Shared/UserAgent.swift",
      "line": 60,
      "type": "substitution",
      "comment": "update UA prefix",
      "firefox_code": [
        "return clientUserAgent(prefix: \"Firefox-iOS\")"
      ],
      "ecosia_code": [
        "        return clientUserAgent(prefix: \"Ecosia-iOS\")"
      ],
      "context_before": [
        "",
        "    public static var defaultClientUserAgent: String {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/Shared/UserAgent.swift",
      "line": 89,
      "type": "removal",
      "comment": "review User Aget retrieval",
      "firefox_code": [
        "        switch platform {",
        "        case .Desktop:",
        "            guard let customUA = CustomUserAgentConstant.customDesktopUAForDomain[domain] else {",
        "                return desktopUserAgent()",
        "            }",
        "            return customUA",
        "        case .Mobile:",
        "            guard let customUA = CustomUserAgentConstant.customMobileUAForDomain[domain] else {",
        "                return mobileUserAgent()",
        "            }",
        "            return customUA",
        "        }"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    public static func getUserAgent(domain: String, platform: UserAgentPlatform) -> String {"
      ],
      "context_after": [
        "        switch platform {",
        "        case .Desktop:"
      ]
    },
    {
      "file": "firefox-ios/Shared/UserAgent.swift",
      "line": 139,
      "type": "addition",
      "comment": "Re-introduce paypal UA so it uses the Firefox one",
      "firefox_code": [],
      "ecosia_code": [
        "        \"paypal.com\": UserAgentBuilder.defaultFirefoxMobileUserAgent().userAgent(),",
        "        \"disneyplus.com\": customDesktopUA",
        "    ]"
      ],
      "context_before": [
        "",
        "    static let customMobileUAForDomain = ["
      ],
      "context_after": [
        "",
        "    static let customDesktopUAForDomain = ["
      ]
    },
    {
      "file": "firefox-ios/Shared/UserAgent.swift",
      "line": 145,
      "type": "removal",
      "comment": "Update paypal UA so it uses the Firefox one",
      "firefox_code": [
        "        \"paypal.com\": defaultMobileUA,"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    static let customDesktopUAForDomain = ["
      ],
      "context_after": [
        "        \"paypal.com\": UserAgentBuilder.defaultFirefoxMobileUserAgent().userAgent(),",
        "        \"firefox.com\": defaultMobileUA,"
      ]
    },
    {
      "file": "firefox-ios/Shared/UserAgent.swift",
      "line": 150,
      "type": "addition",
      "comment": "Add Ecosia URLs",
      "firefox_code": [],
      "ecosia_code": [
        "        Ecosia.URLProvider.production.domain: UserAgent.ecosiaDesktopUA,",
        "        Ecosia.URLProvider.staging.domain: UserAgent.ecosiaDesktopUA",
        "    ]"
      ],
      "context_before": [
        "        \"paypal.com\": UserAgentBuilder.defaultFirefoxMobileUserAgent().userAgent(),",
        "        \"firefox.com\": defaultMobileUA,"
      ],
      "context_after": [
        "}",
        ""
      ]
    },
    {
      "file": "firefox-ios/Shared/UserAgent.swift",
      "line": 207,
      "type": "removal",
      "comment": "Always returns the Ecosia's UA as default one",
      "firefox_code": [
        "        return UserAgentBuilder(",
        "            product: UserAgent.product,",
        "            systemInfo: \"(\\(UIDevice.current.model); CPU iPhone OS \\(UIDevice.current.systemVersion.replacingOccurrences(of: \".\", with: \"_\")) like Mac OS X)\",",
        "            platform: UserAgent.platform,",
        "            platformDetails: UserAgent.platformDetails,",
        "            extensions: \"FxiOS/\\(AppInfo.appVersion)  \\(UserAgent.uaBitMobile) \\(UserAgent.uaBitSafari)\")"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    public static func defaultMobileUserAgent() -> UserAgentBuilder {"
      ],
      "context_after": [
        "        return UserAgentBuilder.ecosiaMobileUserAgent()",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Shared/UserAgent.swift",
      "line": 224,
      "type": "removal",
      "comment": "Update extension",
      "firefox_code": [
        "            extensions: \"FxiOS/\\(AppInfo.appVersion) \\(UserAgent.uaBitSafari)\")"
      ],
      "ecosia_code": [],
      "context_before": [
        "            platform: UserAgent.platform,",
        "            platformDetails: UserAgent.platformDetails,"
      ],
      "context_after": [
        "            extensions: \"\\(UserAgent.uaBitVersion) \\(UserAgent.uaBitMobile) \\(UserAgent.uaBitSafari)\")",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Shared/UserAgent.swift",
      "line": 231,
      "type": "addition",
      "comment": "Ecosia Mobile UA + Firefox",
      "firefox_code": [],
      "ecosia_code": [
        "extension UserAgentBuilder {"
      ],
      "context_before": [
        "}",
        ""
      ],
      "context_after": [
        "",
        "    public static func ecosiaMobileUserAgent() -> UserAgentBuilder {"
      ]
    },
    {
      "file": "firefox-ios/Storage/DefaultSuggestedSites.swift",
      "line": 10,
      "type": "removal",
      "comment": "Remove Default Suggested Sites",
      "firefox_code": [
        "    private static let urlMap = [",
        "        \"https://www.amazon.com/\": [",
        "            \"as\": \"https://www.amazon.in\",",
        "            \"cy\": \"https://www.amazon.co.uk\",",
        "            \"da\": \"https://www.amazon.co.uk\",",
        "            \"de\": \"https://www.amazon.de\",",
        "            \"dsb\": \"https://www.amazon.de\",",
        "            \"en_GB\": \"https://www.amazon.co.uk\",",
        "            \"et\": \"https://www.amazon.co.uk\",",
        "            \"ff\": \"https://www.amazon.fr\",",
        "            \"ga_IE\": \"https://www.amazon.co.uk\",",
        "            \"gu_IN\": \"https://www.amazon.in\",",
        "            \"hi_IN\": \"https://www.amazon.in\",",
        "            \"hr\": \"https://www.amazon.co.uk\",",
        "            \"hsb\": \"https://www.amazon.de\",",
        "            \"ja\": \"https://www.amazon.co.jp\",",
        "            \"kn\": \"https://www.amazon.in\",",
        "            \"mr\": \"https://www.amazon.in\",",
        "            \"or\": \"https://www.amazon.in\",",
        "            \"sq\": \"https://www.amazon.co.uk\",",
        "            \"ta\": \"https://www.amazon.in\",",
        "            \"te\": \"https://www.amazon.in\",",
        "            \"ur\": \"https://www.amazon.in\",",
        "            \"en_CA\": \"https://www.amazon.ca\",",
        "            \"fr_CA\": \"https://www.amazon.ca\"",
        "        ]",
        "    ]",
        "    private static let sites = [",
        "        \"default\": [",
        "            SuggestedSite(",
        "                url: \"https://m.facebook.com/\",",
        "                title: .DefaultSuggestedFacebook,",
        "                trackingId: 632,",
        "                faviconResource: .bundleAsset(",
        "                    name: \"facebook\",",
        "                    forRemoteResource: URL(string: \"https://static.xx.fbcdn.net/rsrc.php/v3/yi/r/4Kv5U5b1o3f.png\")!",
        "                )",
        "            ),",
        "            SuggestedSite(",
        "                url: \"https://m.youtube.com/\",",
        "                title: .DefaultSuggestedYouTube,",
        "                trackingId: 631,",
        "                faviconResource: .bundleAsset(",
        "                    name: \"youtube\",",
        "                    forRemoteResource: URL(string: \"https://m.youtube.com/static/apple-touch-icon-180x180-precomposed.png\")!",
        "                )",
        "            ),",
        "            SuggestedSite(",
        "                url: \"https://www.amazon.com/\",",
        "                title: .DefaultSuggestedAmazon,",
        "                trackingId: 630,",
        "                // NOTE: Amazon does not host a high quality favicon. We are falling back to the one hosted in our",
        "                // ContileProvider.contileProdResourceEndpoint (https://ads.mozilla.org/v1/tiles).",
        "                faviconResource: .bundleAsset(",
        "                    name: \"amazon\",",
        "                    forRemoteResource: URL(string: \"https://tiles-cdn.prod.ads.prod.webservices.mozgcp.net/CAP5k4gWqcBGwir7bEEmBWveLMtvldFu-y_kyO3txFA=.9991.jpg\")!",
        "                )",
        "            ),",
        "            SuggestedSite(",
        "                url: \"https://www.wikipedia.org/\",",
        "                title: .DefaultSuggestedWikipedia,",
        "                trackingId: 629,",
        "                faviconResource: .bundleAsset(",
        "                    name: \"wikipedia\",",
        "                    forRemoteResource: URL(string: \"https://www.wikipedia.org/static/apple-touch/wikipedia.png\")!",
        "                )",
        "            ),",
        "            SuggestedSite(",
        "                url: \"https://x.com/\",",
        "                title: .DefaultSuggestedX,",
        "                trackingId: 628,",
        "                faviconResource: .bundleAsset(",
        "                    name: \"x\",",
        "                    forRemoteResource: URL(string: \"https://abs.twimg.com/responsive-web/client-web/icon-ios.77d25eba.png\")!",
        "                )",
        "            )",
        "        ],",
        "        \"zh_CN\": [ // FIXME Do we still want this as a special case localization? Android doesn't compile this vers. anymore",
        "            SuggestedSite(",
        "                url: \"http://mozilla.com.cn\",",
        "                title: \"ç«ç‹ç¤¾åŒº\",",
        "                trackingId: 700,",
        "                // FIXME We need a higher quality favicon link",
        "                faviconResource: .remoteURL(url: URL(string: \"http://mozilla.com.cn/favicon.ico\")!)",
        "            ),",
        "            SuggestedSite(",
        "                url: \"https://m.baidu.com/\",",
        "                title: \"ç™¾åº¦\",",
        "                trackingId: 701,",
        "                faviconResource: .remoteURL(url: URL(string: \"https://psstatic.cdn.bcebos.com/video/wiseindex/aa6eef91f8b5b1a33b454c401_1660835115000.png\")!)",
        "            ),",
        "            SuggestedSite(",
        "                url: \"http://sina.cn\",",
        "                title: \"æ–°æµª\",",
        "                trackingId: 702,",
        "                faviconResource: .remoteURL(url: URL(string: \"https://mjs.sinaimg.cn/wap/online/public/images/addToHome/sina_114x114_v1.png\")!)",
        "            ),",
        "            SuggestedSite(",
        "                url: \"http://info.3g.qq.com/g/s?aid=index&g_f=23946&g_ut=3\",",
        "                title: \"è…¾è®¯\",",
        "                trackingId: 703,",
        "                faviconResource: .remoteURL(url: URL(string: \"https://mat1.gtimg.com/qqcdn/qqindex2021/favicon.ico\")!)",
        "            ),",
        "            SuggestedSite(",
        "                url: \"http://m.taobao.com\",",
        "                title: \"æ·˜å®\",",
        "                trackingId: 704,",
        "                faviconResource: .remoteURL(url: URL(string: \"https://gw.alicdn.com/tps/i2/TB1nmqyFFXXXXcQbFXXE5jB3XXX-114-114.png\")!)",
        "            ),",
        "            SuggestedSite(",
        "                url: \"\"\"",
        "                https://union-click.jd.com/jdc?e=618%7Cpc%7C&p=JF8BAKgJK1olXDYDZBoCUBV\\",
        "                IMzZNXhpXVhgcCEEGXVRFXTMWFQtAM1hXWFttFkhAaihBfRN1XE5ZMipYVQ1uYwxAa1cZb\\",
        "                QIHUV9bCUkQAF8LGFoRXgcAXVttOEsSMyRmGmsXXAcAXFdaAEwVM28PH10TVAMHVVpbDE8\\",
        "                nBG8BKydLFl5fCQ5eCUsSM184GGsSXQ8WUiwcWl8RcV84G1slXTZdEAMAOEkWAmsBK2s",
        "                \"\"\",",
        "                title: \"äº¬ä¸œ\",",
        "                trackingId: 705,",
        "                // FIXME We need a higher quality favicon link",
        "                faviconResource: .remoteURL(url: URL(string: \"https://corporate.jd.com/favicon.ico\")!)",
        "            )",
        "        ]",
        "    ]"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "open class DefaultSuggestedSites {"
      ],
      "context_after": [
        "",
        "    public static func defaultSites() -> [Site] {"
      ]
    },
    {
      "file": "firefox-ios/Storage/DefaultSuggestedSites.swift",
      "line": 138,
      "type": "removal",
      "comment": "Remove default sites",
      "firefox_code": [
        "        let locale = Locale.current",
        "        let defaultSites = sites[locale.identifier] ?? sites[\"default\"]",
        "        return defaultSites?.map { data in",
        "            if let domainMap = DefaultSuggestedSites.urlMap[data.url], let localizedURL = domainMap[locale.identifier] {",
        "                return SuggestedSite(url: localizedURL,",
        "                                     title: data.title,",
        "                                     trackingId: data.trackingId,",
        "                                     faviconResource: data.faviconResource)",
        "            }",
        "            return data",
        "        } ?? []"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    public static func defaultSites() -> [Site] {"
      ],
      "context_after": [
        "        []",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/Storage/Rust/RustLogins.swift",
      "line": 6,
      "type": "removal",
      "comment": "remove Glean dependency",
      "firefox_code": [
        "import Glean"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "import Foundation"
      ],
      "context_after": [
        "import Shared",
        "import Common"
      ]
    },
    {
      "file": "firefox-ios/Storage/Rust/RustLogins.swift",
      "line": 1085,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "                        GleanMetrics.LoginsStoreKeyRegeneration.corrupt.record()"
      ],
      "ecosia_code": [],
      "context_before": [
        "                                        level: .warning,",
        "                                        category: .storage)"
      ],
      "context_after": [
        "                        self.resetLoginsAndKey(rustKeys: rustKeys, completion: completion)",
        "                    }"
      ]
    },
    {
      "file": "firefox-ios/Storage/Rust/RustLogins.swift",
      "line": 1103,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "                GleanMetrics.LoginsStoreKeyRegeneration.other.record()"
      ],
      "ecosia_code": [],
      "context_before": [
        "                                level: .warning,",
        "                                category: .storage)"
      ],
      "context_after": [
        "                self.resetLoginsAndKey(rustKeys: rustKeys, completion: completion)",
        "            case (.none, .some(encryptedCanaryPhrase)):"
      ]
    },
    {
      "file": "firefox-ios/Storage/Rust/RustLogins.swift",
      "line": 1113,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "                GleanMetrics.LoginsStoreKeyRegeneration.lost.record()"
      ],
      "ecosia_code": [],
      "context_before": [
        "                                level: .warning,",
        "                                category: .storage)"
      ],
      "context_after": [
        "                self.resetLoginsAndKey(rustKeys: rustKeys, completion: completion)",
        "            case (.none, .none):"
      ]
    },
    {
      "file": "firefox-ios/Storage/Rust/RustLogins.swift",
      "line": 1136,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "                        GleanMetrics.LoginsStoreKeyRegeneration.keychainDataLost.record()"
      ],
      "ecosia_code": [],
      "context_before": [
        "                        // Since the key data isn't present and we have login records in",
        "                        // the database, we both clear the database and reset the key."
      ],
      "context_after": [
        "                        self.resetLoginsAndKey(rustKeys: rustKeys, completion: completion)",
        "                    } else {"
      ]
    },
    {
      "file": "firefox-ios/WidgetKit/ImageButtonWithLabel.swift",
      "line": 86,
      "type": "addition",
      "comment": "add color",
      "firefox_code": [],
      "ecosia_code": [
        "                                    .foregroundColor(link.textColor)",
        "                            } else {",
        "                                Text(link.label)",
        "                                    .font(.footnote)",
        "                                    .minimumScaleFactor(0.75)",
        "                                    .layoutPriority(1000)"
      ],
      "context_before": [
        "                                    .minimumScaleFactor(0.75)",
        "                                    .layoutPriority(1000)"
      ],
      "context_after": [
        "                                    // Ecosia: add color",
        "                                    .foregroundColor(link.textColor)"
      ]
    },
    {
      "file": "firefox-ios/WidgetKit/ImageButtonWithLabel.swift",
      "line": 93,
      "type": "addition",
      "comment": "add color",
      "firefox_code": [],
      "ecosia_code": [
        "                                    .foregroundColor(link.textColor)"
      ],
      "context_before": [
        "                                    .minimumScaleFactor(0.75)",
        "                                    .layoutPriority(1000)"
      ],
      "context_after": [
        "                            }",
        "                        }"
      ]
    },
    {
      "file": "firefox-ios/WidgetKit/ImageButtonWithLabel.swift",
      "line": 98,
      "type": "removal",
      "comment": "Update image",
      "firefox_code": [
        "                        if link == .search && isSmall {",
        "                            Image(decorative: StandardImageIdentifiers.Large.search)",
        "                                .scaledToFit()",
        "                                .frame(height: 24.0)",
        "                        } else {",
        "                            Image(decorative: link.imageName)",
        "                                .scaledToFit()",
        "                                .frame(height: 24.0)",
        "                        }"
      ],
      "ecosia_code": [],
      "context_before": [
        "                        }",
        "                        Spacer()"
      ],
      "context_after": [
        "                        Image(decorative: link.imageName, bundle: .ecosia)",
        "                            .scaledToFit()"
      ]
    },
    {
      "file": "firefox-ios/WidgetKit/ImageButtonWithLabel.swift",
      "line": 117,
      "type": "removal",
      "comment": "Update image",
      "firefox_code": [
        "                            Image(decorative: \"faviconFox\")",
        "                             .scaledToFit()",
        "                             .frame(height: 24.0)"
      ],
      "ecosia_code": [],
      "context_before": [
        "                        HStack(alignment: .bottom) {",
        "                            Spacer()"
      ],
      "context_after": [
        "                            Image(decorative: \"iconLogo\", bundle: .ecosia)",
        "                                .scaledToFit()"
      ]
    },
    {
      "file": "firefox-ios/WidgetKit/ImageButtonWithLabel.swift",
      "line": 129,
      "type": "removal",
      "comment": "Update color",
      "firefox_code": [
        "                .foregroundColor(Color(\"widgetLabelColors\"))"
      ],
      "ecosia_code": [],
      "context_before": [
        "                    }",
        "                }"
      ],
      "context_after": [
        "                .foregroundColor(Color.ecosiaBundledColorWithName(\"widgetLabelColors\"))",
        "                .padding([.horizontal, .vertical], paddingValue)"
      ]
    },
    {
      "file": "firefox-ios/WidgetKit/OpenTabs/OpenTabsWidget.swift",
      "line": 10,
      "type": "addition",
      "comment": "Additional imports for Ecosia framework and suggested sites updates",
      "firefox_code": [],
      "ecosia_code": [
        "import Ecosia",
        "import Storage"
      ],
      "context_before": [
        "import Combine",
        "import Common"
      ],
      "context_after": [
        "",
        "struct OpenTabsWidget: Widget {"
      ]
    },
    {
      "file": "firefox-ios/WidgetKit/OpenTabs/OpenTabsWidget.swift",
      "line": 31,
      "type": "removal",
      "comment": "Update Environment state definition",
      "firefox_code": [
        "    @Environment(\\.widgetFamily)"
      ],
      "ecosia_code": [],
      "context_before": [
        "    let entry: OpenTabsEntry",
        ""
      ],
      "context_after": [
        "    @SwiftUI.Environment(\\.widgetFamily)",
        "    var widgetFamily"
      ]
    },
    {
      "file": "firefox-ios/WidgetKit/OpenTabs/OpenTabsWidget.swift",
      "line": 52,
      "type": "removal",
      "comment": "update color",
      "firefox_code": [
        "                        .foregroundColor(Color.white)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "                    Text(tab.title!)"
      ],
      "context_after": [
        "                        .foregroundColor(.ecosiaBundledColorWithName(\"PrimaryText\"))",
        "                        .multilineTextAlignment(.leading)"
      ]
    },
    {
      "file": "firefox-ios/WidgetKit/OpenTabs/OpenTabsWidget.swift",
      "line": 63,
      "type": "removal",
      "comment": "update color",
      "firefox_code": [
        "                .fill(Color(UIColor(red: 0.85, green: 0.85, blue: 0.85, alpha: 0.3)))"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "            Rectangle()"
      ],
      "context_after": [
        "                .fill(Color.ecosiaBundledColorWithName(\"Border\"))",
        "                .frame(height: 0.5)"
      ]
    },
    {
      "file": "firefox-ios/WidgetKit/OpenTabs/OpenTabsWidget.swift",
      "line": 74,
      "type": "removal",
      "comment": "Update image and color",
      "firefox_code": [
        "            Image(decorative: StandardImageIdentifiers.Small.externalLink).foregroundColor(Color.white)"
      ],
      "ecosia_code": [],
      "context_before": [
        "    var openFirefoxButton: some View {",
        "        HStack(alignment: .center, spacing: 15) {"
      ],
      "context_after": [
        "            Image(decorative: \"openEcosia\", bundle: .ecosia)",
        "                .foregroundColor(.ecosiaBundledColorWithName(\"PrimaryText\"))"
      ]
    },
    {
      "file": "firefox-ios/WidgetKit/OpenTabs/OpenTabsWidget.swift",
      "line": 79,
      "type": "addition",
      "comment": "Leave \"Open Firefox\" as within the WidgetKit Strings the key matches.",
      "firefox_code": [],
      "ecosia_code": [
        "                /* Ecosia: update color",
        "                .foregroundColor(Color.white).lineLimit(1)",
        "                */",
        "                .foregroundColor(.ecosiaBundledColorWithName(\"PrimaryText\")).lineLimit(1)",
        "                .font(.system(size: 13, weight: .semibold, design: .default))",
        "            Spacer()",
        "        }.padding([.horizontal])"
      ],
      "context_before": [
        "            Image(decorative: \"openEcosia\", bundle: .ecosia)",
        "                .foregroundColor(.ecosiaBundledColorWithName(\"PrimaryText\"))"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/WidgetKit/OpenTabs/OpenTabsWidget.swift",
      "line": 80,
      "type": "removal",
      "comment": "update color",
      "firefox_code": [
        "                .foregroundColor(Color.white).lineLimit(1)"
      ],
      "ecosia_code": [],
      "context_before": [
        "                .foregroundColor(.ecosiaBundledColorWithName(\"PrimaryText\"))",
        "            Text(\"Open Firefox\") // Ecosia: Leave \"Open Firefox\" as within the WidgetKit Strings the key matches."
      ],
      "context_after": [
        "                .foregroundColor(.ecosiaBundledColorWithName(\"PrimaryText\")).lineLimit(1)",
        "                .font(.system(size: 13, weight: .semibold, design: .default))"
      ]
    },
    {
      "file": "firefox-ios/WidgetKit/OpenTabs/OpenTabsWidget.swift",
      "line": 104,
      "type": "removal",
      "comment": "Update image",
      "firefox_code": [
        "                        Image(decorative: StandardImageIdentifiers.Small.externalLink)"
      ],
      "ecosia_code": [],
      "context_before": [
        "                    HStack {",
        "                        Spacer()"
      ],
      "context_after": [
        "                        Image(decorative: \"openEcosia\", bundle: .ecosia)",
        "                        Text(String.OpenFirefoxLabel)"
      ]
    },
    {
      "file": "firefox-ios/WidgetKit/OpenTabs/OpenTabsWidget.swift",
      "line": 109,
      "type": "removal",
      "comment": "Update color",
      "firefox_code": [
        "                            .foregroundColor(Color.white).lineLimit(1)"
      ],
      "ecosia_code": [],
      "context_before": [
        "                        Image(decorative: \"openEcosia\", bundle: .ecosia)",
        "                        Text(String.OpenFirefoxLabel)"
      ],
      "context_after": [
        "                            .foregroundColor(.ecosiaBundledColorWithName(\"PrimaryText\")).lineLimit(1)",
        "                            .font(.system(size: 13, weight: .semibold, design: .default))"
      ]
    },
    {
      "file": "firefox-ios/WidgetKit/OpenTabs/OpenTabsWidget.swift",
      "line": 117,
      "type": "substitution",
      "comment": "update color",
      "firefox_code": [
        ".foregroundColor(Color.white)"
      ],
      "ecosia_code": [
        "                .foregroundColor(.ecosiaBundledColorWithName(\"PrimaryText\"))",
        "            } else {",
        "                VStack(spacing: 8) {",
        "                    ForEach(entry.tabs.suffix(numberOfTabsToDisplay), id: \\.self) { tab in",
        "                        lineItemForTab(tab)"
      ],
      "context_before": [
        "                    }.padding(10)",
        "                }"
      ],
      "context_after": [
        "                    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/WidgetKit/OpenTabs/OpenTabsWidget.swift",
      "line": 141,
      "type": "removal",
      "comment": "Update color",
      "firefox_code": [
        "                            .foregroundColor(Color.white)"
      ],
      "ecosia_code": [],
      "context_before": [
        "                                )",
        "                            )"
      ],
      "context_after": [
        "                            .foregroundColor(.ecosiaBundledColorWithName(\"PrimaryText\"))",
        "                            .lineLimit(1)"
      ]
    },
    {
      "file": "firefox-ios/WidgetKit/OpenTabs/OpenTabsWidget.swift",
      "line": 158,
      "type": "removal",
      "comment": "update color",
      "firefox_code": [
        "        .widgetBackground(Color(UIColor(red: 0.11, green: 0.11, blue: 0.13, alpha: 1.00)))"
      ],
      "ecosia_code": [],
      "context_before": [
        "        }",
        "        .frame(maxWidth: .infinity, maxHeight: .infinity)"
      ],
      "context_after": [
        "        .background((Color.ecosiaBundledColorWithName(\"PrimaryBackground\")))",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/WidgetKit/QuickLink.swift",
      "line": 20,
      "type": "substitution",
      "comment": "update image",
      "firefox_code": [
        "return \"faviconFox\""
      ],
      "ecosia_code": [
        "            return \"openEcosia\"",
        "        case .privateSearch:",
        "            /* Ecosia: update image",
        "            return StandardImageIdentifiers.Large.privateMode",
        "            */",
        "            return \"ecosiaSmallPrivateMask\"",
        "        case .copiedLink:",
        "            return StandardImageIdentifiers.Large.tabTray",
        "        case .closePrivateTabs:",
        "            /* Ecosia: update image",
        "            StandardImageIdentifiers.Large.delete",
        "            */",
        "            return \"ecosiaDelete\""
      ],
      "context_before": [
        "        switch self {",
        "        case .search:"
      ],
      "context_after": [
        "        }",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/WidgetKit/QuickLink.swift",
      "line": 24,
      "type": "removal",
      "comment": "update image",
      "firefox_code": [
        "            return StandardImageIdentifiers.Large.privateMode"
      ],
      "ecosia_code": [],
      "context_before": [
        "            return \"openEcosia\"",
        "        case .privateSearch:"
      ],
      "context_after": [
        "            return \"ecosiaSmallPrivateMask\"",
        "        case .copiedLink:"
      ]
    },
    {
      "file": "firefox-ios/WidgetKit/QuickLink.swift",
      "line": 31,
      "type": "removal",
      "comment": "update image",
      "firefox_code": [
        "            StandardImageIdentifiers.Large.delete"
      ],
      "ecosia_code": [],
      "context_before": [
        "            return StandardImageIdentifiers.Large.tabTray",
        "        case .closePrivateTabs:"
      ],
      "context_after": [
        "            return \"ecosiaDelete\"",
        "        }"
      ]
    },
    {
      "file": "firefox-ios/WidgetKit/QuickLink.swift",
      "line": 77,
      "type": "removal",
      "comment": "Update colors",
      "firefox_code": [
        "    public var backgroundColors: [Color] {",
        "        switch self {",
        "        case .search:",
        "            return [Color(\"searchButtonColorTwo\"), Color(\"searchButtonColorOne\")]",
        "        case .privateSearch:",
        "            return [Color(\"privateGradientThree\"), Color(\"privateGradientTwo\"), Color(\"privateGradientOne\")]",
        "        case .copiedLink:",
        "            return [Color(\"goToCopiedLinkSolid\")]",
        "        case .closePrivateTabs:",
        "            return [Color(\"privateGradientThree\"), Color(\"privateGradientTwo\"), Color(\"privateGradientOne\")]",
        "        }",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "",
        "    public var backgroundColors: [Color] {"
      ]
    },
    {
      "file": "firefox-ios/WidgetKit/QuickLink.swift",
      "line": 93,
      "type": "removal",
      "comment": "Update colors",
      "firefox_code": [
        "        switch self {",
        "        case .search:",
        "            return [Color(\"PrimaryBrand\")]",
        "        case .privateSearch:",
        "            return [Color(\"TertiaryBackground\")]",
        "        case .copiedLink:",
        "            return [Color(\"TertiaryBackground\")]",
        "        case .closePrivateTabs:",
        "            return [Color(\"TertiaryBackground\")]",
        "        }"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    public var backgroundColors: [Color] {"
      ],
      "context_after": [
        "        return [.ecosiaBundledColorWithName(\"TertiaryBackground\")]",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/WidgetKit/QuickLink.swift",
      "line": 109,
      "type": "removal",
      "comment": "Update colors",
      "firefox_code": [
        "        switch self {",
        "        case .search:",
        "            return .init(\"PrimaryBackground\")",
        "        default:",
        "            return .init(\"PrimaryText\")",
        "        }"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    public var textColor: Color {"
      ],
      "context_after": [
        "        return .ecosiaBundledColorWithName(\"PrimaryText\")",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/WidgetKit/QuickLink.swift",
      "line": 121,
      "type": "removal",
      "comment": "Update colors",
      "firefox_code": [
        "        switch self {",
        "        case .search:",
        "            return .init(\"PrimaryBackground\")",
        "        default:",
        "            return .init(\"SecondaryIcon\")",
        "        }"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    public var iconColor: Color {"
      ],
      "context_after": [
        "        return .ecosiaBundledColorWithName(\"PrimaryText\")",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/WidgetKit/SearchQuickLinksMedium/SearchQuickLinks.swift",
      "line": 45,
      "type": "removal",
      "comment": "Update color",
      "firefox_code": [
        "        .widgetBackground(Color(\"backgroundColor\"))"
      ],
      "ecosia_code": [],
      "context_before": [
        "        }",
        "        .padding(10.0)"
      ],
      "context_after": [
        "        .widgetBackground(Color.ecosiaBundledColorWithName(\"PrimaryBackground\"))",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/WidgetKit/TopSites/TopSitesWidget.swift",
      "line": 8,
      "type": "addition",
      "comment": "Additional imports for Ecosia framework and suggested sites updates",
      "firefox_code": [],
      "ecosia_code": [
        "import Ecosia",
        "import Storage"
      ],
      "context_before": [
        "import WidgetKit",
        "import Combine"
      ],
      "context_after": [
        "",
        "struct TopSitesWidget: Widget {"
      ]
    },
    {
      "file": "firefox-ios/WidgetKit/TopSites/TopSitesWidget.swift",
      "line": 53,
      "type": "removal",
      "comment": "Update rectangle",
      "firefox_code": [
        "                            Rectangle()"
      ],
      "ecosia_code": [],
      "context_before": [
        "                                .frame(height: rowSize)",
        "                        } else {"
      ],
      "context_after": [
        "                            RoundedRectangle(cornerRadius: UX.itemCornerRadius)",
        "                                /* Ecosia: Update color"
      ]
    },
    {
      "file": "firefox-ios/WidgetKit/TopSites/TopSitesWidget.swift",
      "line": 74,
      "type": "removal",
      "comment": "Update color",
      "firefox_code": [
        "        .widgetBackground(UX.widgetBackgroundColor)"
      ],
      "ecosia_code": [],
      "context_before": [
        "        }",
        "        .frame(maxWidth: .infinity, maxHeight: .infinity)"
      ],
      "context_after": [
        "        .widgetBackground(Color.ecosiaBundledColorWithName(\"PrimaryBackground\"))",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/BrowserCoordinatorTests.swift",
      "line": 103,
      "type": "removal",
      "comment": "Update HomepageViewController's init",
      "firefox_code": [
        "        let secondHomepage = LegacyHomepageViewController(",
        "            profile: profile,",
        "            toastContainer: UIView(),",
        "            tabManager: tabManager,",
        "            overlayManager: overlayModeManager",
        "        )"
      ],
      "ecosia_code": [],
      "context_before": [
        "        )",
        ""
      ],
      "context_after": [
        "        let secondHomepage = LegacyHomepageViewController(profile: profile,",
        "                                                          toastContainer: UIView(),"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/BrowserCoordinatorTests.swift",
      "line": 795,
      "type": "removal",
      "comment": "Disable Onboarding dependant tests since LaunchCoordinator.presentIntroOnboarding is temporarily disabled",
      "firefox_code": [
        "    func testHandleShowOnboarding_returnsTrueAndShowsOnboarding() {",
        "        let subject = createSubject()",
        "        subject.browserHasLoaded()",
        "        let result = testCanHandleAndHandle(subject, route: .action(action: .showIntroOnboarding))",
        "        XCTAssertTrue(result)",
        "        XCTAssertEqual(subject.childCoordinators.count, 1)",
        "        XCTAssertNotNil(subject.childCoordinators[0] as? LaunchCoordinator)",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "",
        "    // MARK: - Saved route"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/Launch/LaunchCoordinatorTests.swift",
      "line": 41,
      "type": "removal",
      "comment": "Disable Onboarding dependant tests since LaunchCoordinator.presentIntroOnboarding is temporarily disabled",
      "firefox_code": [
        "    func testStart_introNotIphone_present() throws {",
        "        let introScreenManager = IntroScreenManager(prefs: profile.prefs)",
        "        let subject = createSubject(isIphone: false)",
        "        subject.start(with: .intro(manager: introScreenManager))",
        "        XCTAssertEqual(mockRouter.presentCalled, 1)",
        "        XCTAssertEqual(mockRouter.setRootViewControllerCalled, 0)",
        "        let presentedViewController = try XCTUnwrap(mockRouter.presentedViewController)",
        "        // Ecosia: Update view controller being presented",
        "        // XCTAssertNotNil(presentedViewController as? IntroViewController)",
        "        XCTAssertNotNil(presentedViewController as? WelcomeNavigation)",
        "    }",
        "    func testStart_introIsIphone_setRootView() throws {",
        "        let introScreenManager = IntroScreenManager(prefs: profile.prefs)",
        "        let subject = createSubject(isIphone: true)",
        "        subject.start(with: .intro(manager: introScreenManager))",
        "        XCTAssertEqual(mockRouter.presentCalled, 1)",
        "        XCTAssertEqual(mockRouter.setRootViewControllerCalled, 0)",
        "        let pushedVC = try XCTUnwrap(mockRouter.presentedViewController)",
        "        // Ecosia: Update view controller being presented",
        "        // XCTAssertNotNil(pushedVC as? IntroViewController)",
        "        XCTAssertNotNil(pushedVC as? WelcomeNavigation)",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    // MARK: - Intro"
      ],
      "context_after": [
        "",
        "    // MARK: - Update"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/Launch/LaunchCoordinatorTests.swift",
      "line": 121,
      "type": "removal",
      "comment": "Remove MockGleanPlumbMessageManagerProtocol ref",
      "firefox_code": [
        "    func testStart_surveyWithMessage_setRootView() throws {",
        "        let messageManager = MockGleanPlumbMessageManagerProtocol()",
        "        let message = createMessage(isExpired: false)",
        "        messageManager.message = message",
        "        let manager = SurveySurfaceManager(windowUUID: windowUUID, and: messageManager)",
        "        XCTAssertTrue(manager.shouldShowSurveySurface)",
        "        let subject = createSubject(isIphone: false)",
        "        subject.start(with: .survey(manager: manager))",
        "        XCTAssertEqual(mockRouter.presentCalled, 1)",
        "        XCTAssertEqual(mockRouter.setRootViewControllerCalled, 0)",
        "        let pushedVC = try XCTUnwrap(mockRouter.presentedViewController)",
        "        XCTAssertNotNil(pushedVC as? SurveySurfaceViewController)",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "        XCTAssertNil(mockRouter.presentedViewController)",
        "    }"
      ],
      "context_after": [
        "",
        "    // MARK: - QRCodeNavigationHandler"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/Launch/LaunchCoordinatorTests.swift",
      "line": 162,
      "type": "removal",
      "comment": "Remove MockGleanPlumbMessageManagerProtocol ref",
      "firefox_code": [
        "    func testStart_surveySetsDelegate() throws {",
        "        let messageManager = MockGleanPlumbMessageManagerProtocol()",
        "        let message = createMessage(isExpired: false)",
        "        messageManager.message = message",
        "        let manager = SurveySurfaceManager(windowUUID: windowUUID, and: messageManager)",
        "        XCTAssertTrue(manager.shouldShowSurveySurface)",
        "        let subject = createSubject(isIphone: false)",
        "        subject.start(with: .survey(manager: manager))",
        "        let presentedVC = try XCTUnwrap(mockRouter.presentedViewController as? SurveySurfaceViewController)",
        "        XCTAssertNotNil(presentedVC.delegate)",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    // MARK: - Delegates"
      ],
      "context_after": [
        "",
        "    func testDidFinish_fromSurveySurfaceViewControllerDelegate() {"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/Launch/LaunchCoordinatorTests.swift",
      "line": 201,
      "type": "removal",
      "comment": "Remove MockGleanPlumbMessageManagerProtocol ref",
      "firefox_code": [
        "    private func createMessage(",
        "        for surface: MessageSurfaceId = .survey,",
        "        isExpired: Bool",
        "    ) -> GleanPlumbMessage {",
        "        let metadata = GleanPlumbMessageMetaData(id: \"\",",
        "                                                 impressions: 0,",
        "                                                 dismissals: 0,",
        "                                                 isExpired: isExpired)",
        "        return GleanPlumbMessage(id: \"12345\",",
        "                                 data: MockSurveyMessageDataProtocol(surface: surface),",
        "                                 action: \"https://mozilla.com\",",
        "                                 triggerIfAll: [],",
        "                                 exceptIfAny: [],",
        "                                 style: MockStyleDataProtocol(),",
        "                                 metadata: metadata)",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "}"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/LaunchView/LaunchScreenViewModelTests.swift",
      "line": 11,
      "type": "substitution",
      "comment": "Remove MockGleanPlumbMessageManagerProtocol ref",
      "firefox_code": [
        "private var messageManager: MockGleanPlumbMessageManagerProtocol!"
      ],
      "ecosia_code": [
        "    private var profile: MockProfile!",
        "    private var delegate: MockLaunchFinishedLoadingDelegate!",
        "    let windowUUID: WindowUUID = .XCTestDefaultUUID"
      ],
      "context_before": [
        "",
        "final class LaunchScreenViewModelTests: XCTestCase {"
      ],
      "context_after": [
        "",
        "    override func setUp() {"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/LaunchView/LaunchScreenViewModelTests.swift",
      "line": 23,
      "type": "substitution",
      "comment": "Remove MockGleanPlumbMessageManagerProtocol ref",
      "firefox_code": [
        "messageManager = MockGleanPlumbMessageManagerProtocol()"
      ],
      "ecosia_code": [],
      "context_before": [
        "        delegate = MockLaunchFinishedLoadingDelegate()",
        "        LegacyFeatureFlagsManager.shared.initializeDeveloperFeatures(with: profile)"
      ],
      "context_after": [
        "",
        "        UserDefaults.standard.set(true, forKey: PrefsKeys.NimbusFeatureTestsOverride)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/LaunchView/LaunchScreenViewModelTests.swift",
      "line": 33,
      "type": "substitution",
      "comment": "Remove MockGleanPlumbMessageManagerProtocol ref",
      "firefox_code": [
        "messageManager = nil"
      ],
      "ecosia_code": [
        "        delegate = nil"
      ],
      "context_before": [
        "        AppContainer.shared.reset()",
        "        profile = nil"
      ],
      "context_after": [
        "",
        "        UserDefaults.standard.set(false, forKey: PrefsKeys.NimbusFeatureTestsOverride)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/LaunchView/LaunchScreenViewModelTests.swift",
      "line": 47,
      "type": "removal",
      "comment": "Versioning is testes in a dedicated Ecosia test",
      "firefox_code": [
        "    func testLaunchType_intro() async {",
        "        let subject = createSubject()",
        "        subject.delegate = delegate",
        "        await subject.startLoading(appVersion: \"112.0\")",
        "        guard case .intro = delegate.savedLaunchType else {",
        "            XCTFail(\"Expected intro, but was \\(String(describing: delegate.savedLaunchType))\")",
        "            return",
        "        }",
        "        XCTAssertEqual(delegate.launchBrowserCalled, 0)",
        "        XCTAssertEqual(delegate.launchWithTypeCalled, 1)",
        "    }",
        "    func testLaunchType_update() async {",
        "        profile.prefs.setString(\"112.0\", forKey: PrefsKeys.AppVersion.Latest)",
        "        profile.prefs.setInt(1, forKey: PrefsKeys.IntroSeen)",
        "        let subject = createSubject()",
        "        subject.delegate = delegate",
        "        await subject.startLoading(appVersion: \"113.0\")",
        "        guard case .update = delegate.savedLaunchType else {",
        "            XCTFail(\"Expected update, but was \\(String(describing: delegate.savedLaunchType))\")",
        "            return",
        "        }",
        "        XCTAssertEqual(delegate.launchBrowserCalled, 0)",
        "        XCTAssertEqual(delegate.launchWithTypeCalled, 1)",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "        XCTAssertEqual(delegate.launchWithTypeCalled, 0)",
        "    }"
      ],
      "context_after": [
        "",
        "    /* Ecosia: Comment test with no mean to Launch survey"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/LaunchView/LaunchScreenViewModelTests.swift",
      "line": 78,
      "type": "removal",
      "comment": "Comment test with no mean to Launch survey",
      "firefox_code": [
        "    func testLaunchType_survey() async {",
        "        profile.prefs.setString(\"112.0\", forKey: PrefsKeys.AppVersion.Latest)",
        "        profile.prefs.setInt(1, forKey: PrefsKeys.IntroSeen)",
        "        let message = createMessage()",
        "        messageManager.message = message",
        "        let subject = createSubject()",
        "        subject.delegate = delegate",
        "        await subject.startLoading(appVersion: \"112.0\")",
        "        guard case .survey = delegate.savedLaunchType else {",
        "            XCTFail(\"Expected survey, but was \\(String(describing: delegate.savedLaunchType))\")",
        "            return",
        "        }",
        "        XCTAssertEqual(delegate.launchBrowserCalled, 0)",
        "        XCTAssertEqual(delegate.launchWithTypeCalled, 1)",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "     */",
        ""
      ],
      "context_after": [
        "",
        "    /* Ecosia: Versioning is testes in a dedicated Ecosia test"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/LaunchView/LaunchScreenViewModelTests.swift",
      "line": 98,
      "type": "removal",
      "comment": "Versioning is testes in a dedicated Ecosia test",
      "firefox_code": [
        "    func testSplashScreenExperiment_afterShown_returnsTrue() {",
        "        let subject = createSubject()",
        "        let value = subject.getSplashScreenExperimentHasShown()",
        "        XCTAssertFalse(value)",
        "        subject.setSplashScreenExperimentHasShown()",
        "        let updatedValue = subject.getSplashScreenExperimentHasShown()",
        "        XCTAssertTrue(updatedValue)",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "     */",
        ""
      ],
      "context_after": [
        "",
        "    // MARK: - Helpers"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/LaunchView/LaunchScreenViewModelTests.swift",
      "line": 119,
      "type": "substitution",
      "comment": "Remove MockGleanPlumbMessageManagerProtocol ref",
      "firefox_code": [
        "messageManager: messageManager,"
      ],
      "ecosia_code": [
        "                                            onboardingModel: onboardingModel)",
        "        trackForMemoryLeaks(subject, file: file, line: line)",
        "        return subject"
      ],
      "context_before": [
        "        let subject = LaunchScreenViewModel(windowUUID: windowUUID,",
        "                                            profile: profile,"
      ],
      "context_after": [
        "    }",
        "    /* Ecosia: Remove MockGleanPlumbMessageManagerProtocol ref"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/LaunchView/LaunchScreenViewModelTests.swift",
      "line": 125,
      "type": "removal",
      "comment": "Remove MockGleanPlumbMessageManagerProtocol ref",
      "firefox_code": [
        "    private func createMessage(",
        "        for surface: MessageSurfaceId = .survey,",
        "        action: String = \"OPEN_NEW_TAB\"",
        "    ) -> GleanPlumbMessage {",
        "        let metadata = GleanPlumbMessageMetaData(id: \"\",",
        "                                                 impressions: 0,",
        "                                                 dismissals: 0,",
        "                                                 isExpired: false)",
        "        return GleanPlumbMessage(id: \"test-notification\",",
        "                                 data: MockNotificationMessageDataProtocol(surface: surface),",
        "                                 action: action,",
        "                                 triggerIfAll: [],",
        "                                 exceptIfAny: [],",
        "                                 style: MockStyleDataProtocol(),",
        "                                 metadata: metadata)",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "        return subject",
        "    }"
      ],
      "context_after": [
        "",
        "    func createOnboardingViewModel() -> OnboardingViewModel {"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/RouteTests.swift",
      "line": 28,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let url = URL(string: \"firefox://open-url?private=true\")!"
      ],
      "ecosia_code": [
        "        let url = URL(string: \"ecosia://open-url?url=http%3A%2F%2Fgoogle.com%3Fa%3D1%26b%3D2%26c%3Dfoo%2520bar\")!"
      ],
      "context_before": [
        "        let subject = createSubject()",
        ""
      ],
      "context_after": [
        "",
        "        let route = subject.makeRoute(url: url)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/RouteTests.swift",
      "line": 39,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let url = URL(string: \"firefox://open-url?private=true\")!"
      ],
      "ecosia_code": [
        "        let url = URL(string: \"ecosia://open-url?private=true\")!"
      ],
      "context_before": [
        "    func testSearchRouteWithPrivateFlag() {",
        "        let subject = createSubject()"
      ],
      "context_after": [
        "",
        "        let route = subject.makeRoute(url: url)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/RouteTests.swift",
      "line": 50,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let url = URL(string: \"firefox://open-url?private=true\")!"
      ],
      "ecosia_code": [
        "        let url = URL(string: \"ecosia://deep-link?url=/settings/clear-private-data\")!"
      ],
      "context_before": [
        "    func testSettingsRouteWithClearPrivateData() {",
        "        let subject = createSubject()"
      ],
      "context_after": [
        "",
        "        let route = subject.makeRoute(url: url)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/RouteTests.swift",
      "line": 61,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let url = URL(string: \"firefox://open-url?private=true\")!"
      ],
      "ecosia_code": [
        "        let url = URL(string: \"ecosia://deep-link?url=/settings/newTab\")!"
      ],
      "context_before": [
        "    func testSettingsRouteWithNewTab() {",
        "        let subject = createSubject()"
      ],
      "context_after": [
        "",
        "        let route = subject.makeRoute(url: url)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/RouteTests.swift",
      "line": 72,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let url = URL(string: \"firefox://open-url?private=true\")!"
      ],
      "ecosia_code": [
        "        let url = URL(string: \"ecosia://deep-link?url=/settings/newTab/\")!"
      ],
      "context_before": [
        "    func testSettingsRouteWithNewTabTrailingSlash() {",
        "        let subject = createSubject()"
      ],
      "context_after": [
        "",
        "        let route = subject.makeRoute(url: url)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/RouteTests.swift",
      "line": 83,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let url = URL(string: \"firefox://open-url?private=true\")!"
      ],
      "ecosia_code": [
        "        let url = URL(string: \"ecosia://deep-link?url=/settings/homePage\")!"
      ],
      "context_before": [
        "    func testSettingsRouteWithHomePage() {",
        "        let subject = createSubject()"
      ],
      "context_after": [
        "",
        "        let route = subject.makeRoute(url: url)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/RouteTests.swift",
      "line": 94,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let url = URL(string: \"firefox://open-url?private=true\")!"
      ],
      "ecosia_code": [
        "        let url = URL(string: \"ecosia://deep-link?url=/settings/mailto\")!"
      ],
      "context_before": [
        "    func testSettingsRouteWithMailto() {",
        "        let subject = createSubject()"
      ],
      "context_after": [
        "",
        "        let route = subject.makeRoute(url: url)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/RouteTests.swift",
      "line": 105,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let url = URL(string: \"firefox://open-url?private=true\")!"
      ],
      "ecosia_code": [
        "        let url = URL(string: \"ecosia://deep-link?url=/settings/search\")!"
      ],
      "context_before": [
        "    func testSettingsRouteWithSearch() {",
        "        let subject = createSubject()"
      ],
      "context_after": [
        "",
        "        let route = subject.makeRoute(url: url)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/RouteTests.swift",
      "line": 116,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let url = URL(string: \"firefox://open-url?private=true\")!"
      ],
      "ecosia_code": [
        "        let url = URL(string: \"ecosia://deep-link?url=/settings/fxa\")!"
      ],
      "context_before": [
        "    func testSettingsRouteWithFxa() {",
        "        let subject = createSubject()"
      ],
      "context_after": [
        "",
        "        let route = subject.makeRoute(url: url)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/RouteTests.swift",
      "line": 127,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let url = URL(string: \"firefox://open-url?private=true\")!"
      ],
      "ecosia_code": [
        "        let url = URL(string: \"ecosia://deep-link?url=/homepanel/bookmarks\")!"
      ],
      "context_before": [
        "    func testHomepanelRouteWithBookmarks() {",
        "        let subject = createSubject()"
      ],
      "context_after": [
        "",
        "        let route = subject.makeRoute(url: url)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/RouteTests.swift",
      "line": 138,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let url = URL(string: \"firefox://open-url?private=true\")!"
      ],
      "ecosia_code": [
        "        let url = URL(string: \"ecosia://deep-link?url=/homepanel/top-sites\")!"
      ],
      "context_before": [
        "    func testHomepanelRouteWithTopSites() {",
        "        let subject = createSubject()"
      ],
      "context_after": [
        "",
        "        let route = subject.makeRoute(url: url)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/RouteTests.swift",
      "line": 149,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let url = URL(string: \"firefox://open-url?private=true\")!"
      ],
      "ecosia_code": [
        "        let url = URL(string: \"ecosia://deep-link?url=/homepanel/history\")!"
      ],
      "context_before": [
        "    func testHomepanelRouteWithHistory() {",
        "        let subject = createSubject()"
      ],
      "context_after": [
        "",
        "        let route = subject.makeRoute(url: url)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/RouteTests.swift",
      "line": 160,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let url = URL(string: \"firefox://open-url?private=true\")!"
      ],
      "ecosia_code": [
        "        let url = URL(string: \"ecosia://deep-link?url=/homepanel/reading-list\")!"
      ],
      "context_before": [
        "    func testHomepanelRouteWithReadingList() {",
        "        let subject = createSubject()"
      ],
      "context_after": [
        "",
        "        let route = subject.makeRoute(url: url)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/RouteTests.swift",
      "line": 171,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let url = URL(string: \"firefox://open-url?private=true\")!"
      ],
      "ecosia_code": [
        "        let url = URL(string: \"ecosia://deep-link?url=/default-browser/tutorial\")!"
      ],
      "context_before": [
        "    func testDefaultBrowserRouteWithTutorial() {",
        "        let subject = createSubject()"
      ],
      "context_after": [
        "",
        "        let route = subject.makeRoute(url: url)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/RouteTests.swift",
      "line": 182,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let url = URL(string: \"firefox://open-url?private=true\")!"
      ],
      "ecosia_code": [
        "        let url = URL(string: \"ecosia://deep-link?url=/default-browser/system-settings\")!"
      ],
      "context_before": [
        "    func testDefaultBrowserRouteWithSystemSettings() {",
        "        let subject = createSubject()"
      ],
      "context_after": [
        "",
        "        let route = subject.makeRoute(url: url)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/RouteTests.swift",
      "line": 193,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let url = URL(string: \"firefox://open-url?private=true\")!"
      ],
      "ecosia_code": [
        "        let url = URL(string: \"ecosia://deep-link?url=/homepanel/badbad\")!"
      ],
      "context_before": [
        "    func testInvalidRouteWithBadPath() {",
        "        let subject = createSubject()"
      ],
      "context_after": [
        "",
        "        let route = subject.makeRoute(url: url)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/RouteTests.swift",
      "line": 204,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let url = URL(string: \"firefox://open-url?private=true\")!"
      ],
      "ecosia_code": [
        "        let url = URL(string: \"ecosia://fxa-signin?signin=coolcodes&user=foo&email=bar\")!"
      ],
      "context_before": [
        "    func testFxaSignInrouteBuilderRoute() {",
        "        let subject = createSubject()"
      ],
      "context_after": [
        "",
        "        let route = subject.makeRoute(url: url)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/RouteTests.swift",
      "line": 253,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let url = URL(string: \"firefox://open-url?private=true\")!"
      ],
      "ecosia_code": [
        "        let url = URL(string: \"ecosia://deep-links-are-fun?url=/settings/newTab/\")!"
      ],
      "context_before": [
        "    func testInvalidDeepLink() {",
        "        let subject = createSubject()"
      ],
      "context_after": [
        "",
        "        let route = subject.makeRoute(url: url)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/RouteTests.swift",
      "line": 264,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let url = URL(string: \"firefox://open-url?private=true\")!"
      ],
      "ecosia_code": [
        "        let url = URL(string: \"ecosia://widget-medium-topsites-open-url?url=https://google.com\")!"
      ],
      "context_before": [
        "    func testWidgetMediumTopSitesOpenUrl() {",
        "        let subject = createSubject()"
      ],
      "context_after": [
        "",
        "        let route = subject.makeRoute(url: url)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/RouteTests.swift",
      "line": 275,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let url = URL(string: \"firefox://open-url?private=true\")!"
      ],
      "ecosia_code": [
        "        let url = URL(string: \"ecosia://widget-small-quicklink-open-url?private=true&url=https://google.com\")!"
      ],
      "context_before": [
        "    func testWidgetSmallQuicklinkOpenUrlWithPrivateFlag() {",
        "        let subject = createSubject()"
      ],
      "context_after": [
        "",
        "        let route = subject.makeRoute(url: url)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/RouteTests.swift",
      "line": 289,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let url = URL(string: \"firefox://open-url?private=true\")!"
      ],
      "ecosia_code": [
        "        let url = URL(string: \"ecosia://widget-medium-quicklink-open-url?url=https://google.com\")!"
      ],
      "context_before": [
        "    func testWidgetMediumQuicklinkOpenUrlWithoutPrivateFlag() {",
        "        let subject = createSubject()"
      ],
      "context_after": [
        "",
        "        let route = subject.makeRoute(url: url)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/RouteTests.swift",
      "line": 304,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let url = URL(string: \"firefox://open-url?private=true\")!"
      ],
      "ecosia_code": [
        "        let url = URL(string: \"ecosia://widget-small-quicklink-open-copied\")!"
      ],
      "context_before": [
        "        let subject = createSubject()",
        "        UIPasteboard.general.string = \"test search text\""
      ],
      "context_after": [
        "",
        "        let route = subject.makeRoute(url: url)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/RouteTests.swift",
      "line": 316,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let url = URL(string: \"firefox://open-url?private=true\")!"
      ],
      "ecosia_code": [
        "        let url = URL(string: \"ecosia://widget-small-quicklink-open-copied\")!"
      ],
      "context_before": [
        "        let subject = createSubject()",
        "        UIPasteboard.general.url = URL(string: \"https://google.com\")"
      ],
      "context_after": [
        "",
        "        let route = subject.makeRoute(url: url)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/RouteTests.swift",
      "line": 327,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let url = URL(string: \"firefox://open-url?private=true\")!"
      ],
      "ecosia_code": [
        "        let url = URL(string: \"ecosia://widget-small-quicklink-close-private-tabs\")!"
      ],
      "context_before": [
        "    func testWidgetSmallQuicklinkClosePrivateTabs() {",
        "        let subject = createSubject()"
      ],
      "context_after": [
        "",
        "        let route = subject.makeRoute(url: url)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/RouteTests.swift",
      "line": 338,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let url = URL(string: \"firefox://open-url?private=true\")!"
      ],
      "ecosia_code": [
        "        let url = URL(string: \"ecosia://widget-medium-quicklink-close-private-tabs\")!"
      ],
      "context_before": [
        "    func testWidgetMediumQuicklinkClosePrivateTabs() {",
        "        let subject = createSubject()"
      ],
      "context_after": [
        "",
        "        let route = subject.makeRoute(url: url)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/RouteTests.swift",
      "line": 376,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let url = URL(string: \"firefox://open-url?private=true\")!"
      ],
      "ecosia_code": [
        "        let url = URL(string: \"ecosia://widget-tabs-medium-open-url?uuid=invalid\")!"
      ],
      "context_before": [
        "    func testInvalidWidgetTabUuid() {",
        "        let subject = createSubject()"
      ],
      "context_after": [
        "",
        "        let route = subject.makeRoute(url: url)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/RouteTests.swift",
      "line": 396,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let url = URL(string: \"firefox://open-url?private=true\")!"
      ],
      "ecosia_code": [
        "        let url = URL(string: \"ecosia://open-text?text=google\")!"
      ],
      "context_before": [
        "    func testOpenText() {",
        "        let subject = createSubject()"
      ],
      "context_after": [
        "",
        "        let route = subject.makeRoute(url: url)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/RouteTests.swift",
      "line": 409,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let url = URL(string: \"firefox://open-url?private=true\")!"
      ],
      "ecosia_code": [
        "        let url = URL(string: \"ecosia://deep-link?url=/action/show-intro-onboarding\")!"
      ],
      "context_before": [
        "    func testAppAction_showIntroOnboarding() {",
        "        let subject = createSubject()"
      ],
      "context_after": [
        "",
        "        let route = subject.makeRoute(url: url)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/SceneCoordinatorTests.swift",
      "line": 52,
      "type": "removal",
      "comment": "Disable Onboarding dependant tests since LaunchCoordinator.presentIntroOnboarding is temporarily disabled",
      "firefox_code": [
        "    func testLaunchWithLaunchType_launchFromScene() {",
        "        let subject = createSubject()",
        "        subject.launchWith(launchType: .intro(manager: IntroScreenManager(prefs: MockProfile().prefs)))",
        "        XCTAssertEqual(subject.childCoordinators.count, 1)",
        "        XCTAssertNotNil(subject.childCoordinators[0] as? LaunchCoordinator)",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "",
        "    func testLaunchWithLaunchType_launchFromBrowser() {"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/SceneCoordinatorTests.swift",
      "line": 79,
      "type": "removal",
      "comment": "Disable Onboarding dependant tests since LaunchCoordinator.presentIntroOnboarding is temporarily disabled",
      "firefox_code": [
        "    func testChildLaunchCoordinatorIsDone_startsBrowser() throws {",
        "        let subject = createSubject()",
        "        subject.launchWith(launchType: .intro(manager: IntroScreenManager(prefs: MockProfile().prefs)))",
        "        let childLaunchCoordinator = try XCTUnwrap(subject.childCoordinators[0] as? LaunchCoordinator)",
        "        subject.didFinishLaunch(from: childLaunchCoordinator)",
        "        XCTAssertEqual(subject.childCoordinators.count, 1)",
        "        XCTAssertNotNil(subject.childCoordinators[0] as? BrowserCoordinator)",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "",
        "    func testHandleRoute_launchNotFinished_routeSaved() {"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/SceneCoordinatorTests.swift",
      "line": 130,
      "type": "removal",
      "comment": "flanky test, commenting in this version",
      "firefox_code": [
        "    func testHandleShowOnboarding_returnsTrueAndShowsOnboarding() {",
        "        let subject = createSubject()",
        "        let result = testCanHandleAndHandle(subject, route: .action(action: .showIntroOnboarding))",
        "        XCTAssertTrue(result)",
        "        XCTAssertEqual(subject.childCoordinators.count, 1)",
        "        XCTAssertNotNil(subject.childCoordinators[0] as? LaunchCoordinator)",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "    // MARK: - Handle route",
        ""
      ],
      "context_after": [
        "",
        "    // MARK: - Helpers"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/SettingsCoordinatorTests.swift",
      "line": 66,
      "type": "substitution",
      "comment": "Update tests",
      "firefox_code": [
        "XCTAssertTrue(mockRouter.pushedViewController is HomePageSettingViewController)"
      ],
      "ecosia_code": [
        "        XCTAssertTrue(mockRouter.pushedViewController is NTPCustomizationSettingsViewController)"
      ],
      "context_before": [
        "",
        "        XCTAssertEqual(mockRouter.pushCalled, 1)"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/SettingsCoordinatorTests.swift",
      "line": 329,
      "type": "substitution",
      "comment": "Update tests",
      "firefox_code": [
        "XCTAssertTrue(mockRouter.pushedViewController is HomePageSettingViewController)"
      ],
      "ecosia_code": [
        "        XCTAssertTrue(mockRouter.pushedViewController is NTPCustomizationSettingsViewController)"
      ],
      "context_before": [
        "",
        "        XCTAssertEqual(mockRouter.pushCalled, 1)"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/URLScannerTests.swift",
      "line": 55,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let urlString = \"firefox://open-url?url=https://example.com/path\""
      ],
      "ecosia_code": [
        "        let urlString = \"ecosia://open-url?url=https://example.com/path\"",
        "        let url = URL(string: urlString)!",
        "        let scanner = URLScanner(url: url)!",
        "        XCTAssertEqual(scanner.value(query: \"url\"), \"https://example.com/path\")",
        "        XCTAssertEqual(scanner.fullURLQueryItem(), \"https://example.com/path\")"
      ],
      "context_before": [
        "",
        "    func testSimpleFullURLQueryItem() {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/URLScannerTests.swift",
      "line": 65,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let urlString = \"firefox://open-url?arg1=abc&url=https://example.com/path?arg1=a\""
      ],
      "ecosia_code": [
        "        let urlString = \"ecosia://open-url?arg1=abc&url=https://example.com/path?arg1=a\"",
        "        let url = URL(string: urlString)!",
        "        let scanner = URLScanner(url: url)!",
        "        XCTAssertEqual(scanner.value(query: \"url\"), \"https://example.com/path?arg1=a\")",
        "        XCTAssertEqual(scanner.value(query: \"arg1\"), \"abc\")",
        "        XCTAssertEqual(scanner.fullURLQueryItem(), \"https://example.com/path?arg1=a\")"
      ],
      "context_before": [
        "",
        "    func testPrecedingNonURLParamBeforeURLQueryItem() {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/URLScannerTests.swift",
      "line": 76,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let urlString = \"firefox://open-url?url=https://example.com/path?arg1=a\""
      ],
      "ecosia_code": [
        "        let urlString = \"ecosia://open-url?url=https://example.com/path?arg1=a\"",
        "        let url = URL(string: urlString)!",
        "        let scanner = URLScanner(url: url)!",
        "        XCTAssertEqual(scanner.value(query: \"url\"), \"https://example.com/path?arg1=a\")",
        "        XCTAssertEqual(scanner.fullURLQueryItem(), \"https://example.com/path?arg1=a\")"
      ],
      "context_before": [
        "",
        "    func testSingleQueryFullURLQueryItem() {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/URLScannerTests.swift",
      "line": 86,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let urlString = \"firefox://open-url?url=https://example.com/path?arg1=a&arg2=b\""
      ],
      "ecosia_code": [
        "        let urlString = \"ecosia://open-url?url=https://example.com/path?arg1=a&arg2=b\"",
        "        let url = URL(string: urlString)!",
        "        let scanner = URLScanner(url: url)!"
      ],
      "context_before": [
        "",
        "    func testTwoQueryParams() {"
      ],
      "context_after": [
        "        // Currently we do _not_ expect URLComponents to include all parameters to the URL.",
        "        XCTAssertEqual(scanner.value(query: \"url\"), \"https://example.com/path?arg1=a\")"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/URLScannerTests.swift",
      "line": 99,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let urlString = \"firefox://open-url?url=https://example.com/path?arg1=a&arg2=b&arg3=c\""
      ],
      "ecosia_code": [
        "        let urlString = \"ecosia://open-url?url=https://example.com/path?arg1=a&arg2=b&arg3=c\"",
        "        let url = URL(string: urlString)!",
        "        let scanner = URLScanner(url: url)!",
        "        XCTAssertEqual(scanner.value(query: \"url\"), \"https://example.com/path?arg1=a\")",
        "        XCTAssertEqual(scanner.fullURLQueryItem(), \"https://example.com/path?arg1=a&arg2=b&arg3=c\")",
        "        XCTAssertEqual(scanner.fullURLQueryItem()?.asURL, URL(string: \"https://example.com/path?arg1=a&arg2=b&arg3=c\"))"
      ],
      "context_before": [
        "",
        "    func testMultipleQueryParams() {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/URLScannerTests.swift",
      "line": 110,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let urlString = \"firefox://open-url?url=https://example.com/path?arg1=a&anotherURL=https://test.com\""
      ],
      "ecosia_code": [
        "        let urlString = \"ecosia://open-url?url=https://example.com/path?arg1=a&anotherURL=https://test.com\"",
        "        let url = URL(string: urlString)!",
        "        let scanner = URLScanner(url: url)!",
        "        XCTAssertEqual(scanner.fullURLQueryItem(), \"https://example.com/path?arg1=a&anotherURL=https://test.com\")"
      ],
      "context_before": [
        "",
        "    func testMultipleLevelsOfNestedURLs() {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Coordinators/URLScannerTests.swift",
      "line": 128,
      "type": "substitution",
      "comment": "Update url",
      "firefox_code": [
        "let urlString = \"firefox://abcdefg/path/to/resource\""
      ],
      "ecosia_code": [
        "        let urlString = \"ecosia://abcdefg/path/to/resource\"",
        "        let url = URL(string: urlString)!",
        "        let scanner = URLScanner(url: url)",
        "        XCTAssertNotNil(scanner)",
        "        XCTAssertTrue(scanner!.isOurScheme)"
      ],
      "context_before": [
        "",
        "    func testOurScheme() {"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/DefaultSearchPrefsTests.swift",
      "line": 19,
      "type": "addition",
      "comment": "update values to include ecosia",
      "firefox_code": [],
      "ecosia_code": [
        "        let usa = (",
        "            lang: [\"en-US\", \"en\"],",
        "            region: \"US\",",
        "            resultList: [\"google-b-1-m\", \"bing\", \"ddg\", \"wikipedia\", \"ecosia\"],",
        "            resultDefault: \"ecosia\"",
        "        )",
        "        let england = (",
        "            lang: [\"en-GB\", \"en\"],",
        "            region: \"GB\",",
        "            resultList: [\"google-b-m\", \"bing\", \"ddg\", \"wikipedia\", \"ecosia\"],",
        "            resultDefault: \"ecosia\"",
        "        )",
        "        let france = (",
        "            lang: [\"fr-FR\", \"fr\"],",
        "            region: \"FR\",",
        "            resultList: [\"google-b-m\", \"bing\", \"ddg\", \"wikipedia-fr\", \"ecosia\"],",
        "            resultDefault: \"ecosia\"",
        "        )",
        "        let japan = (",
        "            lang: [\"ja-JP\", \"ja\"],",
        "            region: \"JP\",",
        "            resultList: [\"google-b-m\", \"bing\", \"wikipedia-ja\", \"ecosia\"],",
        "            resultDefault: \"ecosia\"",
        "        )",
        "        let canada = (",
        "            lang: [\"en-CA\", \"en\"],",
        "            region: \"CA\",",
        "            resultList: [\"ecosia\", \"wikipedia\", \"google-b-m\", \"bing\", \"ddg\"],",
        "            resultDefault: \"ecosia\"",
        "        )",
        "        let russia = (",
        "            lang: [\"ru-RU\", \"ru\"],",
        "            region: \"RU\",",
        "            resultList: [\"google-com-nocodes\", \"wikipedia-ru\", \"ecosia\"],",
        "            resultDefault: \"ecosia\"",
        "        )",
        "        let taiwan = (",
        "            lang: [\"zh-TW\", \"zh\"],",
        "            region: \"TW\",",
        "            resultList: [\"google-b-m\", \"bing\", \"ddg\", \"wikipedia-zh-TW\", \"ecosia\"],",
        "            resultDefault: \"ecosia\"",
        "        )",
        "        let china = (",
        "            lang: [\"zh-hans-CN\", \"zh-CN\", \"zh\"],",
        "            region: \"CN\",",
        "            resultList: [\"google-b-m\", \"bing\", \"wikipedia-zh-CN\", \"ecosia\"],",
        "            resultDefault: \"ç™¾åº¦\"",
        "        )",
        "        let germany = (",
        "            lang: [\"de-DE\", \"de\"],",
        "            region: \"DE\",",
        "            resultList: [\"google-b-m\", \"bing\", \"ddg\", \"ecosia\", \"wikipedia-de\"],",
        "            resultDefault: \"ecosia\"",
        "        )",
        "        let southAfrica = (",
        "            lang: [\"en-SA\", \"en\"],",
        "            region: \"SA\",",
        "            resultList: [\"ecosia\", \"wikipedia\", \"google-b-m\", \"bing\", \"ddg\"],",
        "            resultDefault: \"ecosia\"",
        "        )",
        "        let testLocales = [",
        "            usa,",
        "            england,",
        "            france,",
        "            japan,",
        "            canada,",
        "            russia,",
        "            taiwan,",
        "            china,",
        "            germany,",
        "            southAfrica",
        "        ]"
      ],
      "context_before": [
        "",
        "        // setup the most popular locales"
      ],
      "context_after": [
        "",
        "        // run tests"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/DependencyInjection/DependencyHelperMock.swift",
      "line": 15,
      "type": "addition",
      "comment": "Make themeManager injectable",
      "firefox_code": [],
      "ecosia_code": [
        "    ) {",
        "        AppContainer.shared.reset()"
      ],
      "context_before": [
        "        injectedTabManager: TabManager? = nil,",
        "        injectedMicrosurveyManager: MicrosurveyManager? = nil,"
      ],
      "context_after": [
        "",
        "        let profile: Client.Profile = BrowserProfile("
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/DependencyInjection/DependencyHelperMock.swift",
      "line": 39,
      "type": "substitution",
      "comment": "Remove themeManager constant",
      "firefox_code": [
        "let themeManager: ThemeManager = MockThemeManager()"
      ],
      "ecosia_code": [
        "        AppContainer.shared.register(service: themeManager)"
      ],
      "context_before": [
        "        let appSessionProvider: AppSessionProvider = AppSessionManager()",
        "        AppContainer.shared.register(service: appSessionProvider)"
      ],
      "context_after": [
        "",
        "        let ratingPromptManager = RatingPromptManager(profile: profile)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Frontend/Browser/SearchEngines/SearchTests.swift",
      "line": 12,
      "type": "removal",
      "comment": "Replace Google tests with Ecosia's",
      "firefox_code": [
        "    func testParsing() {",
        "        let parser = OpenSearchParser(pluginMode: true)",
        "        let file = Bundle.main.path(forResource: \"google-b-m\", ofType: \"xml\", inDirectory: \"SearchPlugins/\")",
        "        let engine: OpenSearchEngine! = parser.parse(file!, engineID: \"google-b-m\")",
        "        XCTAssertEqual(engine.shortName, \"Google\")",
        "        // Test regular search queries.",
        "        XCTAssertEqual(engine.searchURLForQuery(\"foobar\")!.absoluteString,",
        "                       \"https://www.google.com/search?q=foobar&ie=utf-8&oe=utf-8&client=firefox-b-m\")",
        "        // Test search suggestion queries.",
        "        XCTAssertEqual(engine.suggestURLForQuery(\"foobar\")!.absoluteString,",
        "                       \"https://www.google.com/complete/search?client=firefox&q=foobar\")",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "class SearchTests: XCTestCase {"
      ],
      "context_after": [
        "    func testParsing() {",
        "        let parser = OpenSearchParser(pluginMode: true)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Frontend/Browser/TopSitesHelperTests.swift",
      "line": 69,
      "type": "removal",
      "comment": "Update with removed default sites",
      "firefox_code": [
        "            XCTAssertEqual(sites.count, 5, \"Contains 5 default sites\")"
      ],
      "ecosia_code": [],
      "context_before": [
        "                return",
        "            }"
      ],
      "context_after": [
        "            XCTAssertEqual(sites.count, 0, \"Contains no default sites\")",
        "            expectation.fulfill()"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Frontend/Browser/TopSitesHelperTests.swift",
      "line": 88,
      "type": "removal",
      "comment": "Update with removed default sites",
      "firefox_code": [
        "            XCTAssertEqual(sites.count, 7, \"Contains 5 default sites and two pinned sites\")"
      ],
      "ecosia_code": [],
      "context_before": [
        "                return",
        "            }"
      ],
      "context_after": [
        "            XCTAssertEqual(sites.count, 2, \"Contains no default sites and two pinned sites\")",
        "            expectation.fulfill()"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Frontend/Browser/TopSitesHelperTests.swift",
      "line": 110,
      "type": "removal",
      "comment": "Update with removed default sites",
      "firefox_code": [
        "            XCTAssertEqual(sites.count, 7, \"Contains 5 default sites and 2 frecency sites\")"
      ],
      "ecosia_code": [],
      "context_before": [
        "                return",
        "            }"
      ],
      "context_after": [
        "            XCTAssertEqual(sites.count, 2, \"Contains no default sites and 2 frecency sites\")",
        "            expectation.fulfill()"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Frontend/Browser/TopSitesHelperTests.swift",
      "line": 131,
      "type": "removal",
      "comment": "Update with removed default sites",
      "firefox_code": [
        "            XCTAssertEqual(sites.count, 7, \"Contains 5 default sites and 2 frecency sites, no sponsored urls\")"
      ],
      "ecosia_code": [],
      "context_before": [
        "                return",
        "            }"
      ],
      "context_after": [
        "            XCTAssertEqual(sites.count, 2, \"Contains no default sites and 2 frecency sites, no sponsored urls\")",
        "            expectation.fulfill()"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Frontend/Browser/TopSitesHelperTests.swift",
      "line": 152,
      "type": "removal",
      "comment": "Update with removed default sites",
      "firefox_code": [
        "            XCTAssertEqual(sites.count, 7, \"Contains 5 default sites and 2 frecency sites, no frecency duplicates\")"
      ],
      "ecosia_code": [],
      "context_before": [
        "                return",
        "            }"
      ],
      "context_after": [
        "            XCTAssertEqual(sites.count, 2, \"Contains no default sites and 2 frecency sites, no frecency duplicates\")",
        "            expectation.fulfill()"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Frontend/Browser/TopSitesHelperTests.swift",
      "line": 172,
      "type": "removal",
      "comment": "Update with removed default sites",
      "firefox_code": [
        "            XCTAssertEqual(sites.count, 5, \"Contains only 5 default sites, no duplicates of defaults sites\")"
      ],
      "ecosia_code": [],
      "context_before": [
        "                return",
        "            }"
      ],
      "context_after": [
        "            XCTAssertEqual(sites.count, 1, \"Contains only no default sites, no duplicates of defaults sites\")",
        "            expectation.fulfill()"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Frontend/Browser/TopSitesHelperTests.swift",
      "line": 197,
      "type": "removal",
      "comment": "Update with removed default sites",
      "firefox_code": [
        "            XCTAssertEqual(sites.count, 5, \"Contains only 4 default sites, and \" + \"one pinned site that replaced the default site\")"
      ],
      "ecosia_code": [],
      "context_before": [
        "                return",
        "            }"
      ],
      "context_after": [
        "            XCTAssertEqual(sites.count, 1, \"Contains no default sites, and \"",
        "                           + \"one pinned site that replaced the default site\")"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Frontend/ContentContainerTests.swift",
      "line": 252,
      "type": "removal",
      "comment": "Update HomepageViewController init",
      "firefox_code": [
        "        return LegacyHomepageViewController(",
        "            profile: profile,",
        "            toastContainer: UIView(),",
        "            tabManager: MockTabManager(),",
        "            overlayManager: overlayModeManager",
        "        )"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "    private func createHomepage() -> LegacyHomepageViewController {"
      ],
      "context_after": [
        "        return LegacyHomepageViewController(",
        "            profile: profile,"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Frontend/Home/HomepageViewControllerTests.swift",
      "line": 32,
      "type": "removal",
      "comment": "update HomepageViewController's init",
      "firefox_code": [
        "        let firefoxHomeViewController = HomepageViewController(profile: profile,",
        "                                                               toastContainer: UIView(),",
        "                                                               tabManager: tabManager,",
        "                                                               overlayManager: overlayManager)"
      ],
      "ecosia_code": [],
      "context_before": [
        "        overlayManager.setURLBar(urlBarView: urlBar)",
        ""
      ],
      "context_after": [
        "        let firefoxHomeViewController = HomepageViewController(profile: profile,",
        "                                                               toastContainer: UIView(),"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Frontend/Home/LegacyHomepageViewControllerTests.swift",
      "line": 34,
      "type": "removal",
      "comment": "Update HomepageViewController's init",
      "firefox_code": [
        "         let firefoxHomeViewController = LegacyHomepageViewController(",
        "             profile: profile,",
        "             toastContainer: UIView(),",
        "             tabManager: tabManager,",
        "             overlayManager: overlayManager",
        "         )"
      ],
      "ecosia_code": [],
      "context_before": [
        "        overlayManager.setURLBar(urlBarView: urlBar)",
        ""
      ],
      "context_after": [
        "        let firefoxHomeViewController = LegacyHomepageViewController(",
        "            profile: profile,"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Frontend/Home/LegacyHomepageViewControllerTests.swift",
      "line": 63,
      "type": "removal",
      "comment": "Update HomepageViewController's init",
      "firefox_code": [
        "         let subject = LegacyHomepageViewController(",
        "             profile: profile,",
        "             toastContainer: UIView(),",
        "             tabManager: tabManager,",
        "             overlayManager: overlayManager",
        "         )"
      ],
      "ecosia_code": [],
      "context_before": [
        "        overlayManager.setURLBar(urlBarView: urlBar)",
        ""
      ],
      "context_after": [
        "        let subject = LegacyHomepageViewController(",
        "            profile: profile,"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Frontend/Home/Pocket/PocketViewModelTests.swift",
      "line": 6,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "import Glean"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "import Common"
      ],
      "context_after": [
        "import Shared",
        "import XCTest"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Frontend/Home/Pocket/PocketViewModelTests.swift",
      "line": 24,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        Glean.shared.resetGlean(clearStores: true)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "        featureFlags.initializeDeveloperFeatures(with: profile)"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Frontend/Home/Pocket/PocketViewModelTests.swift",
      "line": 50,
      "type": "removal",
      "comment": "remove Glean dependency",
      "firefox_code": [
        "    func testRecordSectionHasShown() throws {",
        "        adaptor.pocketStories = createStories(numberOfStories: 1)",
        "        let subject = createSubject()",
        "        subject.didLoadNewData()",
        "        let collectionView = UICollectionView(frame: .zero, collectionViewLayout: UICollectionViewLayout())",
        "        collectionView.register(cellType: LegacyPocketStandardCell.self)",
        "        _ = subject.configure(collectionView, at: IndexPath(item: 0, section: 0))",
        "        testCounterMetricRecordingSuccess(metric: GleanMetrics.Pocket.sectionImpressions,",
        "                                          value: 1)",
        "        // Calling configure again doesn't add another count",
        "        _ = subject.configure(collectionView, at: IndexPath(item: 0, section: 0))",
        "        testCounterMetricRecordingSuccess(metric: GleanMetrics.Pocket.sectionImpressions,",
        "                                          value: 1)",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "",
        "    // MARK: - Dimension"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Frontend/Home/Pocket/PocketViewModelTests.swift",
      "line": 109,
      "type": "removal",
      "comment": "remove Glean dependency",
      "firefox_code": [
        "    func testClickingStandardCell_recordsTapOnStory() {",
        "        adaptor.pocketStories = createStories(numberOfStories: 1)",
        "        let subject = createSubject()",
        "        subject.didLoadNewData()",
        "        subject.didSelectItem(at: IndexPath(item: 0, section: 0), homePanelDelegate: nil, libraryPanelDelegate: nil)",
        "        testLabeledMetricSuccess(metric: GleanMetrics.Pocket.openStoryOrigin)",
        "        testLabeledMetricSuccess(metric: GleanMetrics.Pocket.openStoryPosition)",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "",
        "    func testClickingStandardCell_callsTapTileAction() {"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Frontend/Home/Pocket/PocketViewModelTests.swift",
      "line": 161,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "    func testClickingDiscoverCell_recordsTapOnStory() {",
        "        adaptor.pocketStories = createStories(numberOfStories: 1)",
        "        let subject = createSubject()",
        "        subject.didLoadNewData()",
        "        subject.didSelectItem(at: IndexPath(item: 1, section: 0), homePanelDelegate: nil, libraryPanelDelegate: nil)",
        "        testLabeledMetricSuccess(metric: GleanMetrics.Pocket.openStoryOrigin)",
        "        testLabeledMetricSuccess(metric: GleanMetrics.Pocket.openStoryPosition)",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "",
        "    func testClickingDiscoverCell_callsTapTileAction() {"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Frontend/Home/TopSites/TopSitesDimensionTests.swift",
      "line": 40,
      "type": "substitution",
      "comment": "update number of items",
      "firefox_code": [
        "XCTAssertEqual(dimension.numberOfTilesPerRow, 8)"
      ],
      "ecosia_code": [
        "        XCTAssertEqual(dimension.numberOfTilesPerRow, 4)"
      ],
      "context_before": [
        "        let dimension = subject.getSectionDimension(for: createSites(), numberOfRows: 2, interface: interface)",
        "        XCTAssertEqual(dimension.numberOfRows, 2)"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Frontend/Home/TopSites/TopSitesDimensionTests.swift",
      "line": 55,
      "type": "substitution",
      "comment": "update number of items",
      "firefox_code": [
        "XCTAssertEqual(dimension.numberOfTilesPerRow, 7)"
      ],
      "ecosia_code": [
        "        XCTAssertEqual(dimension.numberOfTilesPerRow, 4)"
      ],
      "context_before": [
        "        let dimension = subject.getSectionDimension(for: createSites(), numberOfRows: 2, interface: interface)",
        "        XCTAssertEqual(dimension.numberOfRows, 2)"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Frontend/Home/TopSites/TopSitesDimensionTests.swift",
      "line": 70,
      "type": "substitution",
      "comment": "update number of items",
      "firefox_code": [
        "XCTAssertEqual(dimension.numberOfTilesPerRow, 10)"
      ],
      "ecosia_code": [
        "        XCTAssertEqual(dimension.numberOfTilesPerRow, 4)"
      ],
      "context_before": [
        "        let dimension = subject.getSectionDimension(for: createSites(), numberOfRows: 2, interface: interface)",
        "        XCTAssertEqual(dimension.numberOfRows, 2)"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Frontend/Home/TopSites/TopSitesDimensionTests.swift",
      "line": 111,
      "type": "substitution",
      "comment": "update number of items",
      "firefox_code": [
        "XCTAssertEqual(dimension.numberOfTilesPerRow, 7)"
      ],
      "ecosia_code": [
        "        XCTAssertEqual(dimension.numberOfTilesPerRow, 4)"
      ],
      "context_before": [
        "        let dimension = subject.getSectionDimension(for: createSites(), numberOfRows: 2, interface: interface)",
        "        XCTAssertEqual(dimension.numberOfRows, 2)"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Frontend/Home/TopSites/TopSitesDimensionTests.swift",
      "line": 126,
      "type": "substitution",
      "comment": "udpate number of items",
      "firefox_code": [
        "XCTAssertEqual(dimension.numberOfTilesPerRow, 11)"
      ],
      "ecosia_code": [
        "        XCTAssertEqual(dimension.numberOfTilesPerRow, 4)"
      ],
      "context_before": [
        "        let dimension = subject.getSectionDimension(for: createSites(), numberOfRows: 2, interface: interface)",
        "        XCTAssertEqual(dimension.numberOfRows, 2)"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Frontend/Home/TopSites/TopSitesViewModelTests.swift",
      "line": 28,
      "type": "removal",
      "comment": "Remove default sites dependant tests since DefaultSuggestedSites.defaultSites is empty",
      "firefox_code": [
        "    func testDeletionOfSingleSuggestedSite() {",
        "        let viewModel = TopSitesViewModel(profile: profile,",
        "                                          isZeroSearch: false,",
        "                                          theme: LightTheme(),",
        "                                          wallpaperManager: WallpaperManager())",
        "        let topSitesProvider = TopSitesProviderImplementation(placesFetcher: profile.places,",
        "                                                              pinnedSiteFetcher: profile.pinnedSites,",
        "                                                              prefs: profile.prefs)",
        "        let siteToDelete = topSitesProvider.defaultTopSites(profile.prefs)[0]",
        "        viewModel.hideURLFromTopSites(siteToDelete)",
        "        let newSites = topSitesProvider.defaultTopSites(profile.prefs)",
        "        XCTAssertFalse(newSites.contains(siteToDelete, f: { (first, second) -> Bool in",
        "            return first.url == second.url",
        "        }))",
        "    }",
        "    func testDeletionOfAllDefaultSites() {",
        "        let viewModel = TopSitesViewModel(profile: self.profile,",
        "                                          isZeroSearch: false,",
        "                                          theme: LightTheme(),",
        "                                          wallpaperManager: WallpaperManager())",
        "        let topSitesProvider = TopSitesProviderImplementation(placesFetcher: profile.places,",
        "                                                              pinnedSiteFetcher: profile.pinnedSites,",
        "                                                              prefs: profile.prefs)",
        "        let defaultSites = topSitesProvider.defaultTopSites(profile.prefs)",
        "        defaultSites.forEach({",
        "            viewModel.hideURLFromTopSites($0)",
        "        })",
        "        let newSites = topSitesProvider.defaultTopSites(profile.prefs)",
        "        XCTAssertTrue(newSites.isEmpty)",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "}",
        ""
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Helpers/IntroScreenManagerTests.swift",
      "line": 23,
      "type": "removal",
      "comment": "we are basing the onboarding/intro on different flags",
      "firefox_code": [
        "    func testHasntSeenIntroScreenYet_shouldShowIt() {",
        "        let subject = IntroScreenManager(prefs: prefs)",
        "        XCTAssertTrue(subject.shouldShowIntroScreen)",
        "    }",
        "    func testHasSeenIntroScreen_shouldNotShowIt() {",
        "        let subject = IntroScreenManager(prefs: prefs)",
        "        subject.didSeeIntroScreen()",
        "        XCTAssertFalse(subject.shouldShowIntroScreen)",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "}"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Library/Bookmarks/BookmarkPanelViewModelTests.swift",
      "line": 59,
      "type": "removal",
      "comment": "Temporarily remove that due to a bookmark inconsistency",
      "firefox_code": [
        "    func testShouldReload_whenMobileEmptyBookmarks() throws {",
        "        profile.reopen()",
        "        let subject = createSubject(guid: BookmarkRoots.MobileFolderGUID)",
        "        let expectation = expectation(description: \"Subject reloaded\")",
        "        subject.reloadData {",
        "            XCTAssertNotNil(subject.bookmarkFolder)",
        "            XCTAssertEqual(subject.bookmarkNodes.count, 1, \"Contains the local desktop folder\")",
        "            expectation.fulfill()",
        "        }",
        "        waitForExpectations(timeout: 5)",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "",
        "    func testShouldReload_whenLocalDesktopFolder() {"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/MainMenu/MainMenuMiddlewareTests.swift",
      "line": 5,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "import Glean"
      ],
      "ecosia_code": [],
      "context_before": [
        "// file, You can obtain one at http://mozilla.org/MPL/2.0/",
        ""
      ],
      "context_after": [
        "import Redux",
        "import XCTest"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/MainMenu/MainMenuMiddlewareTests.swift",
      "line": 16,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        Glean.shared.resetGlean(clearStores: true)"
      ],
      "ecosia_code": [],
      "context_before": [
        "    override func setUp() {",
        "        super.setUp()"
      ],
      "context_after": [
        "        DependencyHelperMock().bootstrapDependencies()",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Mocks/MockSettingsDelegate.swift",
      "line": 10,
      "type": "addition",
      "comment": "meet new conformance for SettingsDelegate",
      "firefox_code": [],
      "ecosia_code": [
        "    func reloadHomepage() {}",
        "    func settingsOpenURLInNewTab(_ url: URL) { }",
        "    func didFinish() {}"
      ],
      "context_before": [
        "",
        "class MockSettingsDelegate: SettingsDelegate {"
      ],
      "context_after": [
        "}"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Mocks/MockTabManager.swift",
      "line": 51,
      "type": "removal",
      "comment": "Allow overriding subscript",
      "firefox_code": [
        "    subscript(webView: WKWebView) -> Tab? {",
        "        return nil",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "    var subscriptedTab: Tab?",
        "    subscript(webView: WKWebView) -> Tab? {"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/OnboardingTests/NimbusOnboardingFeatureLayerTests.swift",
      "line": 30,
      "type": "substitution",
      "comment": "Update placeholder",
      "firefox_code": [
        "let expectedPlaceholderString = \"A string inside Firefox with a placeholder\""
      ],
      "ecosia_code": [
        "        let expectedPlaceholderString = \"A string inside Ecosia with a placeholder\"",
        "        let expectedNoPlaceholderString = \"On Wednesday's, we wear pink\"",
        "        let layer = NimbusOnboardingFeatureLayer(with: MockNimbusMessagingHelperUtility())"
      ],
      "context_before": [
        "    func testLayer_placeholderNamingMethod_returnsExpectedStrigs() {",
        "        setupNimbusForStringTesting()"
      ],
      "context_after": [
        "",
        "        guard let subject = layer.getOnboardingModel(for: .freshInstall).cards.first else {"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/OverlayModeManagerTests.swift",
      "line": 32,
      "type": "substitution",
      "comment": "Update test name according to the expected behaviour",
      "firefox_code": [
        "func testEnterOverlayMode_ForNewTabHome_WithNilURL() {"
      ],
      "ecosia_code": [
        "    func testDoesNotEnterOverlayMode_ForNewTabHome_WithNilURL() {",
        "        subject.setURLBar(urlBarView: urlBar)",
        "        subject.openNewTab(url: nil, newTabSettings: .topSites)"
      ],
      "context_before": [
        "",
        "    // MARK: - Test EnterOverlay for New tab"
      ],
      "context_after": [
        "        // Ecosia: Update with the new Ecosia's behaviour where overlay mode is OFF for New Tab",
        "        // XCTAssertTrue(subject.inOverlayMode)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/OverlayModeManagerTests.swift",
      "line": 37,
      "type": "substitution",
      "comment": "Update with the new Ecosia's behaviour where overlay mode is OFF for New Tab",
      "firefox_code": [
        "XCTAssertTrue(subject.inOverlayMode)"
      ],
      "ecosia_code": [
        "        XCTAssertFalse(subject.inOverlayMode)",
        "        XCTAssertEqual(subject.enterOverlayModeCallCount, 1)"
      ],
      "context_before": [
        "        subject.setURLBar(urlBarView: urlBar)",
        "        subject.openNewTab(url: nil, newTabSettings: .topSites)"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/OverlayModeManagerTests.swift",
      "line": 43,
      "type": "substitution",
      "comment": "Update test name according to the expected behaviour",
      "firefox_code": [
        "func testEnterOverlayMode_ForNewTabHome_WithHomeURL() {"
      ],
      "ecosia_code": [
        "    func testDoesNotEnterOverlayMode_ForNewTabHome_WithHomeURL() {",
        "        subject.setURLBar(urlBarView: urlBar)",
        "        subject.openNewTab(url: URL(string: \"internal://local/about/home\"),",
        "                           newTabSettings: .topSites)"
      ],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "",
        "        // Ecosia: Update with the new Ecosia's behaviour where overlay mode is OFF for New Tab"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/OverlayModeManagerTests.swift",
      "line": 50,
      "type": "substitution",
      "comment": "Update with the new Ecosia's behaviour where overlay mode is OFF for New Tab",
      "firefox_code": [
        "XCTAssertTrue(subject.inOverlayMode)"
      ],
      "ecosia_code": [
        "        XCTAssertFalse(subject.inOverlayMode)",
        "        XCTAssertEqual(subject.enterOverlayModeCallCount, 1)"
      ],
      "context_before": [
        "                           newTabSettings: .topSites)",
        ""
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/PasswordManagerViewModelTests.swift",
      "line": 10,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "import Glean"
      ],
      "ecosia_code": [],
      "context_before": [
        "import Storage",
        "import XCTest"
      ],
      "context_after": [
        "",
        "@testable import Client"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/PasswordManagerViewModelTests.swift",
      "line": 37,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        Glean.shared.resetGlean(clearStores: true)"
      ],
      "ecosia_code": [],
      "context_before": [
        "        self.viewModel.delegate = mockDelegate",
        "        self.viewModel.setBreachAlertsManager(MockBreachAlertsClient())"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/PasswordManagerViewModelTests.swift",
      "line": 63,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        testCounterMetricRecordingSuccess(metric: GleanMetrics.Logins.saved)"
      ],
      "ecosia_code": [],
      "context_before": [
        "        }",
        "        wait(for: [expectation], timeout: 1)"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/PasswordManagerViewModelTests.swift",
      "line": 81,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "        testCounterMetricRecordingSuccess(metric: GleanMetrics.Logins.saved)"
      ],
      "ecosia_code": [],
      "context_before": [
        "        }",
        "        wait(for: [expectation], timeout: 1)"
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/ProfileTest.swift",
      "line": 6,
      "type": "substitution",
      "comment": "Remove Account import",
      "firefox_code": [
        "@testable import Account"
      ],
      "ecosia_code": [
        "import Foundation",
        "import Shared",
        "import Storage"
      ],
      "context_before": [
        "",
        "@testable import Client"
      ],
      "context_after": [
        "",
        "import XCTest"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Settings/AppSettingsTableViewControllerTests.swift",
      "line": 107,
      "type": "removal",
      "comment": "Update deeplink",
      "firefox_code": [
        "        XCTAssertEqual(applicationHelper.lastOpenURL,",
        "                       URL(string: \"fennec://deep-link?url=/action/show-intro-onboarding\")!)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "        XCTAssertEqual(delegate.didFinishShowingSettingsCalled, 1)"
      ],
      "context_after": [
        "        XCTAssertEqual(applicationHelper.lastOpenURL,",
        "                       URL(string: \"ecosia://deep-link?url=/action/show-intro-onboarding\")!)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Settings/VersionSettingTests.swift",
      "line": 7,
      "type": "substitution",
      "comment": "Remove Shared as we import Client",
      "firefox_code": [
        "import Shared"
      ],
      "ecosia_code": [
        "import Common"
      ],
      "context_before": [
        "import XCTest",
        "@testable import Client"
      ],
      "context_after": [
        "",
        "class VersionSettingTests: XCTestCase {"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Settings/VersionSettingTests.swift",
      "line": 42,
      "type": "removal",
      "comment": "Update appversion predicate",
      "firefox_code": [
        "        let appVersionPredicate = (appVersionString?.contains(\"Firefox\") ?? false) == true"
      ],
      "ecosia_code": [],
      "context_before": [
        "        // Then",
        "        let appVersionString = UIPasteboard.general.string"
      ],
      "context_after": [
        "        let appVersionPredicate = (appVersionString?.contains(\"Ecosia\") ?? false) == true",
        "        XCTAssertNotNil(appVersionString, \"App version not copied\")"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/StatusBarOverlayTests.swift",
      "line": 37,
      "type": "removal",
      "comment": "Update expected background color",
      "firefox_code": [
        "        XCTAssertEqual(backgroundColor.cgColor, LightTheme().colors.layer1.withAlphaComponent(1).cgColor)"
      ],
      "ecosia_code": [],
      "context_before": [
        "        XCTAssertFalse(subject.hasTopTabs)",
        "        let backgroundColor = try XCTUnwrap(subject.backgroundColor)"
      ],
      "context_after": [
        "        XCTAssertEqual(backgroundColor.cgColor, theme.colors.ecosia.backgroundPrimary.withAlphaComponent(1).cgColor)",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/StatusBarOverlayTests.swift",
      "line": 50,
      "type": "removal",
      "comment": "Update expected background color",
      "firefox_code": [
        "        XCTAssertEqual(backgroundColor.cgColor, LightTheme().colors.layer1.withAlphaComponent(1).cgColor)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "        let backgroundColor = try XCTUnwrap(subject.backgroundColor)"
      ],
      "context_after": [
        "        XCTAssertEqual(backgroundColor.cgColor, theme.colors.ecosia.backgroundPrimary.withAlphaComponent(1).cgColor)",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/StatusBarOverlayTests.swift",
      "line": 63,
      "type": "removal",
      "comment": "Update expected background color",
      "firefox_code": [
        "        XCTAssertEqual(backgroundColor.cgColor, LightTheme().colors.layer1.withAlphaComponent(1).cgColor)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "        let backgroundColor = try XCTUnwrap(subject.backgroundColor)"
      ],
      "context_after": [
        "        XCTAssertEqual(backgroundColor.cgColor, theme.colors.ecosia.backgroundPrimary.withAlphaComponent(1).cgColor)",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/StatusBarOverlayTests.swift",
      "line": 80,
      "type": "removal",
      "comment": "Update expected background color",
      "firefox_code": [
        "        XCTAssertEqual(backgroundColor.cgColor, LightTheme().colors.layer1.withAlphaComponent(1).cgColor)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "        let backgroundColor = try XCTUnwrap(subject.backgroundColor)"
      ],
      "context_after": [
        "        XCTAssertEqual(backgroundColor.cgColor, theme.colors.ecosia.backgroundPrimary.withAlphaComponent(0).cgColor)",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/StatusBarOverlayTests.swift",
      "line": 97,
      "type": "removal",
      "comment": "Update expected background color",
      "firefox_code": [
        "        XCTAssertEqual(backgroundColor.cgColor, LightTheme().colors.layer1.withAlphaComponent(1).cgColor)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "        let backgroundColor = try XCTUnwrap(subject.backgroundColor)"
      ],
      "context_after": [
        "        XCTAssertEqual(backgroundColor.cgColor, theme.colors.ecosia.backgroundPrimary.withAlphaComponent(1).cgColor)",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/StatusBarOverlayTests.swift",
      "line": 110,
      "type": "removal",
      "comment": "Update expected background color",
      "firefox_code": [
        "        XCTAssertEqual(backgroundColor.cgColor, LightTheme().colors.layer1.withAlphaComponent(1).cgColor)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "        let backgroundColor = try XCTUnwrap(subject.backgroundColor)"
      ],
      "context_after": [
        "        XCTAssertEqual(backgroundColor.cgColor, theme.colors.ecosia.backgroundPrimary.withAlphaComponent(1).cgColor)",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/StatusBarOverlayTests.swift",
      "line": 123,
      "type": "removal",
      "comment": "Update expected background color",
      "firefox_code": [
        "        XCTAssertEqual(backgroundColor.cgColor, LightTheme().colors.layer1.withAlphaComponent(1).cgColor)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "        let backgroundColor = try XCTUnwrap(subject.backgroundColor)"
      ],
      "context_after": [
        "        XCTAssertEqual(backgroundColor.cgColor, theme.colors.ecosia.backgroundPrimary.withAlphaComponent(1).cgColor)",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/StatusBarOverlayTests.swift",
      "line": 140,
      "type": "removal",
      "comment": "Update expected background color",
      "firefox_code": [
        "        XCTAssertEqual(backgroundColor.cgColor, LightTheme().colors.layer1.withAlphaComponent(1).cgColor)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "        let backgroundColor = try XCTUnwrap(subject.backgroundColor)"
      ],
      "context_after": [
        "        XCTAssertEqual(backgroundColor.cgColor, theme.colors.ecosia.backgroundPrimary.withAlphaComponent(1).cgColor)",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/StatusBarOverlayTests.swift",
      "line": 157,
      "type": "removal",
      "comment": "Update expected background color",
      "firefox_code": [
        "        XCTAssertEqual(backgroundColor.cgColor, LightTheme().colors.layer1.withAlphaComponent(1).cgColor)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "        let backgroundColor = try XCTUnwrap(subject.backgroundColor)"
      ],
      "context_after": [
        "        XCTAssertEqual(backgroundColor.cgColor, theme.colors.ecosia.backgroundPrimary.withAlphaComponent(1).cgColor)",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/StatusBarOverlayTests.swift",
      "line": 170,
      "type": "removal",
      "comment": "Update expected background color",
      "firefox_code": [
        "        XCTAssertEqual(backgroundColor.cgColor, LightTheme().colors.layer3.withAlphaComponent(1).cgColor)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "        let backgroundColor = try XCTUnwrap(subject.backgroundColor)"
      ],
      "context_after": [
        "        XCTAssertEqual(backgroundColor.cgColor, theme.colors.ecosia.backgroundPrimary.withAlphaComponent(1).cgColor)",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/StatusBarOverlayTests.swift",
      "line": 188,
      "type": "removal",
      "comment": "Update expected background color",
      "firefox_code": [
        "        XCTAssertEqual(backgroundColor.cgColor, LightTheme().colors.layer3.withAlphaComponent(1).cgColor)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "        let backgroundColor = try XCTUnwrap(subject.backgroundColor)"
      ],
      "context_after": [
        "        XCTAssertEqual(backgroundColor.cgColor, theme.colors.ecosia.backgroundPrimary.withAlphaComponent(1).cgColor)",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/StatusBarOverlayTests.swift",
      "line": 202,
      "type": "removal",
      "comment": "Update expected background color",
      "firefox_code": [
        "        XCTAssertEqual(backgroundColor.cgColor, LightTheme().colors.layer3.withAlphaComponent(1).cgColor)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "        let backgroundColor = try XCTUnwrap(subject.backgroundColor)"
      ],
      "context_after": [
        "        XCTAssertEqual(backgroundColor.cgColor, theme.colors.ecosia.backgroundPrimary.withAlphaComponent(1).cgColor)",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/StatusBarOverlayTests.swift",
      "line": 220,
      "type": "removal",
      "comment": "Update expected background color",
      "firefox_code": [
        "        XCTAssertEqual(backgroundColor.cgColor, LightTheme().colors.layer3.withAlphaComponent(1).cgColor)"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "        let backgroundColor = try XCTUnwrap(subject.backgroundColor)"
      ],
      "context_after": [
        "        XCTAssertEqual(backgroundColor.cgColor, theme.colors.ecosia.backgroundPrimary.withAlphaComponent(1).cgColor)",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/TabManagement/TabManagerTests.swift",
      "line": 99,
      "type": "addition",
      "comment": "Update test to run on the main threads same as other tests",
      "firefox_code": [],
      "ecosia_code": [
        "    @MainActor",
        "    func testPreserveTabsWithNoTabs() async throws {",
        "        let subject = createSubject()",
        "        subject.preserveTabs()",
        "        try await Task.sleep(nanoseconds: sleepTime)",
        "        XCTAssertEqual(mockTabStore.saveWindowDataCalledCount, 0)",
        "        XCTAssertEqual(subject.tabs.count, 0)"
      ],
      "context_before": [
        "    // MARK: - Save tabs",
        ""
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/TabManagement/TabManagerTests.swift",
      "line": 109,
      "type": "addition",
      "comment": "Update test to run on the main threads same as other tests",
      "firefox_code": [],
      "ecosia_code": [
        "    @MainActor",
        "    func testPreserveTabsWithOneTab() async throws {",
        "        let subject = createSubject()",
        "        subject.tabRestoreHasFinished = true",
        "        addTabs(to: subject, count: 1)",
        "        subject.preserveTabs()",
        "        try await Task.sleep(nanoseconds: sleepTime)",
        "        XCTAssertEqual(mockTabStore.saveWindowDataCalledCount, 1)",
        "        XCTAssertEqual(subject.tabs.count, 1)"
      ],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/TabManagement/TabManagerTests.swift",
      "line": 121,
      "type": "addition",
      "comment": "Update test to run on the main threads same as other tests",
      "firefox_code": [],
      "ecosia_code": [
        "    @MainActor",
        "    func testPreserveTabsWithManyTabs() async throws {",
        "        let subject = createSubject()",
        "        subject.tabRestoreHasFinished = true",
        "        addTabs(to: subject, count: 5)",
        "        subject.preserveTabs()",
        "        try await Task.sleep(nanoseconds: sleepTime)",
        "        XCTAssertEqual(mockTabStore.saveWindowDataCalledCount, 1)",
        "        XCTAssertEqual(subject.tabs.count, 5)"
      ],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "    }",
        ""
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/TabManagement/TabManagerTests.swift",
      "line": 134,
      "type": "addition",
      "comment": "Update test to run on the main threads same as other tests",
      "firefox_code": [],
      "ecosia_code": [
        "    @MainActor",
        "    func testSaveScreenshotWithNoImage() async throws {",
        "        let subject = createSubject()",
        "        addTabs(to: subject, count: 5)",
        "        guard let tab = subject.tabs.first else {",
        "            XCTFail(\"First tab was expected to be found\")",
        "            return"
      ],
      "context_before": [
        "",
        "    // MARK: - Save preview screenshot"
      ],
      "context_after": [
        "        }",
        ""
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/TabManagement/TabManagerTests.swift",
      "line": 149,
      "type": "addition",
      "comment": "Update test to run on the main threads same as other tests",
      "firefox_code": [],
      "ecosia_code": [
        "    @MainActor",
        "    func testSaveScreenshotWithImage() async throws {",
        "        let subject = createSubject()",
        "        addTabs(to: subject, count: 5)",
        "        guard let tab = subject.tabs.first else {",
        "            XCTFail(\"First tab was expected to be found\")",
        "            return"
      ],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "        }",
        "        tab.setScreenshot(UIImage())"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/TabManagement/TabManagerTests.swift",
      "line": 164,
      "type": "addition",
      "comment": "Update test to run on the main threads same as other tests",
      "firefox_code": [],
      "ecosia_code": [
        "    @MainActor",
        "    func testRemoveScreenshotWithImage() async throws {",
        "        let subject = createSubject()",
        "        addTabs(to: subject, count: 5)",
        "        guard let tab = subject.tabs.first else {",
        "            XCTFail(\"First tab was expected to be found\")",
        "            return"
      ],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "        }",
        ""
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/TabManagement/TabManagerTests.swift",
      "line": 180,
      "type": "addition",
      "comment": "Update test to run on the main threads same as other tests",
      "firefox_code": [],
      "ecosia_code": [
        "    @MainActor",
        "    func testGetActiveAndInactiveTabs() {",
        "        let totalTabCount = 3",
        "        let subject = createSubject()",
        "        addTabs(to: subject, count: totalTabCount)"
      ],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "",
        "        // Preconditions"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/TabManagement/TabManagerTests.swift",
      "line": 204,
      "type": "addition",
      "comment": "Update test to run on the main threads same as other tests",
      "firefox_code": [],
      "ecosia_code": [
        "    @MainActor",
        "    func test_addTabsForURLs() {",
        "        let subject = createSubject()"
      ],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "",
        "        subject.addTabsForURLs([URL(string: \"https://www.mozilla.org/privacy/firefox\")!], zombie: false, shouldSelectTab: false)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/TabManagement/TabManagerTests.swift",
      "line": 216,
      "type": "addition",
      "comment": "Update test to run on the main threads same as other tests",
      "firefox_code": [],
      "ecosia_code": [
        "    @MainActor",
        "    func test_addTabsForURLs_forPrivateMode() {",
        "        let subject = createSubject()"
      ],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "",
        "        subject.addTabsForURLs([URL(string: \"https://www.mozilla.org/privacy/firefox\")!], zombie: false, shouldSelectTab: false, isPrivate: true)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/TabManagement/TabManagerTests.swift",
      "line": 230,
      "type": "addition",
      "comment": "Update test to run on the main threads same as other tests",
      "firefox_code": [],
      "ecosia_code": [
        "    @MainActor",
        "    func testFindRightOrLeftTab_forEmptyArray() async throws {"
      ],
      "context_before": [
        "    // MARK: - Test findRightOrLeftTab helper",
        ""
      ],
      "context_after": [
        "        // Set up a tab array as follows:",
        "        // [] Empty"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/TabManagement/TabManagerTests.swift",
      "line": 248,
      "type": "addition",
      "comment": "Update test to run on the main threads same as other tests",
      "firefox_code": [],
      "ecosia_code": [
        "    @MainActor",
        "    func testFindRightOrLeftTab_forSingleTabInArray_ofSameType() async throws {"
      ],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "        // Set up a tab array as follows:",
        "        // [A1]"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/TabManagement/TabManagerTests.swift",
      "line": 268,
      "type": "addition",
      "comment": "Update test to run on the main threads same as other tests",
      "firefox_code": [],
      "ecosia_code": [
        "    @MainActor",
        "    func testFindRightOrLeftTab_forSingleTabInArray_ofDifferentType() async throws {"
      ],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "        // Set up a tab array as follows:",
        "        // [A1]"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/TabManagement/TabManagerTests.swift",
      "line": 287,
      "type": "addition",
      "comment": "Update test to run on the main threads same as other tests",
      "firefox_code": [],
      "ecosia_code": [
        "    @MainActor",
        "    func testFindRightOrLeftTab_forDeletedIndexInMiddle_uniformTabTypes() async throws {"
      ],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "        // Set up a tab array as follows:",
        "        // [A1, A2, A3, A4, A5, A6, A7]"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/TabManagement/TabManagerTests.swift",
      "line": 308,
      "type": "addition",
      "comment": "Update test to run on the main threads same as other tests",
      "firefox_code": [],
      "ecosia_code": [
        "    @MainActor",
        "    func testFindRightOrLeftTab_forDeletedIndexInMiddle_mixedTabTypes() async throws {"
      ],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "        // Set up a tab array as follows:",
        "        // [A1, P1, P2, I1, A2, I2, A3, A4, P3]"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/TabManagement/TabManagerTests.swift",
      "line": 335,
      "type": "addition",
      "comment": "Update test to run on the main threads same as other tests",
      "firefox_code": [],
      "ecosia_code": [
        "    @MainActor",
        "    func testFindRightOrLeftTab_forDeletedIndexAtStart() async throws {"
      ],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "        // Set up a tab array as follows:",
        "        // [A1, P1, P2, I1, A2, I2, A3, A4, P3]"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/TabManagement/TabManagerTests.swift",
      "line": 362,
      "type": "addition",
      "comment": "Update test to run on the main threads same as other tests",
      "firefox_code": [],
      "ecosia_code": [
        "    @MainActor",
        "    func testFindRightOrLeftTab_forDeletedIndexAtEnd() async throws {"
      ],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "        // Set up a tab array as follows:",
        "        // [A1, P1, P2, I1, A2, I2, A3, A4, P3]"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/TabManagement/TabManagerTests.swift",
      "line": 389,
      "type": "addition",
      "comment": "Update test to run on the main threads same as other tests",
      "firefox_code": [],
      "ecosia_code": [
        "    @MainActor",
        "    func testFindRightOrLeftTab_prefersRightTabOverLeftTab() async throws {"
      ],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "        // Set up a tab array as follows:",
        "        // [A1, P1, P2, I1, A2, I2, A3, A4, P3]"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/TabToolbarHelperTests.swift",
      "line": 7,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "import Glean"
      ],
      "ecosia_code": [],
      "context_before": [
        "@testable import Client",
        ""
      ],
      "context_after": [
        "import XCTest",
        "import Common"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/TabToolbarHelperTests.swift",
      "line": 20,
      "type": "removal",
      "comment": "update search image",
      "firefox_code": [
        "    let searchButtonImage = UIImage.templateImageNamed(StandardImageIdentifiers.Large.search)"
      ],
      "ecosia_code": [],
      "context_before": [
        "        .imageFlippedForRightToLeftLayoutDirection()",
        "    let menuButtonImage = UIImage.templateImageNamed(StandardImageIdentifiers.Large.appMenu)"
      ],
      "context_after": [
        "    let searchButtonImage = UIImage.templateImageNamed(\"searchUrl\")",
        "    let imageNewTab = UIImage.templateImageNamed(StandardImageIdentifiers.Large.plus)"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/TabToolbarHelperTests.swift",
      "line": 25,
      "type": "removal",
      "comment": "update home image",
      "firefox_code": [
        "    let imageHome = UIImage.templateImageNamed(StandardImageIdentifiers.Large.home)"
      ],
      "ecosia_code": [],
      "context_before": [
        "    let searchButtonImage = UIImage.templateImageNamed(\"searchUrl\")",
        "    let imageNewTab = UIImage.templateImageNamed(StandardImageIdentifiers.Large.plus)"
      ],
      "context_after": [
        "    let imageHome = UIImage.templateImageNamed(\"menu-Home\")",
        ""
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/TabToolbarHelperTests.swift",
      "line": 61,
      "type": "removal",
      "comment": "remove Glean dependency",
      "firefox_code": [
        "    func testTelemetryForSiteMenu() {",
        "        Glean.shared.resetGlean(clearStores: true)",
        "        let mockToolbar = MockTabToolbar()",
        "        _ = TabToolbarHelper(toolbar: mockToolbar)",
        "        mockToolbar.tabToolbarDelegate?.tabToolbarDidPressMenu(mockToolbar, button: mockToolbar.appMenuButton)",
        "        testCounterMetricRecordingSuccess(metric: GleanMetrics.AppMenu.siteMenu)",
        "        Glean.shared.resetGlean(clearStores: true)",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "    func test_tabToolBarHelper_basicCreation_doesntLeak() {",
        "        let tabToolBar = TabToolbar()"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/TabToolbarHelperTests.swift",
      "line": 115,
      "type": "removal",
      "comment": "Change `addNewTabButton` to configurable CircleButton",
      "firefox_code": [
        "    var _addNewTabButton = MockToolbarButton()",
        "    var addNewTabButton: ToolbarButton { return _addNewTabButton }"
      ],
      "ecosia_code": [],
      "context_before": [
        "    var _bookmarksButton = MockToolbarButton()",
        "    var bookmarksButton: ToolbarButton { return _bookmarksButton }"
      ],
      "context_after": [
        "",
        "    var _circleButton: Client.CircleButton = CircleButton()"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/TabTray/TabTrayViewControllerTests.swift",
      "line": 39,
      "type": "substitution",
      "comment": "update items",
      "firefox_code": [
        "XCTAssertEqual(viewController.segmentControlItems.count, 3)"
      ],
      "ecosia_code": [
        "        XCTAssertEqual(viewController.segmentControlItems.count, 2)",
        "        guard let navController = viewController.navigationController else {",
        "            XCTFail(\"NavigationController is expected\")",
        "            return"
      ],
      "context_before": [
        "        viewController.viewWillAppear(false)",
        ""
      ],
      "context_after": [
        "        }",
        ""
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/TabTray/TabTrayViewControllerTests.swift",
      "line": 83,
      "type": "substitution",
      "comment": "update items",
      "firefox_code": [
        "XCTAssertEqual(viewController.segmentControlItems.count, 3)"
      ],
      "ecosia_code": [
        "        XCTAssertEqual(viewController.segmentControlItems.count, 2)",
        "        guard let navController = viewController.navigationController else {",
        "            XCTFail(\"NavigationController is expected\")",
        "            return"
      ],
      "context_before": [
        "        viewController.viewWillAppear(false)",
        ""
      ],
      "context_after": [
        "        }",
        ""
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Wallpaper/WallpaperSelectorViewModelTests.swift",
      "line": 5,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "import Glean"
      ],
      "ecosia_code": [],
      "context_before": [
        "// file, You can obtain one at http://mozilla.org/MPL/2.0/",
        ""
      ],
      "context_after": [
        "import XCTest",
        ""
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Wallpaper/WallpaperSelectorViewModelTests.swift",
      "line": 21,
      "type": "substitution",
      "comment": "remove Glean dependency",
      "firefox_code": [
        "Glean.shared.resetGlean(clearStores: true)"
      ],
      "ecosia_code": [
        "    }"
      ],
      "context_before": [
        "        addWallpaperCollections()",
        ""
      ],
      "context_after": [
        "",
        "    override func tearDown() {"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Wallpaper/WallpaperSelectorViewModelTests.swift",
      "line": 60,
      "type": "removal",
      "comment": "remove Glean dependency",
      "firefox_code": [
        "    func testRecordsWallpaperSelectorView() {",
        "        wallpaperManager = WallpaperManager()",
        "        let subject = createSubject()",
        "        subject.sendImpressionTelemetry()",
        "        testEventMetricRecordingSuccess(metric: GleanMetrics.Onboarding.wallpaperSelectorView)",
        "    }",
        "    func testRecordsWallpaperSelectorClose() {",
        "        wallpaperManager = WallpaperManager()",
        "        let subject = createSubject()",
        "        subject.sendDismissImpressionTelemetry()",
        "        testEventMetricRecordingSuccess(metric: GleanMetrics.Onboarding.wallpaperSelectorClose)",
        "    }"
      ],
      "ecosia_code": [],
      "context_before": [
        "    }",
        ""
      ],
      "context_after": [
        "//    func testClickingCell_recordsWallpaperChange() {",
        "//        let subject = createSubject()"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Wallpaper/WallpaperSettingsViewModelTests.swift",
      "line": 6,
      "type": "removal",
      "comment": "Remove Glean",
      "firefox_code": [
        "import Glean"
      ],
      "ecosia_code": [],
      "context_before": [
        "",
        "import Common"
      ],
      "context_after": [
        "import Shared",
        "import XCTest"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/ClientTests/Wallpaper/WallpaperSettingsViewModelTests.swift",
      "line": 23,
      "type": "substitution",
      "comment": "remove Glean dependency",
      "firefox_code": [
        "Glean.shared.resetGlean(clearStores: true)"
      ],
      "ecosia_code": [
        "    }"
      ],
      "context_before": [
        "        addWallpaperCollections()",
        ""
      ],
      "context_after": [
        "",
        "    override func tearDown() {"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/SharedTests/UserAgentBuilderTests.swift",
      "line": 45,
      "type": "removal",
      "comment": "Update extensions",
      "firefox_code": [
        "        let extensions = \"FxiOS/\\(AppInfo.appVersion)  \\(UserAgent.uaBitMobile) \\(UserAgent.uaBitSafari)\""
      ],
      "ecosia_code": [],
      "context_before": [
        "        let builder = UserAgentBuilder.defaultMobileUserAgent()",
        "        let systemInfo = \"(\\(UIDevice.current.model); CPU iPhone OS \\(UIDevice.current.systemVersion.replacingOccurrences(of: \".\", with: \"_\")) like Mac OS X)\""
      ],
      "context_after": [
        "        let extensions = \"\\(UserAgent.uaBitVersion) \\(UserAgent.uaBitMobile) \\(UserAgent.uaBitSafari) \\(UserAgent.uaBitEcosia)\"",
        "        let testAgent = \"\\(UserAgent.product) \\(systemInfo) \\(UserAgent.platform) \\(UserAgent.platformDetails) \\(extensions)\""
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/SharedTests/UserAgentBuilderTests.swift",
      "line": 56,
      "type": "removal",
      "comment": "Update extensions",
      "firefox_code": [
        "        let extensions = \"FxiOS/\\(AppInfo.appVersion)  \\(UserAgent.uaBitMobile) \\(UserAgent.uaBitSafari)\""
      ],
      "ecosia_code": [],
      "context_before": [
        "        let builder = UserAgentBuilder.defaultDesktopUserAgent()",
        "        let systemInfo = \"(Macintosh; Intel Mac OS X 10.15)\""
      ],
      "context_after": [
        "        let extensions = \"\\(UserAgent.uaBitVersion) \\(UserAgent.uaBitMobile) \\(UserAgent.uaBitSafari)\"",
        "        let testAgent = \"\\(UserAgent.product) \\(systemInfo) \\(UserAgent.platform) \\(UserAgent.platformDetails) \\(extensions)\""
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/SharedTests/UserAgentTests.swift",
      "line": 13,
      "type": "addition",
      "comment": "Add not nil check for domain",
      "firefox_code": [],
      "ecosia_code": [
        "            XCTAssertNotNil(domain)",
        "            XCTAssertEqual(agent, UserAgent.getUserAgent(domain: domain, platform: .Desktop))"
      ],
      "context_before": [
        "        let domains = CustomUserAgentConstant.customDesktopUAForDomain",
        "        domains.forEach { domain, agent in"
      ],
      "context_after": [
        "        }",
        "    }"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/SharedTests/UserAgentTests.swift",
      "line": 28,
      "type": "removal",
      "comment": "Use default Firefox UA instead",
      "firefox_code": [
        "        XCTAssertEqual(UserAgent.mobileUserAgent(),"
      ],
      "ecosia_code": [],
      "context_before": [
        "    func testGetUserAgentDesktop_withPaypalDomain_returnMobileUserAgent() {",
        "        let paypalDomain = \"paypal.com\""
      ],
      "context_after": [
        "        XCTAssertEqual(UserAgentBuilder.defaultFirefoxMobileUserAgent().userAgent(),",
        "                       UserAgent.getUserAgent(domain: paypalDomain, platform: .Desktop))"
      ]
    },
    {
      "file": "firefox-ios/firefox-ios-tests/Tests/SharedTests/UserAgentTests.swift",
      "line": 37,
      "type": "removal",
      "comment": "Use default Firefox UA instead",
      "firefox_code": [
        "        XCTAssertEqual(UserAgent.mobileUserAgent(),"
      ],
      "ecosia_code": [],
      "context_before": [
        "    func testGetUserAgentMobile_withPaypalDomain_returnProperUserAgent() {",
        "        let paypalDomain = \"paypal.com\""
      ],
      "context_after": [
        "        XCTAssertEqual(UserAgentBuilder.defaultFirefoxMobileUserAgent().userAgent(),",
        "                       UserAgent.getUserAgent(domain: paypalDomain, platform: .Mobile))"
      ]
    }
  ]
}